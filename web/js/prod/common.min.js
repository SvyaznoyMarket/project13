!function(a){ko.bindingHandlers.buyButtonBinding={update:function(b,c){var d=ko.unwrap(c()),e=a(b),f=e.data("product-id"),g=e.data("in-shop-stock-only"),h=e.data("in-shop-showroom-only"),i=e.data("is-buyable"),j=e.data("status-id");"undefined"==typeof i||i?"undefined"!=typeof j&&5==j?e.text("Купить").addClass("mDisabled").removeClass("mShopsOnly").removeClass("mBought").addClass("jsBuyButton").attr("href","#"):"undefined"!=typeof g&&g&&ENTER.config.pageConfig.user.region.forceDefaultBuy?e.text("Резерв").removeClass("mDisabled").addClass("mShopsOnly").removeClass("mBought").removeClass("jsBuyButton").attr("href",ENTER.utils.generateUrl("cart.oneClick.product.set",{productId:f})):ENTER.utils.getObjectWithElement(d,"id",f)?e.text("В корзине").removeClass("mDisabled").removeClass("mShopsOnly").addClass("mBought").removeClass("jsBuyButton").attr("href",ENTER.utils.generateUrl("cart")):e.hasClass("mBought")&&e.text("Купить").removeClass("mDisabled").removeClass("mShopsOnly").removeClass("mBought").addClass("jsBuyButton").attr("href",ENTER.utils.generateUrl("cart.product.set",{productId:f})):e.text("undefined"!=typeof h&&h?"На витрине":"Нет").addClass("mDisabled").removeClass("mShopsOnly").removeClass("mBought").addClass("jsBuyButton").attr("href","#")}},ko.bindingHandlers.buySpinnerBinding={update:function(b,c){var d=ko.unwrap(c()),e=a(b);e.removeClass("mDisabled").find("input").attr("disabled",!1),a.each(d,function(a,b){this.id==e.data("product-id")&&(e.addClass("mDisabled"),e.find("input").val(b.quantity()).attr("disabled",!0))})}},ko.bindingHandlers.compareButtonBinding={update:function(b,c){var d,e=ko.unwrap(c()),f=a(b),g=f.data("id"),h=f.data("type-id");ENTER.utils.getObjectWithElement(e,"id",g)?f.addClass("btnCmpr-act").find("a.btnCmpr_lk").addClass("btnCmpr_lk-act").attr("href",ENTER.utils.generateUrl("compare.delete",{productId:g})).find("span").text("Убрать из сравнения"):f.removeClass("btnCmpr-act").find("a.btnCmpr_lk").removeClass("btnCmpr_lk-act").attr("href",ENTER.utils.generateUrl("compare.add",{productId:g})).find("span").text("Добавить к сравнению"),d=a.grep(e,function(a){return h==a.typeId}),d.length>1?f.find(".btnCmpr_more").show().find(".btnCmpr_more_qn").text(d.length):f.find(".btnCmpr_more").hide()}},ko.bindingHandlers.compareListBinding={update:function(b,c){var d=ko.unwrap(c()),e=a(b),f=e.data("id");ENTER.utils.getObjectWithElement(d,"id",f)?e.addClass("btnCmprb-act").attr("href",ENTER.utils.generateUrl("compare.delete",{productId:f})):e.removeClass("btnCmprb-act").attr("href",ENTER.utils.generateUrl("compare.add",{productId:f}))}}}(jQuery),$(function(){function a(a){var b={};return $.each(a,function(a,c){b[a]=c}),b.quantity=ko.observable(a.quantity),b}function b(){var b={};return b.name=ko.observable(),b.firstName=ko.observable(),b.lastName=ko.observable(),b.link=ko.observable(),b.isEnterprizeMember=ko.observable(),b.isUpdated=ko.observable(!1),b.cart=ko.observableArray(),b.cartSum=ko.computed(function(){var a=0;return $.each(b.cart(),function(b,c){a+=c.price*c.quantity()}),a}),b.compare=ko.observableArray(),b.isProductInCompare=function(a){return 0==$.grep(b.compare,function(b){return b.id==$(a).data("id")}).length},b.update=function(c){c.user&&(c.user.name&&b.name(c.user.name),c.user.firstName&&b.firstName(c.user.firstName),c.user.lastName&&b.lastName(c.user.lastName),c.user.link&&b.link(c.user.link),c.user.isEnterprizeMember&&b.isEnterprizeMember(c.user.isEnterprizeMember)),c.cartProducts&&$.isArray(c.cartProducts)&&$.each(c.cartProducts,function(c,d){b.cart.unshift(a(d))}),c.compare&&$.each(c.compare,function(a,c){b.compare.push(c)}),b.isUpdated(!0),i.trigger("userModelUpdate")},b.productQuantityUpdate=function(a,c){$.each(b.cart(),function(b,d){a==d.id&&d.quantity(c)})},b.removeProductByID=function(a){b.cart.remove(function(b){return b.id==a})},b.infoIconVisible=ko.observable(!1),b.infoBlock_1Visible=ko.computed(function(){return ENTER.config.pageConfig.selfDeliveryTest&&ENTER.config.pageConfig.selfDeliveryLimit>b.cartSum()}),b.infoBlock_2Visible=ko.computed(function(){return ENTER.config.pageConfig.selfDeliveryTest&&ENTER.config.pageConfig.selfDeliveryLimit<=b.cartSum()&&docCookies.hasItem("enter_ab_self_delivery_view_info")}),b}function c(a){var b="topbarfix_cmpr_popup-show";if(!g){var c=ENTER.userBar.userBarFixed;g=$(".js-compare-addPopup",c),$(".js-compare-addPopup-closer",g).click(function(){g.removeClass(b)}),$(".js-topbarfixLogin, .js-topbarfixNotEmptyCart",c).mouseover(function(){g.removeClass(b)}),$("html").click(function(){g.removeClass(b)}),$(g).click(function(a){a.stopPropagation()}),$(document).keyup(function(a){27==a.keyCode&&g.removeClass(b)})}h&&clearTimeout(h),h=setTimeout(function(){g.removeClass(b)},2e3),$(".js-compare-addPopup-image",g).attr("src",a.imageUrl),$(".js-compare-addPopup-prefix",g).text(a.prefix),$(".js-compare-addPopup-webName",g).text(a.webName),ENTER.userBar.show(!0,function(){g.addClass(b)})}var d,e,f,g,h,i=$(document.body),j=ENTER.config.pageConfig.user.region.name,k=ENTER.config.pageConfig.userUrl+"?ts="+(new Date).getTime()+Math.floor(1e3*Math.random()),l="_authorized";ENTER.UserModel=b(),$(".js-topbarfix, .js-WidgetBuy, .js-listing, .js-jewelListing, .js-gridListing, .js-lineListing, .js-slider, .jsKnockoutCart").each(function(){ko.applyBindings(ENTER.UserModel,this)}),$.ajax({url:k,beforeSend:function(){d=(new Date).getTime()},success:function(a){e=(new Date).getTime(),f=e-d,ENTER.UserModel.update(a),"function"==typeof ga&&ga("send","timing","userInfo","Load User Info",f),ENTER.config.userInfo=a,docCookies.hasItem(l)||(a&&null!==a.id?docCookies.setItem(l,1,3600,"/"):docCookies.setItem(l,0,3600,"/")),i.trigger("userLogged",[a])}}),i.on("catalogLoadingComplete",function(){$(".js-listing, .js-jewelListing").each(function(){ko.cleanNode(this),ko.applyBindings(ENTER.UserModel,this)})}),i.on("click",".jsCompareLink, .jsCompareListLink",function(a){var b=this.href,d=$(this).data("id"),e=$(this).hasClass("btnCmprb-act");$(this).hasClass("jsCompareListLink")&&(b=e?ENTER.utils.generateUrl("compare.delete",{productId:d}):ENTER.utils.generateUrl("compare.add",{productId:d})),a.preventDefault(),$.ajax({url:b,success:function(a){a.compare&&(ENTER.UserModel.compare.removeAll(),$.each(a.compare,function(a,b){ENTER.UserModel.compare.push(b)}),e||c(a.product))}})}),i.on("addtocart",function(b,c){if(c.redirect)document.location.href=c.redirect;else{var d=c.products||[],e=ENTER.UserModel.cart();c.product&&d.push(c.product),$.each(d,function(b,c){var d=ENTER.utils.getObjectWithElement(e,"id",c.id);d?d.quantity(c.quantity):ENTER.UserModel.cart.unshift(a(c))})}}),i.on("mouseover",".btnBuy-inf",function(){docCookies.hasItem("enter_ab_self_delivery_view_info")||(docCookies.setItem("enter_ab_self_delivery_view_info",!0),ENTER.UserModel.cartSum()<ENTER.config.pageConfig.selfDeliveryLimit&&i.trigger("trackGoogleEvent",["Платный_самовывоз_"+j,"увидел всплывашку платный самовывоз","всплывающая корзина"]),ENTER.UserModel.cartSum()>=ENTER.config.pageConfig.selfDeliveryLimit&&i.trigger("trackGoogleEvent",["Платный_самовывоз_"+j,"самовывоз бесплатно","всплывающая корзина"])),ENTER.UserModel.infoIconVisible(!1)}),i.on("showUserCart",function(a){$(a.target);ENTER.config.pageConfig.selfDeliveryTest&&ENTER.UserModel.infoIconVisible()?i.trigger("trackGoogleEvent",["Платный_самовывоз_"+j,"увидел подсказку","всплывающая корзина"]):ENTER.config.pageConfig.selfDeliveryTest&&!ENTER.UserModel.infoIconVisible()&&i.trigger("trackGoogleEvent",["Платный_самовывоз_"+j,"не увидел подсказку","всплывающая корзина"]),ENTER.config.pageConfig.selfDeliveryTest&&!docCookies.hasItem("enter_ab_self_delivery_view_info")&&ENTER.UserModel.cartSum()<ENTER.config.pageConfig.selfDeliveryLimit&&ENTER.UserModel.infoIconVisible(!0),ENTER.config.pageConfig.selfDeliveryTest&&ENTER.UserModel.infoBlock_2Visible()&&!ENTER.UserModel.infoIconVisible()&&i.trigger("trackGoogleEvent",["Платный_самовывоз_"+j,"самовывоз бесплатно","всплывающая корзина"])}),i.on("userModelUpdate",function(){ENTER.config.pageConfig.selfDeliveryTest&&!docCookies.hasItem("enter_ab_self_delivery_view_info")&&ENTER.UserModel.cartSum()<ENTER.config.pageConfig.selfDeliveryLimit&&ENTER.UserModel.infoIconVisible(!0)}),i.on("click",".jsAbSelfDeliveryLink",function(a){var b=a.target.href;b&&(a.preventDefault(),i.trigger("trackGoogleEvent",{category:"Платный_самовывоз_"+j,action:"добрать товар",label:"всплывающая корзина",hitCallback:function(){window.location.href=b}}))})}),function(a,b,c){c.ajaxSetup({timeout:1e4,statusCode:{404:function(){this.url;"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","404 ошибка, страница не найдена"])},401:function(){c("#auth-block").length?c("#auth-block").lightbox_me({centered:!0,onLoad:function(){c("#auth-block").find("input:first").focus()}}):"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","401 ошибка, авторизуйтесь заново"])},500:function(){this.url;"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","500 сервер перегружен"])},503:function(){this.url;"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","503 ошибка, сервер перегружен"])},504:function(){this.url;"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","504 ошибка, проверьте соединение с интернетом"])}},error:function(a,b){this.url;if("error"===a.statusText)"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","неизвестная ajax ошибка"]);else if("timeout"===b)return}})}(this,this.document,this.jQuery,this.ENTER),function(a){var b=a(document.body),c=this.ga,d=this._gaq,e=function(b,e){var f={},g={hitType:"event"},h=["_trackEvent"],i=["category","action","label","value","nonInteraction","hitCallback"];if(2==arguments.length&&"object"==typeof e)a.each(i,function(a,b){e.hasOwnProperty(b)&&(f[b]=e[b])});else if(arguments.length>2&&"string"==typeof e)for(var j=1,k=arguments.length;k>j;j++)f[i[j-1]]=arguments[j];a.each(i,function(a,b){if(f.hasOwnProperty(b))switch(b){case"category":f[b]=f[b].slice(0,150);break;case"action":case"label":f[b]=f[b].slice(0,500);break;case"value":f[b]=parseInt(f[b].slice,10);break;case"nonInteraction":f[b]=Boolean(f[b])}}),"object"==typeof d&&(h.push(f.category,f.action),f.label&&h.push(f.label),f.value&&h.push(f.value),f.nonInteraction&&h.push(f.nonInteraction),d.push(h)),"function"==typeof c&&0!=c.getAll().length?(g.eventCategory=f.category,g.eventAction=f.action,f.label&&(g.eventLabel=f.label),f.value&&(g.eventValue=f.value),f.hitCallback&&(g.hitCallback=f.hitCallback),f.nonInteraction&&c("set","nonInteraction",!0),c("send",g)):"function"==typeof f.hitCallback&&f.hitCallback()},f=function(a){if(this.id=a.id?a.id:!1,this.affiliation=a.affiliation,this.total=a.total,this.shipping=a.shipping?a.shipping:"0",this.tax=a.tax?a.tax:"0",this.city=a.city?a.city:"",!this.id)throw"Некорректный ID транзакции";if(!this.total)throw"Некорректная сумма заказа";return this.toObject=function(){return{id:this.id,affiliation:this.affiliation,revenue:this.total,shipping:this.shipping,tax:this.tax}},this.toArray=function(){return[this.id,this.affiliation,this.total,this.tax,this.shipping,this.city]},this},g=function(a,b){if(this.id=b?String(b):"",this.name=a.name?String(a.name):"",this.category=a.category?String(a.category):"",this.sku=a.sku?String(a.sku):"",this.price=a.price?String(a.price):"",this.quantity=a.quantity?String(a.quantity):"",!this.id)throw"Некорректный ID товара";if(!this.name)throw"Некорректное название товара";if(!this.price)throw"Некорректная цена товара";if(!this.quantity)throw"Некорректное количество товара";return this.toObject=function(){return{id:this.id,name:this.name,sku:this.sku,category:this.category,price:this.price,quantity:this.quantity}},this.toArray=function(){return[this.id,this.sku,this.name,this.category,this.price,this.quantity]},this},h=function(b,e){var h,i;try{h=new f(e.transaction),i=a.map(e.products,function(a){return new g(a,h.id)}),"object"==typeof d&&(d.push(["_addTrans"].concat(h.toArray())),a.each(i,function(a,b){d.push(["_addItem"].concat(b.toArray()))}),d.push(["_trackTrans"])),"function"==typeof c&&0!=c.getAll().length&&(c("require","ecommerce","ecommerce.js"),c("ecommerce:addTransaction",h.toObject()),a.each(i,function(a,b){c("ecommerce:addItem",b.toObject())}),c("ecommerce:send"))}catch(j){}};"undefined"==typeof c&&(c=window[window.GoogleAnalyticsObject]),b.on("trackGoogleEvent",e),b.on("trackGoogleTransaction",h);try{"function"==typeof c&&0==c.getAll().length&&c("create","UA-25485956-5","enter.ru")}catch(i){}}(jQuery),function(){var a=!1,b=!1,c=function(){a?($("#mobilePhoneWrapper").hide(),$("#mobilePhoneWrapper").parent().find(".red").html(""),a=!1):($("#mobilePhoneWrapper").show(),a=!0)},d=function(){b?($("#emailWrapper").hide(),$("#emailWrapper").parent().find(".red").html(""),b=!1):($("#emailWrapper").show(),b=!0)};$(document).ready(function(){a=$(".smsCheckbox").hasClass("checked"),$("#user_mobile_phone").val()||$(".smsCheckbox").bind("click",c),b=$(".emailCheckbox").hasClass("checked"),$("#user_email").val()||$(".emailCheckbox").bind("click",d)})}(),function(){var a=$("body");a.on("click",".jsBuyButton",function(){var b=$(this);return b.hasClass("mDisabled")?!1:b.hasClass("mBought")?(document.location.href(b.attr("href")),!1):(b.addClass("mLoading"),$.ajax({url:b.attr("href"),type:"GET",success:function(c){var d=b.data("upsale")?b.data("upsale"):null,e=b.parents(".jsSliderItem").data("product");c.success&&(b.removeClass("mLoading"),c.product&&(c.product.isUpsale=e&&e.isUpsale?!0:!1,c.product.fromUpsale=d&&d.fromUpsale?!0:!1),a.trigger("addtocart",[c,d]))},error:function(){b.removeClass("mLoading")}}),!1)}),a.on("addtocart",function(a,b){var c=function(a,b){var c=b.product,d=b.service,e=b.warranty,f=window.location.href,g={};"undefined"!=typeof _kmq&&(c&&(g={"Add to Cart SKU":c.article,"Add to Cart SKU Quantity":c.quantity,"Add to Cart Product Name":c.name,"Add to Cart Root category":c.category[0].name,"Add to Cart Root ID":c.category[0].id,"Add to Cart Category name":c.category?c.category[c.category.length-1].name:0,"Add to Cart Category ID":c.category?c.category[c.category.length-1].id:0,"Add to Cart SKU Price":c.price,"Add to Cart Page URL":f,"Add to Cart F1 Quantity":c.serviceQuantity},_kmq.push(["record","Add to Cart",g]),c.isUpsale&&_kmq.push(["record","cart rec added from rec",{"SKU cart added from rec":c.article}]),c.fromUpsale&&_kmq.push(["record","cart recommendation added",{"SKU cart rec added":c.article}])),d&&(g={"Add F1 F1 Name":d.name,"Add F1 F1 Price":d.price,"Add F1 SKU":c.article,"Add F1 Product Name":c.name,"Add F1 Root category":c.category[0].name,"Add F1 Root ID":c.category[0].id,"Add F1 Category name":c.category?c.category[c.category.length-1].name:0,"Add F1 Category ID":c.category?c.category[c.category.length-1].id:0},_kmq.push(["record","Add F1",g])),e&&(g={"Add Warranty Warranty Name":e.name,"Add Warranty Warranty Price":e.price,"Add Warranty SKU":c.article,"Add Warranty Product Name":c.name,"Add Warranty Root category":c.category[0].name,"Add Warranty Root ID":c.category[0].id,"Add Warranty Category name":c.category?c.category[c.category.length-1].name:0,"Add Warranty Category ID":c.category?c.category[c.category.length-1].id:0},_kmq.push(["record","Add Warranty",g])))},d=function(a,b){var c=b.product,d=function(){"undefined"!=typeof window.ga&&c.hasOwnProperty("isTchiboProduct")&&c.isTchiboProduct&&ga("tchiboTracker.send","event","Add2Basket",c.name,c.article)};c&&"undefined"!=typeof _gaq&&(d(),_gaq.push(["_trackEvent","Add2Basket","product",c.article]),c.isUpsale&&_gaq.push(["_trackEvent","cart_recommendation","cart_rec_added_from_rec",c.article]),c.fromUpsale&&_gaq.push(["_trackEvent","cart_recommendation","cart_rec_added_to_cart",c.article]))},e=function(a,b){var c=b.product,d=c.id,e=c.category?c.category[c.category.length-1].id:0,f="http://ad.adriver.ru/cgi-bin/rle.cgi?sid=182615&sz=add_basket&custom=10="+d+";11="+e+"&bt=55&pz=0&rnd=![rnd]",g=document,h=g.createElement("IMG"),i=g.body;f=f.replace(/!\[rnd\]/,Math.round(9999999*Math.random()))+"&tail256="+escape(g.referrer||"unknown"),h.style.position="absolute",h.style.width=h.style.height="0px",h.onload=h.onerror=function(){i.removeChild(h),h=i=null},h.src=f,i.insertBefore(h,i.firstChild)},f=function(a,b){var c=b.product;if("object"==typeof rcApi)try{rcApi.addToBasket(c.id)}catch(d){}},g=function(a,b){var c,d=b.product,e=b.regionId,f=window._rutarget||[];d&&e&&(c={event:"addToCart",sku:d.id,qty:d.quantity,regionId:e},f.push(c))},h=function(a,b){var c=b.product;"undefined"!=typeof c&&c.hasOwnProperty("id")&&"undefined"!=typeof JSREObject&&JSREObject("cart_add",c.id)};try{if(b.product&&(c(a,b),d(a,b),e(a,b),f(a,b)),b.products)for(var i in b.products)d(a,{product:b.products[i]}),"undefined"!=typeof window.ga&&window.ga("send","event","Add2Basket","product",b.products[i].article);g(a,b),h(a,b)}catch(j){}})}(window.ENTER),function(a){var b=$("body"),c=$(".popupRegion"),d=$("#jscity"),e=$("#jschangecity"),f=c.find(".inputClear"),g=$(".jsChangeRegion"),h=$(".jsChangeRegionAnalytics"),i=c.find(".regionSlidesWrap"),j=c.find(".moreCity"),k=c.find(".leftArr"),l=c.find(".rightArr"),m=c.find(".regionSlides"),n=c.find(".regionSlides_slide");d.autocomplete({autoFocus:!0,appendTo:"#jscities",source:function(a,b){$.ajax({url:d.data("url-autocomplete"),dataType:"json",data:{q:a.term},success:function(a){var c=a.data.slice(0,15);b($.map(c,function(a){return{label:a.name,value:a.name,url:a.url}}))}})},minLength:2,select:function(a,b){e.data("url",b.item.url),z()},open:function(){$(this).removeClass("ui-corner-all").addClass("ui-corner-top")},close:function(){$(this).removeClass("ui-corner-top").addClass("ui-corner-all")}});var o=function(){c.lightbox_me({autofocus:!0,onLoad:function(){d.val().length&&(d.putCursorAtEnd(),z())},onClose:function(){var b=g.data("region-id");a.docCookies.hasItem("geoshop")||a.docCookies.setItem("geoshop",b,31536e3,"/")}}),"/"===document.location.pathname&&"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","citySelector","viewed"])},p=function(){var a=$(this),b=a.data("autoresolve-url"),c=function(a){if(!a.data.length)return $(".popupRegion .mAutoresolve").html(""),!1;var b=a.data[0].url,c=a.data[0].name,d=a.data[0].id;return 14974===d||108136===d?!1:void($(".popupRegion .mAutoresolve").length?$(".popupRegion .mAutoresolve").html('<a href="'+b+'">'+c+"</a>"):$(".popupRegion .cityInline").prepend('<div class="cityItem mAutoresolve"><a href="'+b+'">'+c+"</a></div>"))};return"undefined"!=typeof b&&$.ajax({type:"GET",url:b,success:c}),o(),!1},q=function(){var a=1*n.width(),b=1*m.width(),c=parseInt(m.css("left"),10);return k.show(),m.animate({left:c-a}),-b>=c-2*a&&l.hide(),!1},r=function(){var a=1*n.width(),b=(1*m.width(),parseInt(m.css("left"),10));return l.show(),m.animate({left:b+a}),b+2*a>=0&&k.hide(),!1},s=function(){return $(this).toggleClass("mExpand"),i.slideToggle(300),!1},t=function(){return d.val(""),y(),f.hide(),!1},u=function(){$(this).val()?(z(),f.show()):(y(),f.hide())},v=function(a){"/"===document.location.pathname&&"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","citySelector","selected",a])},w=function(){var a=$(this).text();v(a)},x=function(){var b=$(this).data("url"),e=d.val();return v(e),b?a.location=b:c.trigger("close"),!1},y=function(){e.addClass("mDisabled"),e.attr("disabled","disabled")},z=function(){e.removeClass("mDisabled"),e.removeAttr("disabled")};e.on("click",x),j.on("click",s),f.on("click",t),l.on("click",q),k.on("click",r),d.on("keyup",u),b.on("click",".jsChangeRegion",p),h.on("click",w),a.docCookies.hasItem("geoshop")||o()}(this),function(){var a=$("input.bCustomInput"),b=$("body"),c=function(){if($(this).is("[type=checkbox]")||$(this).is("[type=radio]")){var a=$(this),b=a.attr("id"),c=a.is("[type=checkbox]")?"checkbox":"radio",d=a.attr("name")||"",e=$('label[for="'+b+'"]');"checkbox"===c&&(a.is(":checked")?e.addClass("mChecked"):e.removeClass("mChecked")),"radio"===c&&a.is(":checked")&&($('input[name="'+d+'"]').each(function(){var a=$(this),b=a.attr("id");$('label[for="'+b+'"]').removeClass("mChecked")}),e.addClass("mChecked"))}};b.on("updateState",".bCustomInput",c),b.on("change",".bCustomInput",function(){$(this).trigger("updateState")}),a.trigger("updateState")}(),$(document).ready(function(){if($("#similarGoodsSlider").length){var a=$("#similarGoodsSlider"),b=a.find(".bSimilarGoodsSlider_eWrap"),c=a.find(".bSimilarGoodsSlider_eArrow"),d=0,e=0,f=0,g=0,h=0,i=function(){var a=$(this),b={"Recommended Item Clicked Similar Recommendation Place":"product","Recommended Item Clicked Similar Clicked SKU":a.data("article"),"Recommended Item Clicked Similar Clicked Product Name":a.data("name"),"Recommended Item Clicked Similar Product Position":a.data("pos")};"undefined"!=typeof _kmq&&_kmq.push(["record","Recommended Item Clicked Similar",b])},j=function(c){var h=a.find(".bSimilarGoodsSlider_eGoods");for(var i in c){var j=tmpl("similarGoodTmpl",c[i]);b.append(j)}d=h.width()+2*parseInt(h.css("paddingLeft"),10),f=h.length,g=d*f,b.width(g),f>0&&$(".bSimilarGoods").fadeIn(300,function(){e=a.width()}),4>f&&$(".bSimilarGoodsSlider_eArrow.mRight").hide()};$.getJSON($("#similarGoodsSlider").data("url"),function(a){if(!$.isEmptyObject(a)){var b=a;j(b)}}).done(function(){var c=a.find(".bSimilarGoodsSlider_eGoods");f=c.length,g=d*f,b.width(g),f>0&&$(".bSimilarGoods").fadeIn(300,function(){e=a.width()})}),c.bind("click",function(){return $(this).hasClass("mLeft")?h+=2*d:h-=2*d,e-g>=h?(h=e-g,$(".bSimilarGoodsSlider_eArrow.mRight").hide(),$(".bSimilarGoodsSlider_eArrow.mLeft").show()):h>=0?(h=0,$(".bSimilarGoodsSlider_eArrow.mLeft").hide(),$(".bSimilarGoodsSlider_eArrow.mRight").show()):c.show(),b.animate({left:h}),!1}),$(".bSimilarGoods.mProduct .bSimilarGoodsSlider_eGoods").on("click",i)}var k=function(){var a=$("#_categoryData").data("category"),b={"Viewed Category Category Type":a.type,"Viewed Category Category Level":a.level,"Viewed Category Parent category":a.parent_category,"Viewed Category Category name":a.category,"Viewed Category Category ID":a.id};"undefined"!=typeof _kmq&&_kmq.push(["record","Viewed Category",b])},l=function(){var a,b,c=$(this),d=!1,e=$("#_categoryData").data("category");a=c.parents(".js-goodsboxContainer"),a.length||(a=c.parents("div.goodsboxlink")),b=a.length?a.data("add"):!1,b&&e&&(d={"Category Results Clicked Category Type":e.type,"Category Results Clicked Category Level":e.level,"Category Results Clicked Parent category":e.parent_category,"Category Results Clicked Category name":e.category,"Category Results Clicked Category ID":e.id,"Category Results Clicked SKU":b.article,"Category Results Clicked Product Name":b.name,"Category Results Clicked Page Number":b.page,"Category Results Clicked Product Position":b.position}),d&&"undefined"!=typeof _kmq&&_kmq.push(["record","Category Results Clicked",d])};$("#_categoryData").length&&(k(),$("body").delegate(".js-goodsbox a","click",l));var m=function(){var a=$("#_searchKiss").data("search"),b={"Search String":a.query,"Search Page URL":a.url,"Search Items Found":a.count};"undefined"!=typeof _kmq&&_kmq.push(["record","Search",b]);var c=function(){var b=$(this).data("add"),c={"Search Results Clicked Search String":a.query,"Search Results Clicked SKU":b.article,"Search Results Clicked Product Name":b.name,"Search Results Clicked Page Number":b.page,"Search Results Clicked Product Position":b.position};"undefined"!=typeof _kmq&&_kmq.push(["record","Search Results Clicked",c])};$(".js-goodsboxContainer").on("click",c),$(".goodsboxlink").on("click",c)};$("#_searchKiss").length&&m()}),function(){var a=function(){var a=$(this).data("goto");return $(document).stop().scrollTo($("#"+a),800),!1};$(document).ready(function(){$(".jsGoToId").bind("click",a)})}(),function(){var a=function(){var a=$(this);return a.hasClass("expanded")?(a.parent().parent().find(".toHide").hide(),a.html("Все метки"),a.removeClass("expanded")):(a.parent().parent().find(".toHide").show(),a.html("Основные метки"),a.addClass("expanded")),!1};$(document).ready(function(){$(".hotlinksToggle").bind("click",a)})}(),function(){$.ajax({url:"https://jira.enter.ru/s/ru_RU-istibo/773/3/1.2.4/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=2e17c5d6",type:"get",cache:!0,dataType:"script"}),window.ATL_JQ_PAGE_PROPS={triggerFunction:function(a){$("#jira").click(function(b){b.preventDefault(),a()})}}}(),function(){var a=$("#auth-block"),b=function(){a.on("changeState",function(a,b){var c=$(this);if(b){var d=c.attr("data-state")?"state_"+c.attr("data-state"):null,e="state_"+b;d&&c.removeClass(d),c.addClass(e),c.attr("data-state",b)}$(".js-resetForm, .js-authForm, .js-registerForm").trigger("clearError")}),a.find(".js-link").on("click",function(a){var b=$(a.target),c=$(b.data("value").target),d=b.data("value").state;c.trigger("changeState",[d])}),$(".js-resetForm, .js-authForm, .js-registerForm").on("submit",function(a){var b=$(a.target),c=b.serializeArray();$.post(b.attr("action"),c).done(function(a){function d(a){for(var b=0;b<c.length;b++)if(c[b].name==a)return c[b].value;return null}if(b.hasClass("js-registerForm")&&d("subscribe")&&"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","subscription","subscribe_registration",d("register[email]")]),a.data&&a.data.link)return window.location.href=a.data.link?a.data.link:window.location.href,!0;b.trigger("clearError");var e=a.message;!e&&a.notice&&a.notice.message&&(e=a.notice.message),e&&b.find(".js-message").html(e),a.form&&a.form.error&&$.each(a.form.error,function(a,c){b.trigger("fieldError",[c])})}),a.preventDefault()}).on("fieldError",function(a,b){var c=$(a.target),d=c.find('[name*="'+b.field+'"]');d.length&&(d.prev(".js-fieldError").remove(),b.message&&d.before('<div class="js-fieldError bErrorText"><div class="bErrorText__eInner">'+b.message+"</div></div>"))}).on("clearError",function(){var a=$(this);a.find(".js-message").html(""),a.find("input").each(function(b,c){a.trigger("fieldError",[{field:$(c).attr("name")}])})}).on("focus","input",function(){var a=$(this);a.closest("form").trigger("fieldError",[{field:a.attr("name")}])}),$.mask.definitions.n="[0-9]",$(".js-registerForm .js-phoneField").mask("+7 (nnn) nnn-nn-nn")};$(document).ready(function(){b()})}(window.ENTER),function(ENTER){var constructors=ENTER.constructors,body=$("body"),authBlock=$("#auth-block"),registerMailPhoneField=$(".jsRegisterUsername"),resetPwdForm=$(".jsResetPwdForm"),registerForm=$(".jsRegisterForm"),loginForm=$(".jsLoginForm"),completeRegister=$(".jsRegisterFormComplete"),showLoginFormLink=$(".jsShowLoginForm"),signinValidationConfig={fields:[{fieldNode:$(".jsSigninUsername",authBlock),require:!0,customErr:"Не указан логин"},{fieldNode:$(".jsSigninPassword",authBlock),require:!0,customErr:"Не указан пароль"}]},signinValidator=new FormValidator(signinValidationConfig),registerValidationConfig={fields:[{fieldNode:$(".jsRegisterFirstName",authBlock),require:!0,customErr:"Не указано имя"},{fieldNode:registerMailPhoneField,validBy:"isEmail",require:!0,customErr:"Некорректно введен e-mail"}]},registerValidator=new FormValidator(registerValidationConfig),forgotPwdValidationConfig={fields:[{fieldNode:$(".jsForgotPwdLogin",authBlock),require:!0,customErr:"Не указан email или мобильный телефон",validateOnChange:!0}]},forgotValidator=new FormValidator(forgotPwdValidationConfig),setValidatorSettings=function(){ENTER.utils.signinValidationConfig=signinValidationConfig,ENTER.utils.signinValidator=signinValidator,ENTER.utils.registerValidationConfig=registerValidationConfig,ENTER.utils.registerValidator=registerValidator,ENTER.utils.forgotPwdValidationConfig=forgotPwdValidationConfig,ENTER.utils.forgotValidator=forgotValidator};setValidatorSettings(),constructors.Login=function(){"use strict";function Login(){return this instanceof Login?(this.form=null,this.redirect_to=null,body.on("click",".registerAnotherWayBtn",$.proxy(this.registerAnotherWay,this)),body.on("click",".bAuthLink",this.openAuth),$(".jsLoginForm, .jsRegisterForm, .jsResetPwdForm").data("redirect",!0).on("submit",$.proxy(this.formSubmit,this)),body.on("click",".jsForgotPwdTrigger, .jsRememberPwdTrigger",this.forgotFormToggle),body.on("click","#bUserlogoutLink",this.logoutLinkClickLog),void(showLoginFormLink.length&&(loginForm.hide(),body.on("click",".jsShowLoginForm",this.showLoginForm)))):new Login}return Login.prototype.showError=function(a,b){var c=$("ul.error_list",this.form);return void 0!==b&&b(),c.length?c.html("<li>"+a+"</li>"):$(".bFormLogin__ePlaceTitle",this.form).after($('<ul class="error_list" />').append("<li>"+a+"</li>")),!1},Login.prototype.formErrorHandler=function(a){var b=this.getFormValidator(),c=$('[name="'+this.getFormName()+"["+a.field+']"]'),d=function(){b._unmarkFieldError($(this))};return b._markFieldError(c,a.message),c.bind("focus",d),!1},Login.serverErrorHandler={"default":function(a){return a.redirect||(a.redirect=window.location.href),a.error&&a.error.message?(this.showError(a.error.message,function(){document.location.href=a.redirect}),!1):void(document.location.href=a.redirect)},0:function(a){var b=null;if(a.redirect)return void this.showError(a.error.message,function(){document.location.href=a.redirect});$("ul.error_list",this.form).length&&$("ul.error_list",this.form).html("");for(var c=a.form.error.length-1;c>=0;c--)b=a.form.error[c],"global"!==b.field&&null!==b.message?$.proxy(this.formErrorHandler,this)(b):"global"===b.field&&null!==b.message&&this.showError(b.message);return!1}},Login.prototype.checkEmail=function(){return registerMailPhoneField.hasClass("jsRegisterPhone")?!1:!0},Login.prototype.registerAnotherWay=function(){var a=$(".registerAnotherWay"),b=$(".registerAnotherWayBtn");return registerMailPhoneField.val(""),this.checkEmail()?(a.html("Ваш мобильный телефон:"),b.html("Ввести e-mail"),registerMailPhoneField.addClass("jsRegisterPhone"),registerValidator.setValidate(registerMailPhoneField,{validBy:"isPhone",customErr:"Некорректно введен телефон"}),$.mask.definitions.n="[0-9]",registerMailPhoneField.mask("+7 (nnn) nnn-nn-nn")):(a.html("Ваш e-mail:"),b.html("У меня нет e-mail"),registerMailPhoneField.removeClass("jsRegisterPhone"),registerValidator.setValidate(registerMailPhoneField,{validBy:"isEmail",customErr:"Некорректно введен e-mail"}),registerMailPhoneField.unmask()),!1},Login.prototype.openAuth=function(){var removeErrors=function(){var validators=["signin","register","forgot"],validator,config,self,i,j;for(j in validators)if(validator=eval("ENTER.utils."+validators[j]+"Validator"),config=eval("ENTER.utils."+validators[j]+"ValidationConfig"),config&&config.fields&&validator)for(i in config.fields)self=config.fields[i].fieldNode,self&&validator._unmarkFieldError(self)};return setValidatorSettings(),authBlock.lightbox_me({centered:!0,autofocus:!0,onLoad:function(){authBlock.find("input:first").focus()},onClose:function(){removeErrors(),authBlock.trigger("changeState",["default"])}}),!1},Login.prototype.submitBtnLoadingDisplay=function(a){if(a.length){var b=a.val(),c=a.data("loading-value");a.attr("disabled","disabled"===a.attr("disabled")?!1:!0).val(c).data("loading-value",b)}return!1},Login.prototype.getFormValidator=function(){return eval("ENTER.utils."+this.getFormName()+"Validator")},Login.prototype.getFormName=function(){return this.form.hasClass("jsLoginForm")?"signin":this.form.hasClass("jsRegisterForm")?"register":this.form.hasClass("jsResetPwdForm")?"forgot":""},Login.prototype.formSubmit=function(a){a.preventDefault(),this.form=$(a.target);var b,c=this.form.serializeArray(),d=this.getFormValidator(),e=$(".jsSubmit",this.form),f=$(".jsForgotPwdLogin",this.form),g=this.getUrlParams();this.redirect_to=window.location.href,g.redirect_to&&(this.redirect_to=g.redirect_to);var h=function(a){if(clearTimeout(b),a.error)return Login.serverErrorHandler.hasOwnProperty(a.error.code)?$.proxy(Login.serverErrorHandler[a.error.code],this)(a):Login.serverErrorHandler["default"](a),this.submitBtnLoadingDisplay(e),!1;
if($.proxy(this.formSubmitLog,this),f.length&&f.is(":visible")&&(this.submitBtnLoadingDisplay(e),f.hide(),$(".jsForgotPwdLoginLabel",this.form).hide(),e.hide(),this.showError(a.notice.message)),"undefined"!=typeof gaRun&&"function"==typeof gaRun.register&&gaRun.register(),this.form.data("redirect")){if("undefined"!=typeof a.data.link)return document.location.href=a.data.link.replace(/#.*$/,""),!1;completeRegister.html(a.message),completeRegister.show(),registerForm.hide(),this.showLoginForm()}else authBlock.trigger("close");$("#order-form").length&&($("#user-block").html('Привет, <strong><a href="'+a.data.link+'">'+a.data.user.first_name+"</a></strong>"),$("#order_recipient_first_name").val(a.data.user.first_name),$("#order_recipient_last_name").val(a.data.user.last_name),$("#order_recipient_phonenumbers").val(a.data.user.mobile_phone.slice(1)),$("#qiwi_phone").val(a.data.user.mobile_phone.slice(1)))},i=function(){this.submitBtnLoadingDisplay(e),c.push({name:"redirect_to",value:this.redirect_to}),$.post(this.form.attr("action"),c,$.proxy(h,this),"json"),b=setTimeout($.proxy(function(){document.location.href=this.redirect_to},this),5e3)};return d.validate({onInvalid:function(a){},onValid:$.proxy(i,this)}),!1},Login.prototype.showLoginForm=function(){showLoginFormLink.hide(),loginForm.slideDown(300),$.scrollTo(loginForm,500)},Login.prototype.forgotFormToggle=function(){return resetPwdForm.is(":visible")?(resetPwdForm.hide(),loginForm.show()):(resetPwdForm.show(),loginForm.hide()),!1},Login.prototype.formSubmitLog=function(){var a="";"function"==typeof gaRun.login&&gaRun.login(),"signin"===this.getFormName()?("undefined"!=typeof _gaq&&(a=-1!==this.form.find(".jsSigninUsername").val().search("@")?"email":"mobile",_gaq.push(["_trackEvent","Account","Log in",a,window.location.href])),"undefined"!=typeof _kmq&&_kmq.push(["identify",this.form.find(".jsSigninUsername").val()])):"register"===this.getFormName()?("undefined"!=typeof _gaq&&(a=this.checkEmail()?"email":"mobile",_gaq.push(["_trackEvent","Account","Create account",a])),"undefined"!=typeof _kmq&&_kmq.push(["identify",this.form.find(".jsRegisterUsername").val()])):"forgot"===this.getFormName()&&"undefined"!=typeof _gaq&&(a=-1!==this.form.find(".jsForgotPwdLogin").val().search("@")?"email":"mobile",_gaq.push(["_trackEvent","Account","Forgot password",a]))},Login.prototype.logoutLinkClickLog=function(){"undefined"!=typeof _kmq&&_kmq.push(["clearIdentity"])},Login.prototype.getUrlParams=function(){var a,b,c={},d=window.location.search.substring(1).split("&");for(b=0;b<d.length;b++)a=d[b].split("="),c[a[0]]="undefined"==typeof a[1]?"":a[1];return c},Login}(),$(document).ready(function(){new ENTER.constructors.Login})}(window.ENTER),$(document).ready(function(){function a(a){return"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","CategoryClick",a.data,window.location.pathname]),!0}$("body").on("click",".bSubscibe",function(){return $(this).hasClass("checked")?($(this).removeClass("checked"),$(this).find(".subscibe").removeAttr("checked"),$(this).find('input[name="subscribe"]').val(0)):($(this).addClass("checked"),$(this).find(".subscibe").attr("checked","checked"),$(this).find('input[name="subscribe"]').val(1)),!1}),$(".bMainMenuLevel-1__eLink").bind("click","Верхнее меню",a),$(".bMainMenuLevel-2__eLink").bind("click","Верхнее меню",a),$(".bMainMenuLevel-3__eLink").bind("click","Верхнее меню",a),$(".breadcrumbs").first().find("a").bind("click","Хлебные крошки сверху",a),$(".breadcrumbs-footer").find("a").bind("click","Хлебные крошки снизу",a),$(".bCtg__eMore").bind("click",function(a){a.preventDefault();var b=$(this);b.parent().find("li.hf").slideToggle();var c=b.find("a");c.text("еще..."==c.text()?"скрыть":"еще...")}),$(".product_buy-container").each(function(){var a=$(this).data("order");"object"!=typeof a||$.isEmptyObject(a)||$.ajax({url:$(this).data("url"),data:a,type:"POST",timeout:2e4})}),$(".searchtextClear").length&&($(".searchtextClear").each(function(){$(this).val().length?$(this).removeClass("vh"):$(this).addClass("vh")}),$(".searchtextClear").click(function(){$(this).siblings(".searchtext").val(""),$(this).addClass("vh"),$("#searchAutocomplete").length&&$("#searchAutocomplete").html("")})),$(".enterPrizeDesc").click(function(){$(this).next(".enterPrizeListWrap").toggle("fast")})}),function(a){var b=function(b,c,d,e){var f=this;f.inputVars={domID:b,totalPages:c,visPages:d?d:10,activePage:e?e:1};var g=a("#"+f.inputVars.domID),h=g.width(),i=h*f.inputVars.visPages/f.inputVars.totalPages,j=i/f.inputVars.visPages,k=h/f.inputVars.visPages,l=Math.round(f.inputVars.visPages/2),m=function(b){var c=Math.round(b/j);a(".bPaginator_eWrap",g).css("left",-(k*c))},n=function(){var b=!1,c=0,d=0;a(".bPaginatorSlider",g).bind("mousedown",function(e){c=e.pageX,d=parseInt(a(".bPaginatorSlider_eFill",g).css("left"),10),b=!0}),a(".bPaginatorSlider",g).bind("mouseup",function(){b=!1}),g.bind("mouseout",function(){b=!1}),a(".bPaginatorSlider",g).bind("mousemove",function(e){if(b){var f=d+(e.pageX-c);f>=0&&h-i>=f&&(a(".bPaginatorSlider_eFill",g).css("left",d+(e.pageX-c)),m(f))}})},o=function(){g.append('<div class="bPaginator_eWrap"></div>'),g.append('<div class="bPaginatorSlider"><div class="bPaginatorSlider_eWrap"><div class="bPaginatorSlider_eFill" style="width:'+i+'px"></div></div></div>');for(var b=0;b<f.inputVars.totalPages;b++)a(".bPaginator_eWrap",g).append('<a class="bPaginator_eLink" href="#'+b+'">'+(b+1)+"</a>"),b+1===f.inputVars.activePage&&a(".bPaginator_eLink",g).eq(b).addClass("active");var c=a(".bPaginator_eLink",g).width();a(".bPaginator_eLink",g).css({marginLeft:(k-c-2)/2,marginRight:(k-c-2)/2}),a(".bPaginator_eWrap",g).addClass("clearfix").width(k*f.inputVars.totalPages)};f.setActive=function(b){var c=parseInt(a(".bPaginator_eWrap",g).css("left"),10),d=parseInt(a(".bPaginatorSlider_eFill",g).css("left"),10),e=-1*Math.round(c/k),h=-(l-(b-e));a(".bPaginator_eLink",g).removeClass("active"),a(".bPaginator_eLink",g).eq(b).addClass("active"),c-h*k>0?(c=0,d=0):b>f.inputVars.totalPages-l?(c=Math.round(f.inputVars.totalPages-f.inputVars.visPages)*k*-1,d=Math.round(f.inputVars.totalPages-f.inputVars.visPages)*j):(c-=h*k,d+=h*j),a(".bPaginator_eWrap").animate({left:c}),a(".bPaginatorSlider_eFill",g).animate({left:d})},o(),n()};if(a("#promoCatalog").length){var c,d,e,f,g=a("body"),h=a("#promoCatalog"),i=h.data("slides"),j=i.length,k=new b("promoCatalogPaginator",j,12,1),l=void 0!==h.data("use-interval")?h.data("use-interval"):!1,m=null,n=0,o=0,p=void 0!==h.data("use-hash")?h.data("use-hash"):!0,q=500,r=void 0!==h.data("use-carousel")?h.data("use-carousel"):!1,s=0,t=!1,u="undefined"!=typeof h.data("analytics-config")?h.data("analytics-config"):!1,v="undefined"!=typeof h.data("category-token")?h.data("category-token"):"",w=!1,x=function(){var b,c;for(r&&(a(".bPromoCatalogSlider_eArrow.mArLeft").show(),a(".bPromoCatalogSlider_eArrow.mArRight").show()),b=0;b<i.length;b++){c=tmpl("slide_tmpl",i[b]),a(c).length&&(c=a(c).attr("id","slide_id_"+b));var d=a(c).appendTo(".bPromoCatalogSliderWrap");ko.applyBindings(ENTER.UserModel,d[0]),""===a(".bPromoCatalogSliderWrap_eSlideLink").eq(b).attr("href")&&a(".bPromoCatalogSliderWrap_eSlideLink").eq(b).removeAttr("href"),a(".bPromoCatalogNav").append('<a id="promoCatalogSlide'+b+'" href="#'+b+'" class="bPromoCatalogNav_eLink">'+(1*b+1)+"</a>")}e=a(".bPromoCatalogSliderWrap_eSlide").width(),f=a(".bPromoCatalogSliderWrap").width(e*j+(470-e/2))},y=function F(a){var b=3e3,c=0;l&&(void 0==a?a=0:c=q,i.hasOwnProperty(a)&&i[a].hasOwnProperty("time")&&(b=i[a].time),b+=c,m=setTimeout(function(){a++,r||a>=j&&(a=0),D(a),F(a)},b))},z=function(){m&&clearTimeout(m)},A=function(b){var c=a(this).hasClass("mArLeft")?"-1":"1",d=o+1*c;return b.preventDefault(),t?!1:(z(),D(d),void y(d))},B=function(b){var c;return b.preventDefault(),a(this).hasClass("active")?!1:t?!1:(c=1*a(this).attr("href").slice(1),z(),r?C(c):D(c),void y(c))},C=function(b){var c,d=a(".jsPromoCatalogSliderWrap"),e=a(".bPromoCatalogSliderWrap_eSlide",d);void 0===b&&(b=0),c=e.index(a("#slide_id_"+b,d)),D(c)},D=function(b){var c,f,g=a(".bPromoCatalogSlider_eArrow.mArLeft"),h=a(".bPromoCatalogSlider_eArrow.mArRight"),l=a(".jsPromoCatalogSliderWrap"),m=function(){var b=a(".bPromoCatalogSliderWrap_eSlide",l);c=b.last(),b.last().remove(),l.prepend(c),l.css({left:l.position().left-e})},n=function(){var b=a(".bPromoCatalogSliderWrap_eSlide",l);c=b.first(),b.first().remove(),l.append(c),l.css({left:l.position().left+e})};d=b,o=b,r?(b>j-1?(n(),s++,b=0,o=j-1):0>b&&(m(),s--,b=j-1,o=0),d=a(".jsPromoCatalogSliderWrap .bPromoCatalogSliderWrap_eSlide").eq(o).attr("id").replace("slide_id_","")):(0===b?g.hide():g.show(),b===j-1?h.hide():h.show()),t=!0,a(".bPromoCatalogSliderWrap").animate({left:-(e*o)},q,function(){t=!1}),k.setActive(d),p&&(window.location.hash="slide"+(1*d+1)),f=i[d],f.hasOwnProperty("title")&&f.hasOwnProperty("time")&&E.checkRule("collection_view")&&E.collectionShow(f.title,1*d+1,f.time)},E={init:function(){if(E.isAnalyticsEnabled){var b=function(){var b,c,d=a(this),e=d.parent(".bPromoCatalogSliderWrap_eSlide");e.length&&e.attr("id")&&(b=e.attr("id").replace("slide_id_",""),c=i[b],c.hasOwnProperty("title")&&E.collectionClick(c.title,1*b+1))},c=function(){var b,c,d,e,f=a(this),g=f.parents(".bPromoCatalogSliderWrap_eSlide");g.length&&g.attr("id")&&(b=g.attr("id"),c=b.replace("slide_id_",""),d=i[c],e=a(".mTchiboSlider #"+b+" .prodItem > a").index(this),-1!=e&&d.hasOwnProperty("title")&&void 0!=typeof d.products[e].name&&E.productClick(d.title,d.products[e].name,1*e+1))};E.checkRule("collection_click")&&g.on("click",".mTchiboSlider .bPromoCatalogSliderWrap_eSlideLink",b),E.checkRule("product_click")&&g.on("click",".mTchiboSlider .prodItem > a",c),E.pageVisibility()}},pageVisibility:function(){var a,b,c=function(){w=document[a]?!0:!1};E.isAnalyticsEnabled&&u.hasOwnProperty("use_page_visibility")&&1==u.use_page_visibility&&("undefined"!=typeof document.hidden?(a="hidden",b="visibilitychange"):"undefined"!=typeof document.mozHidden?(a="mozHidden",b="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(a="msHidden",b="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(a="webkitHidden",b="webkitvisibilitychange"),c(),"undefined"==typeof document.addEventListener||"undefined"==typeof a||document.addEventListener(b,c,!1))},collectionShow:function(){},collectionClick:function(a,b){var c;E.isAnalyticsEnabled&&"undefined"!=typeof _gaq&&"undefined"!=typeof a&&"undefined"!=typeof b&&(c=["_trackEvent","collection_click",a+"_"+b],_gaq.push(c))},productClick:function(a,b,c){var d;E.isAnalyticsEnabled&&"undefined"!=typeof _gaq&&"undefined"!=typeof a&&"undefined"!=typeof b&&"undefined"!=typeof c&&(d=["_trackEvent","item_click",a+"_"+b,c.toString()],_gaq.push(d))},isAnalyticsEnabled:function(){return u&&u.hasOwnProperty("enabled")&&1==u.enabled},checkRule:function(a){return E.isAnalyticsEnabled&&"undefined"!=typeof a&&u.hasOwnProperty(a)&&1==u[a].enabled&&(1==u[a].tchiboOnly&&"tchibo"===v||1!=u[a].tchiboOnly)?!0:!1}};a(function(){x(),E.init(),g.on("click",".bPromoCatalogSlider_eArrow",A),g.on("click",".bPaginator_eLink",B),p&&(c=window.location.hash,c.indexOf("slide")+1&&(n=parseInt(c.slice(6),10)-1,D(n))),y(n),i.hasOwnProperty(n)&&i[n].hasOwnProperty("title")&&i[n].hasOwnProperty("time")&&E.checkRule("collection_view")&&E.collectionShow(i[n].title,1*n+1,i[n].time)})}}(jQuery),function(){var a;$.ajaxSetup({error:function(b){if(403==b.status){if(a=$("#auth-block"),!a.length)return;a.lightbox_me({centered:!0,autofocus:!0,onLoad:function(){a.find("input:first").focus()}})}}})}(),function(){var a=$("body"),b="subscribed",c=function(){var a=$(".bSubscribeLightboxPopup"),c=$(".bSubscribeLightboxPopup__eInput"),d=$(".bSubscribeLightboxPopup__eBtn"),e={show:!window.docCookies.hasItem(b),agreed:1===window.docCookies.getItem(b)},f=new FormValidator({fields:[{fieldNode:c,customErr:"Неправильный емейл",require:!0,validBy:"isEmail"}]}),g=function(){var b=c.val(),e=$(this).data("url"),g=function(b){return b.success?(a.html('<span class="bSubscribeLightboxPopup__eTitle mType">Спасибо! подтверждение подписки отправлено на указанный e-mail</span>'),window.docCookies.setItem("subscribed",1,15768e4,"/"),setTimeout(function(){a.slideUp(300)},3e3),void("undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Account","Emailing sign up","Page top"]))):!1};return d.hasClass("mDisabled")?!1:(f.validate({onInvalid:function(a){},onValid:function(){$.post(e,{email:b},g)}}),!1)},h=function(){var b=$(".bSubscribeLightboxPopup__eNotNow"),c=function(b){b.preventDefault();var c=$(this).data("url");a.slideUp(300),window.docCookies.setItem("subscribed",0,15768e4,"/"),$.post(c)};a.slideDown(300),d.bind("click",g),b.off("click"),b.bind("click",c)};return c.placeholder(),e.show?void h():!1};a.bind("showsubscribe",c),a.trigger("showsubscribe")}(),function(){$(".js-siteVersionSwitcher").click(function(a){a.preventDefault();var b=window.location.host,c=b.split(".");c.length>2&&(b=c[c.length-2]+"."+c[c.length-1]);var d=$(a.currentTarget).data("config");document.cookie=d.cookieName+"=1; expires="+new Date(Date.now()+1e3*d.cookieLifetime).toUTCString()+"; domain="+b+"; path=/",location=a.currentTarget.href})}(),function(){var a=$("body"),b=$("div.searchbox form"),c=b.find("input.searchtext"),d=$("#searchAutocomplete"),e=$(".bSearchSuggest__eRes"),f=-1,g=0,h={},i=null,j=function(){var a=e.eq(f).attr("href"),b=e.eq(f).hasClass("bSearchSuggest__eCategoryRes")?"suggest_category":"suggest_product";"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Search",b,a])},k=function(){var a=c.val(),b=function(b){b.success&&(h[a]=b.content,d.html(b.content),e=$(".bSearchSuggest__eRes"),g=e.length,g&&setTimeout(searchInputFocusin,99))},f=function(){var c="/search/autocomplete?q=";return a.length<3?!1:(c+=encodeURI(a),void $.ajax({type:"GET",url:c,success:b}))};return 0===a.length?(d.empty(),!1):(clearTimeout(i),h[a]?(b(h[a]),!1):void(i=setTimeout(f,300)))},l=function(){var a=c.val().replace(/(^\s*)|(\s*$)/g,"").replace(/(\s+)/g," ");c.val(a)};suggestKeyUp=function(a){var b=a.which;return b>=37&&40>=b||27===b||13===b?!1:void k()},suggestKeyDown=function(a){var b=a.which,c=function(){e.removeClass("hover").eq(f).addClass("hover")},h=function(){f-1>=0?(f--,c()):(f=-1,e.removeClass("hover"),$(this).focus())},i=function(){g-1>=f+1&&(f++,c())},k=function(){var a=e.eq(f).attr("href");j(),document.location.href=a};return 38===b?(h(),!1):40===b?(i(),!1):27===b?(d.empty(),!1):13===b&&(l(),-1!==f)?(k(),!1):void 0},searchSubmit=function(){var a=c.attr("value");return 0===a.length?!1:void l()},searchInputFocusin=function(){d.show()},suggestCloser=function(a){var b=a.target.className;b.indexOf("bSearchSuggest")+1||b.indexOf("searchtext")+1||d.hide()},hoverForItem=function(){var a=0;e.removeClass("hover"),a=$(this).addClass("hover").index(),f=a-1},searchHintSelect=function(){var a=$(this).text();c.val(a+" ").focus(),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","tooltip",a]),k()},$(document).ready(function(){c.bind("keydown",suggestKeyDown),c.bind("keyup",suggestKeyUp),c.bind("focus",searchInputFocusin),b.bind("submit",searchSubmit),c.placeholder(),a.bind("click",suggestCloser),a.on("mouseenter",".bSearchSuggest__eRes",hoverForItem),a.on("click",".bSearchSuggest__eRes",j),a.on("click",".sHint_value",searchHintSelect)})}(),function(){if(/catalog\/tchibo/.test(document.location.href)&&window.history&&window.history.replaceState){var a=window.history;$(window).on("beforeunload",function(){a.replaceState({pageYOffset:pageYOffset},"")}),a&&a.state&&a.state.pageYOffset&&window.scrollTo(0,a.state.pageYOffset)}}(),function(){var a=300,b=600,c=15,d=null,e=null,f=!1,g=null,h=null,i=null,j=null,k=null,l={x:0,y:0},m={x:0,y:0},n={x:0,y:0},o={x:0,y:0},p=function(a){d=new Date,e=a,$(".bMainMenuLevel-2__eItem").removeClass("hover"),a.addClass("hover")},q=function(){var b=$(this);b.hasClass("jsEmptyChild")||(d=new Date,f=!0,setTimeout(function(){f&&new Date-d>a&&p(b)},a+20),b.find(".lazyMenuImg").each(function(a,b){var c=$(b);c.attr("src",c.data("src"))}))},r=function(){var a=$(this);a.removeClass("hover"),f=!1},s=function(){l={x:o.x,y:o.y-$(window).scrollTop()},m={x:k.left-c,y:k.top-$(window).scrollTop()},n={x:k.left-c,y:k.top+k.height-$(window).scrollTop()}},t=function(){var a=(l.x-o.x)*(m.y-l.y)-(m.x-l.x)*(l.y-o.y),b=(m.x-o.x)*(n.y-m.y)-(n.x-m.x)*(m.y-o.y),d=(n.x-o.x)*(l.y-n.y)-(l.x-n.x)*(n.y-o.y);return a>=0&&b>=0&&d>=0||0>=a&&0>=b&&0>=d||o.x>=m.x&&o.x<=m.x+c&&o.y>=m.y&&o.y<=n.y?!0:!1},u=function(a){o={x:a.pageX,y:a.pageY-$(window).scrollTop()};var b=$(this);h&&b.attr("class")===h.attr("class")&&(z(b),g=new Date),y(b)},v=function(a){h=a,a.addClass("hover"),g=new Date,z(a)},w=function(){var a=$(this);y(a),a.addClass("hoverNowLvl2"),g&&new Date-g<=b&&t()&&setTimeout(function(){a.hasClass("hoverNowLvl2")&&new Date-g>b&&y(a)},b+20)},x=function(){var a=$(this);a.removeClass("hoverNowLvl2")},y=function(a){g?(!t()||g&&new Date-g>b&&t())&&(h.removeClass("hover"),v(a)):v(a)},z=function(a){i=A(a),j=A(a.find(".bMainMenuLevel-3"));var b=a.find(".bMainMenuLevel-2__eTitle")[0].offsetWidth;k={top:j.top,left:j.left+b,width:j.width-b,height:j.height},s()},A=function(a){var b=$(a).width(),c=$(a).height();a=a[0];for(var d=0,e=0;a&&!isNaN(a.offsetLeft)&&!isNaN(a.offsetTop);)d+=a.offsetLeft-a.scrollLeft,e+=a.offsetTop-a.scrollTop,a=a.offsetParent;return{top:e,left:d,width:b,height:c}};$(".bMainMenuLevel-1__eItem").mouseenter(q),$(".bMainMenuLevel-1__eItem").mouseleave(r),$(".bMainMenuLevel-2__eItem").mouseenter(w),$(".bMainMenuLevel-2__eItem").mousemove(u),$(".bMainMenuLevel-2__eItem").mouseleave(x)}(),function(){var a=$("#upper"),b=!1,c=function(){$(window).scrollTop()>600&&!b?(b=!0,a.animate({marginTop:"0"},400)):$(window).scrollTop()<600&&b&&(b=!1,a.animate({marginTop:"-55px"},400))},d=function(){return $(window).scrollTo("0px",400),!1};$(window).scroll(c),a.bind("click",d)}(),function(a){function b(a,b){$.each(r,function(){this.removeClass(s)}),a?p.show(0,b||function(){}):p.slideDown(),p.length&&q.css("visibility","hidden")}function c(){p.slideUp(),q.css("visibility","visible")}function d(a){x||(l&&l.length&&w.scrollTop()>=l.offset().top&&!a?b():c())}function e(){return $.scrollTo(m,500),a.catalog.filter.openFilter(),!1}function f(){function a(){var a=$(".topbarfix_cartOn");a.length&&a.slideUp(300,function(){a.removeAttr("style")})}function b(){y&&o.showOverlay&&y.fadeOut(100,function(){y.off("click"),y.remove(),o.showOverlay=!1,x=!1,d()})}var c=p.find(".topbarfix_cart"),e=p.find(".topbarfix_log"),f="mOpenedPopup",g=c.find(".hintDd");return g.hasClass("mhintDdOn")?(g.removeClass("mhintDdOn"),e.removeClass(f),c.removeClass(f),a(),b(),!1):(a(),void b())}function g(a,c,d){$.each(r,function(){this.removeClass(s)});var e=$(".topbarfix_cartOn");!o.showOverlay&&y&&(v.append(y),y.fadeIn(300),o.showOverlay=!0,y.on("click",f)),a?e.slideDown(300):e.show(),b(!0),d&&i(c,d),x=!0,$(document.body).trigger("showUserCart")}function h(){var b=$(this),c=function(a){var b,c=$(".jsChangeRegion"),d=c.length?c.data("region-id"):!1,e=window._rutarget||[];d&&a.hasOwnProperty("product")&&a.product.hasOwnProperty("id")&&(b={event:"removeFromCart",sku:a.product.id,regionId:d},e.push(b))},d=function(a){"undefined"!=typeof JSREObject&&a.hasOwnProperty("product")&&a.product.hasOwnProperty("id")&&JSREObject("cart_remove",a.product.id)},e=function(a){a.hasOwnProperty("product")&&a.product.hasOwnProperty("id")&&window.rrApiOnReady.push(function(){window.rrApi.removeFromBasket(a.product.id)})},h=function(a){"undefined"!=typeof a&&(e(a),c(a),d(a))},i=function(b){b.success&&(h(b),a.UserModel.cart.remove(function(a){return a.id==b.product.id}),$(".js-basketLineDeleteLink-"+b.product.id).click(),0==a.UserModel.cart().length?f():g(),v.trigger("removeFromCart",[b.product]))};return $.ajax({type:"GET",url:b.attr("href"),success:i}),!1}function i(b,c){function d(c){if(c.success&&o.showOverlay&&(g.find(".bGoodsSlider").remove(),e=$(c.content)[0],g.append(e),g.addClass("mhintDdOn"),$(e).goodsSlider(),ko.applyBindings(a.UserModel,e),b.product&&b.product.article)){if(c.data)try{rrApi.recomTrack(c.data.method,c.data.id,c.data.recommendations)}catch(d){}"function"==typeof _gaq&&_gaq.push(["_trackEvent","cart_recommendation","cart_rec_shown",b.product.article]),"function"==typeof _kmq&&_kmq.push(["record","cart recommendation shown",{"SKU cart rec shown":b.product.article}])}}var e,f=p.find(".topbarfix_cart"),g=f.find(".hintDd");c.url&&$.ajax({type:"GET",url:c.url,success:d})}function j(){var a=$(this).parents(".jsSliderItem").data("product");a.article&&(_gaq&&_gaq.push(["_trackEvent","cart_recommendation","cart_rec_clicked",a.article]),_kmq&&_kmq.push(["record","cart recommendation clicked",{"SKU cart rec clicked":a.article}]))}function k(a,b,c){if(a.stopPropagation(),!r[b]){var d=$(".js-compare-popup",c);$(".js-compare-popup-closer",d).click(function(){d.removeClass(s)}),$(".js-topbarfixLogin, .js-topbarfixNotEmptyCart",c).mouseover(function(){d.removeClass(s)}),$("html").click(function(){d.removeClass(s)}),$(d).click(function(a){a.stopPropagation()}),$(document).keyup(function(a){27==a.keyCode&&d.removeClass(s)}),r[b]=d}r[b].addClass(s)}var l,m,n=a.utils,o=n.extendApp("ENTER.userBar"),p=o.userBarFixed=$(".topbarfix-fx"),q=o.userBarStatic=$(".topbarfix-stc"),r={},s="topbarfix_cmpr_popup-show",t=p.find(".js-userbar-upLink"),u=p.data("value"),v=$("body"),w=$(window),x=!1,y=$("<div>").css({position:"fixed",display:"none",width:"100%",height:"100%",top:0,left:0,zIndex:900,background:"black",opacity:.4});o.showOverlay=!1,o.show=b,v.on("click",".jsUpsaleProduct",j),q.on("click",".jsCartDelete",h),$(".js-noProductsForCompareLink",p).click(function(a){k(a,"fixed",p)}),$(".js-noProductsForCompareLink",q).click(function(a){k(a,"static",q)}),p.length?(v.on("addtocart",g),p.on("click",".jsCartDelete",h),l=$(u.target),m=u.filterTarget?$(u.filterTarget):l,t.length&&t.on("click",e),l.length?w.on("scroll",function(){d()}):w.on("scroll",function(){d(!0)})):(y.remove(),y=!1)}(window.ENTER);