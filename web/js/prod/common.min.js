(function(e,t,o,r){o.ajaxSetup({timeout:1e4,statusCode:{404:function(){var e=this.url,t={event:"ajax_error",type:"404 ошибка",ajaxUrl:e};r.utils.logError(t),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","404 ошибка, страница не найдена"])},401:function(){o("#auth-block").length?o("#auth-block").lightbox_me({centered:!0,onLoad:function(){o("#auth-block").find("input:first").focus()}}):"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","401 ошибка, авторизуйтесь заново"])},500:function(){var e=this.url,t={event:"ajax_error",type:"500 ошибка",ajaxUrl:e};r.utils.logError(t),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","500 сервер перегружен"])},503:function(){var e=this.url,t={event:"ajax_error",type:"503 ошибка",ajaxUrl:e};r.utils.logError(t),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","503 ошибка, сервер перегружен"])},504:function(){var e=this.url,t={event:"ajax_error",type:"504 ошибка",ajaxUrl:e};r.utils.logError(t),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","504 ошибка, проверьте соединение с интернетом"])}},error:function(e,t){var o=this.url,i={event:"ajax_error",type:"неизвестная ajax ошибка",ajaxUrl:o};if("error"===e.statusText)r.utils.logError(i),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","неизвестная ajax ошибка"]);else if("timeout"===t)return}})})(this,this.document,this.jQuery,this.ENTER),function(){var e=!1,t=!1,o=function(){e?($("#mobilePhoneWrapper").hide(),$("#mobilePhoneWrapper").parent().find(".red").html(""),e=!1):($("#mobilePhoneWrapper").show(),e=!0)},r=function(){t?($("#emailWrapper").hide(),$("#emailWrapper").parent().find(".red").html(""),t=!1):($("#emailWrapper").show(),t=!0)};$(document).ready(function(){e=$(".smsCheckbox").hasClass("checked"),$("#user_mobile_phone").val()||$(".smsCheckbox").bind("click",o),t=$(".emailCheckbox").hasClass("checked"),$("#user_email").val()||$(".emailCheckbox").bind("click",r)})}(),function(e){var t=$("body"),o=e.config.clientCart,r=function r(){var e=$(this),o=e.attr("href"),r=function r(o){var r=e.data("group"),i=e.data("upsale")?e.data("upsale"):null,n=e.parents(".jsSliderItem").data("product");return o.success?(e.removeClass("mLoading"),o.product&&(o.product.isUpsale=n&&n.isUpsale?!0:!1,o.product.fromUpsale=i&&i.fromUpsale?!0:!1),$('.jsBuyButton[data-group="'+r+'"]').html("В корзине").addClass("mBought").attr("href","/cart"),t.trigger("addtocart",[o]),t.trigger("getupsale",[o,i]),t.trigger("updatespinner",[r]),void 0):!1};return $.get(o,r),!1},i=function i(){var e=$(this),t=e.attr("href");return e.hasClass("mDisabled")?!1:e.hasClass("mBought")?(document.location.href(t),!1):(e.addClass("mLoading"),e.trigger("buy"),!1)},n=function n(){var e,t,r=o.products;for(console.info("markCartButton"),e=0,t=r.length;t>e;e++)$("."+r[e].cartButton.id).html("В корзине").addClass("mBought").attr("href","/cart")};$(document).ready(function(){t.bind("markcartbutton",n),t.on("click",".jsBuyButton",i),t.on("buy",".jsBuyButton",r)})}(window.ENTER),function(e){var t=e.utils,o=t.blackBox,r=$("body"),i=function i(e,t){var o=t.product,r=t.service,i=t.warranty,n=window.location.href,a={};"undefined"!=typeof _kmq&&(o&&(a={"Add to Cart SKU":o.article,"Add to Cart SKU Quantity":o.quantity,"Add to Cart Product Name":o.name,"Add to Cart Root category":o.category[0].name,"Add to Cart Root ID":o.category[0].id,"Add to Cart Category name":o.category?o.category[o.category.length-1].name:0,"Add to Cart Category ID":o.category?o.category[o.category.length-1].id:0,"Add to Cart SKU Price":o.price,"Add to Cart Page URL":n,"Add to Cart F1 Quantity":o.serviceQuantity},_kmq.push(["record","Add to Cart",a]),o.isUpsale&&_kmq.push(["record","cart rec added from rec",{"SKU cart added from rec":o.article}]),o.fromUpsale&&_kmq.push(["record","cart recommendation added",{"SKU cart rec added":o.article}])),r&&(a={"Add F1 F1 Name":r.name,"Add F1 F1 Price":r.price,"Add F1 SKU":o.article,"Add F1 Product Name":o.name,"Add F1 Root category":o.category[0].name,"Add F1 Root ID":o.category[0].id,"Add F1 Category name":o.category?o.category[o.category.length-1].name:0,"Add F1 Category ID":o.category?o.category[o.category.length-1].id:0},_kmq.push(["record","Add F1",a])),i&&(a={"Add Warranty Warranty Name":i.name,"Add Warranty Warranty Price":i.price,"Add Warranty SKU":o.article,"Add Warranty Product Name":o.name,"Add Warranty Root category":o.category[0].name,"Add Warranty Root ID":o.category[0].id,"Add Warranty Category name":o.category?o.category[o.category.length-1].name:0,"Add Warranty Category ID":o.category?o.category[o.category.length-1].id:0},_kmq.push(["record","Add Warranty",a])))},n=function n(e,t){var o=t.product;o&&"undefined"!=typeof _gaq&&(_gaq.push(["_trackEvent","Add2Basket","product",o.article]),o.isUpsale&&_gaq.push(["_trackEvent","cart_recommendation","cart_rec_added_from_rec",o.article]),o.fromUpsale&&_gaq.push(["_trackEvent","cart_recommendation","cart_rec_added_to_cart",o.article]))},a=function a(e,t){var o=t.product,r=o.id,i=o.category?o.category[o.category.length-1].id:0,n="http://ad.adriver.ru/cgi-bin/rle.cgi?sid=182615&sz=add_basket&custom=10="+r+";11="+i+"&bt=55&pz=0&rnd=![rnd]",a=document,s=a.createElement("IMG"),d=a.body;n=n.replace(/!\[rnd\]/,Math.round(9999999*Math.random()))+"&tail256="+escape(a.referrer||"unknown"),s.style.position="absolute",s.style.width=s.style.height="0px",s.onload=s.onerror=function(){d.removeChild(s),s=d=null},s.src=n,d.insertBefore(s,d.firstChild)},s=function s(e,o){var r,i=o.product;if("object"==typeof rcApi)try{rcApi.addToBasket(i.id)}catch(n){r={event:"rcApi.addToBasket",type:"ошибка отправки данных в RetailRocket",err:n},t.logError(r)}},d=function d(e,t){t.redirect?(console.warn("redirect"),document.location.href=t.redirect):o&&o.basket().add(t)};r.on("addtocart",d),r.on("addtocart",i),r.on("addtocart",n),r.on("addtocart",a),r.on("addtocart",s)}(window.ENTER),function(e){var t=$("body"),o=$(".popupRegion"),r=$("#jscity"),i=$("#jschangecity"),n=o.find(".inputClear"),a=$(".jsChangeRegion"),s=$(".jsChangeRegionAnalytics"),d=o.find(".regionSlidesWrap"),c=o.find(".moreCity"),l=o.find(".leftArr"),u=o.find(".rightArr"),h=o.find(".regionSlides"),m=o.find(".regionSlides_slide");r.autocomplete({autoFocus:!0,appendTo:"#jscities",source:function(e,t){$.ajax({url:r.data("url-autocomplete"),dataType:"json",data:{q:e.term},success:function(e){var o=e.data.slice(0,15);t($.map(o,function(e){return{label:e.name,value:e.name,url:e.url}}))}})},minLength:2,select:function(e,t){i.data("url",t.item.url),i.removeClass("mDisabled")},open:function(){$(this).removeClass("ui-corner-all").addClass("ui-corner-top")},close:function(){$(this).removeClass("ui-corner-top").addClass("ui-corner-all")}});var g=function g(){o.lightbox_me({autofocus:!0,onLoad:function(){r.val().length&&(r.putCursorAtEnd(),i.removeClass("mDisabled"))},onClose:function(){var t=a.data("region-id");e.docCookies.hasItem("geoshop")||e.docCookies.setItem("geoshop",t,31536e3,"/")}}),"/"===document.location.pathname&&(console.info("run analytics for main page"),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","citySelector","viewed"]))},f=function f(){var e=$(this),t=e.data("autoresolve-url"),o=function o(e){if(!e.data.length)return $(".popupRegion .mAutoresolve").html(""),!1;var t=e.data[0].url,o=e.data[0].name,r=e.data[0].id;return 14974===r||108136===r?!1:($(".popupRegion .mAutoresolve").length?$(".popupRegion .mAutoresolve").html('<a href="'+t+'">'+o+"</a>"):$(".popupRegion .cityInline").prepend('<div class="cityItem mAutoresolve"><a href="'+t+'">'+o+"</a></div>"),void 0)};return"undefined"!==t&&$.ajax({type:"GET",url:t,success:o}),g(),!1},p=function p(){var e=1*m.width(),t=1*h.width(),o=parseInt(h.css("left"),10);return l.show(),h.animate({left:o-e}),-t>=o-2*e&&u.hide(),!1},v=function v(){var e=1*m.width(),t=(1*h.width(),parseInt(h.css("left"),10));return u.show(),h.animate({left:t+e}),t+2*e>=0&&l.hide(),!1},y=function y(){return $(this).toggleClass("mExpand"),d.slideToggle(300),!1},_=function _(){return r.val(""),n.hide(),!1},b=function b(){$(this).val()?n.show():n.hide()},k=function k(e){"/"===document.location.pathname&&(console.info("run analytics for main page "+e),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","citySelector","selected",e]))},C=function C(){var e=$(this).text();k(e)},w=function w(){var t=$(this).data("url"),i=r.val();return k(i),t?e.location=t:o.trigger("close"),!1};i.on("click",w),c.on("click",y),n.on("click",_),u.on("click",p),l.on("click",v),r.on("keyup",b),t.on("click",".jsChangeRegion",f),s.on("click",C),e.docCookies.hasItem("geoshop")||g()}(this),function(){var e=$("input.bCustomInput"),t=$("body"),o=function o(){if($(this).is("[type=checkbox]")||$(this).is("[type=radio]")){var e=$(this),t=e.attr("id"),o=e.is("[type=checkbox]")?"checkbox":"radio",r=e.attr("name")||"",i=$('label[for="'+t+'"]');"checkbox"===o&&(e.is(":checked")?i.addClass("mChecked"):i.removeClass("mChecked")),"radio"===o&&e.is(":checked")&&($('input[name="'+r+'"]').each(function(){var e=$(this),t=e.attr("id");$('label[for="'+t+'"]').removeClass("mChecked")}),i.addClass("mChecked"))}};t.on("updateState",".bCustomInput",o),t.on("change",".bCustomInput",function(){$(this).trigger("updateState")}),e.trigger("updateState")}(),$(document).ready(function(){if($("#similarGoodsSlider").length){var e=$("#similarGoodsSlider"),t=e.find(".bSimilarGoodsSlider_eWrap"),o=e.find(".bSimilarGoodsSlider_eArrow"),r=0,i=0,n=0,a=0,s=0,d=function d(){var e=$(this),t={"Recommended Item Clicked Similar Recommendation Place":"product","Recommended Item Clicked Similar Clicked SKU":e.data("article"),"Recommended Item Clicked Similar Clicked Product Name":e.data("name"),"Recommended Item Clicked Similar Product Position":e.data("pos")};"undefined"!=typeof _kmq&&_kmq.push(["record","Recommended Item Clicked Similar",t])},c=function c(o){var s=e.find(".bSimilarGoodsSlider_eGoods");for(var d in o){var c=tmpl("similarGoodTmpl",o[d]);t.append(c)}r=s.width()+2*parseInt(s.css("paddingLeft"),10),n=s.length,a=r*n,t.width(a),n>0&&$(".bSimilarGoods").fadeIn(300,function(){i=e.width()}),4>n&&$(".bSimilarGoodsSlider_eArrow.mRight").hide()};$.getJSON($("#similarGoodsSlider").data("url"),function(e){if(!$.isEmptyObject(e)){var t=e;c(t)}}).done(function(){var o=e.find(".bSimilarGoodsSlider_eGoods");n=o.length,a=r*n,t.width(a),n>0&&$(".bSimilarGoods").fadeIn(300,function(){i=e.width()})}),o.bind("click",function(){return $(this).hasClass("mLeft")?s+=2*r:s-=2*r,i-a>=s?(s=i-a,$(".bSimilarGoodsSlider_eArrow.mRight").hide(),$(".bSimilarGoodsSlider_eArrow.mLeft").show()):s>=0?(s=0,$(".bSimilarGoodsSlider_eArrow.mLeft").hide(),$(".bSimilarGoodsSlider_eArrow.mRight").show()):o.show(),t.animate({left:s}),!1}),$(".bSimilarGoods.mProduct .bSimilarGoodsSlider_eGoods").on("click",d)}window.navigator.userAgent.indexOf("MSIE")>=0&&$(".allpageinner").on("hover",".goodsbox__inner",function(){$(this).toggleClass("hover")}),$("body").on("click",".goodsbox__inner",function(){$(this).attr("data-url")&&(window.location.href=$(this).attr("data-url"))});var l=function l(){var e=$("#_categoryData").data("category"),t={"Viewed Category Category Type":e.type,"Viewed Category Category Level":e.level,"Viewed Category Parent category":e.parent_category,"Viewed Category Category name":e.category,"Viewed Category Category ID":e.id};"undefined"!=typeof _kmq&&_kmq.push(["record","Viewed Category",t])},u=function u(){var e,t,o=$(this),r=!1,i=$("#_categoryData").data("category");e=o.parents("div.goodsbox__inner"),e.length||(e=o.parents("div.goodsboxlink")),t=e.length?e.data("add"):!1,t&&i&&(r={"Category Results Clicked Category Type":i.type,"Category Results Clicked Category Level":i.level,"Category Results Clicked Parent category":i.parent_category,"Category Results Clicked Category name":i.category,"Category Results Clicked Category ID":i.id,"Category Results Clicked SKU":t.article,"Category Results Clicked Product Name":t.name,"Category Results Clicked Page Number":t.page,"Category Results Clicked Product Position":t.position}),r&&"undefined"!=typeof _kmq&&_kmq.push(["record","Category Results Clicked",r])};$("#_categoryData").length&&(l(),$("body").delegate("div.goodsbox a","click",u));var h=function h(){var e=$("#_searchKiss").data("search"),t={"Search String":e.query,"Search Page URL":e.url,"Search Items Found":e.count};"undefined"!=typeof _kmq&&_kmq.push(["record","Search",t]);var o=function(){var t=$(this).data("add"),o={"Search Results Clicked Search String":e.query,"Search Results Clicked SKU":t.article,"Search Results Clicked Product Name":t.name,"Search Results Clicked Page Number":t.page,"Search Results Clicked Product Position":t.position};"undefined"!=typeof _kmq&&_kmq.push(["record","Search Results Clicked",o])};$(".goodsbox__inner").on("click",o),$(".goodsboxlink").on("click",o)};$("#_searchKiss").length&&h()}),function(){var e=$(".jsEnterprizeAuthLink"),t=function(t,o){o&&o.name&&e.length&&$.each(e,function(){$(this).removeClass("jsEnterprizeAuthLink")})};$("body").on("userLogged",t)}(),function(){var e=function e(){var e=$(this).data("goto");return $(document).stop().scrollTo($("#"+e),800),!1};$(document).ready(function(){$(".jsGoToId").bind("click",e)})}(),function(){var e=function(){var e=$(this);return e.hasClass("expanded")?(e.parent().parent().find(".toHide").hide(),e.html("Все метки"),e.removeClass("expanded")):(e.parent().parent().find(".toHide").show(),e.html("Основные метки"),e.addClass("expanded")),!1};$(document).ready(function(){$(".hotlinksToggle").bind("click",e)})}(),function(){$.ajax({url:"https://jira.enter.ru/s/ru_RU-istibo/773/3/1.2.4/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=2e17c5d6",type:"get",cache:!0,dataType:"script"}),window.ATL_JQ_PAGE_PROPS={triggerFunction:function(e){$("#jira").click(function(t){t.preventDefault(),e()})}}}(),function(ENTER){var constructors=ENTER.constructors,registerMailPhoneField=$(".jsRegisterUsername"),body=$("body"),authBlock=$("#auth-block"),forgotPwdLogin=$(".jsForgotPwdLogin"),resetPwdForm=$(".jsResetPwdForm"),registerForm=$(".jsRegisterForm"),loginForm=$(".jsLoginForm"),completeRegister=$(".jsRegisterFormComplete"),showLoginFormLink=$(".jsShowLoginForm"),signinValidationConfig={fields:[{fieldNode:$(".jsSigninUsername"),require:!0,customErr:"Не указан логин"},{fieldNode:$(".jsSigninPassword"),require:!0,customErr:"Не указан пароль"}]},signinValidator=new FormValidator(signinValidationConfig),registerValidationConfig={fields:[{fieldNode:$(".jsRegisterFirstName"),require:!0,customErr:"Не указано имя"},{fieldNode:registerMailPhoneField,validBy:"isEmail",require:!0,customErr:"Некорректно введен e-mail"}]},registerValidator=new FormValidator(registerValidationConfig),forgotPwdValidationConfig={fields:[{fieldNode:forgotPwdLogin,require:!0,customErr:"Не указан email или мобильный телефон",validateOnChange:!0}]},forgotValidator=new FormValidator(forgotPwdValidationConfig);constructors.Login=function(){"use strict";function Login(){return this instanceof Login?(this.form=null,this.redirect_to=null,body.on("click",".registerAnotherWayBtn",$.proxy(this.registerAnotherWay,this)),body.on("click",".bAuthLink",this.openAuth),body.on("click",".jsEnterprizeAuthLink",$.proxy(this.enterprizeAuthLinkClick,this)),$(".jsLoginForm, .jsRegisterForm, .jsResetPwdForm").data("redirect",!0).on("submit",$.proxy(this.formSubmit,this)),body.on("click",".jsForgotPwdTrigger, .jsRememberPwdTrigger",this.forgotFormToggle),body.on("click","#bUserlogoutLink",this.logoutLinkClickLog),showLoginFormLink.length&&(loginForm.hide(),body.on("click",".jsShowLoginForm",this.showLoginForm)),void 0):new Login}return Login.prototype.showError=function(e,t){var o=$("ul.error_list",this.form);return void 0!==t&&t(),o.length?o.html("<li>"+e+"</li>"):$(".bFormLogin__ePlaceTitle",this.form).after($('<ul class="error_list" />').append("<li>"+e+"</li>")),!1},Login.prototype.formErrorHandler=function(e){var t=this.getFormValidator(),o=$('[name="'+this.getFormName()+"["+e.field+']"]'),r=function r(){t._unmarkFieldError($(this))};return console.warn("Ошибка в поле"),t._markFieldError(o,e.message),o.bind("focus",r),!1},Login.serverErrorHandler={"default":function(e){return console.log("Обработчик ошибки"),e.error&&e.error.message?(this.showError(e.error.message,function(){document.location.href=e.redirect}),!1):(document.location.href=e.redirect,void 0)},0:function(e){var t=null;if(console.warn("Обработка ошибок формы"),e.redirect)return this.showError(e.error.message,function(){document.location.href=e.redirect}),void 0;$("ul.error_list",this.form).length&&$("ul.error_list",this.form).html("");for(var o=e.form.error.length-1;o>=0;o--)t=e.form.error[o],console.warn(t),"global"!==t.field&&null!==t.message?$.proxy(this.formErrorHandler,this)(t):"global"===t.field&&null!==t.message&&this.showError(t.message);return!1}},Login.prototype.checkEmail=function(){return registerMailPhoneField.hasClass("jsRegisterPhone")?!1:!0},Login.prototype.registerAnotherWay=function(){var e=$(".registerAnotherWay"),t=$(".registerAnotherWayBtn");return registerMailPhoneField.val(""),this.checkEmail()?(e.html("Ваш мобильный телефон:"),t.html("Ввести e-mail"),registerMailPhoneField.addClass("jsRegisterPhone"),registerValidator.setValidate(registerMailPhoneField,{validBy:"isPhone",customErr:"Некорректно введен телефон"}),$.mask.definitions.n="[0-9]",registerMailPhoneField.mask("+7 (nnn) nnn-nn-nn")):(e.html("Ваш e-mail:"),t.html("У меня нет e-mail"),registerMailPhoneField.removeClass("jsRegisterPhone"),registerValidator.setValidate(registerMailPhoneField,{validBy:"isEmail",customErr:"Некорректно введен e-mail"}),registerMailPhoneField.unmask()),!1},Login.prototype.openAuth=function(){return authBlock.lightbox_me({centered:!0,autofocus:!0,onLoad:function(){authBlock.find("input:first").focus()}}),!1},Login.prototype.enterprizeAuthLinkClick=function(e){e.preventDefault();var t=$(e.target),o=t.hasClass("jsEnterprizeAuthLink")?t:t.parents(".jsEnterprizeAuthLink"),r=o.attr("href");return r&&(this.redirect_to=r),this.openAuth(),!1},Login.prototype.submitBtnLoadingDisplay=function(e){if(e.length){var t=e.val(),o=e.data("loading-value");e.attr("disabled","disabled"===e.attr("disabled")?!1:!0).val(o).data("loading-value",t)}return!1},Login.prototype.getFormValidator=function(){return eval(this.getFormName()+"Validator")},Login.prototype.getFormName=function(){return this.form.hasClass("jsLoginForm")?"signin":this.form.hasClass("jsRegisterForm")?"register":this.form.hasClass("jsResetPwdForm")?"forgot":""},Login.prototype.formSubmit=function(e){e.preventDefault(),this.form=$(e.target);var t=this.form.serializeArray(),o=this.getFormValidator(),r=$(".jsSubmit",this.form),i=this.getUrlParams();i.redirect_to&&(this.redirect_to=i.redirect_to);var n=function(e){if(e.error)return console.warn("Form has error"),Login.serverErrorHandler.hasOwnProperty(e.error.code)?(console.log("Есть обработчик"),$.proxy(Login.serverErrorHandler[e.error.code],this)(e)):(console.log("Стандартный обработчик"),Login.serverErrorHandler["default"](e)),this.submitBtnLoadingDisplay(r),!1;if($.proxy(this.formSubmitLog,this),forgotPwdLogin.length&&forgotPwdLogin.is(":visible")&&(this.submitBtnLoadingDisplay(r),forgotPwdLogin.hide(),$(".jsForgotPwdLoginLabel",this.form).hide(),r.hide(),this.showError(e.notice.message)),console.log(this.form.data("redirect")),console.log(e.data.link),this.form.data("redirect")){if(e.data.link!==void 0)return console.info("try to redirect to2 "+e.data.link),console.log(typeof e.data.link),document.location.href=e.data.link,!1;completeRegister.html(e.message),completeRegister.show(),registerForm.hide(),this.showLoginForm()}else authBlock.trigger("close");$("#order-form").length&&($("#user-block").html('Привет, <strong><a href="'+e.data.link+'">'+e.data.user.first_name+"</a></strong>"),$("#order_recipient_first_name").val(e.data.user.first_name),$("#order_recipient_last_name").val(e.data.user.last_name),$("#order_recipient_phonenumbers").val(e.data.user.mobile_phone.slice(1)),$("#qiwi_phone").val(e.data.user.mobile_phone.slice(1)))},a=function(){this.submitBtnLoadingDisplay(r),t.push({name:"redirect_to",value:this.redirect_to?this.redirect_to:window.location.href}),$.post(this.form.attr("action"),t,$.proxy(n,this),"json")};return o.validate({onInvalid:function(e){console.warn("invalid"),console.log(e)},onValid:$.proxy(a,this)}),!1},Login.prototype.showLoginForm=function(){showLoginFormLink.hide(),loginForm.slideDown(300),$.scrollTo(loginForm,500)},Login.prototype.forgotFormToggle=function(){return resetPwdForm.is(":visible")?(resetPwdForm.hide(),loginForm.show()):(resetPwdForm.show(),loginForm.hide()),!1},Login.prototype.formSubmitLog=function(){var e="";"signin"===this.getFormName()?("undefined"!=typeof _gaq&&(e=-1!==this.form.find(".jsSigninUsername").val().search("@")?"email":"mobile",_gaq.push(["_trackEvent","Account","Log in",e,window.location.href])),"undefined"!=typeof _kmq&&_kmq.push(["identify",this.form.find(".jsSigninUsername").val()])):"register"===this.getFormName()?("undefined"!=typeof _gaq&&(e=this.checkEmail()?"email":"mobile",_gaq.push(["_trackEvent","Account","Create account",e])),"undefined"!=typeof _kmq&&_kmq.push(["identify",this.form.find(".jsRegisterUsername").val()])):"forgot"===this.getFormName()&&"undefined"!=typeof _gaq&&(e=-1!==this.form.find(".jsForgotPwdLogin").val().search("@")?"email":"mobile",_gaq.push(["_trackEvent","Account","Forgot password",e]))},Login.prototype.logoutLinkClickLog=function(){"undefined"!=typeof _kmq&&_kmq.push(["clearIdentity"])},Login.prototype.getUrlParams=function(){var e,t,o={},r=window.location.search.substring(1).split("&");for(t=0;r.length>t;t++)e=r[t].split("="),o[e[0]]=e[1]===void 0?"":e[1];return o},Login}(),$(document).ready(function(){new ENTER.constructors.Login})}(window.ENTER),$(document).ready(function(){function e(e){return"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","CategoryClick",e.data,window.location.pathname]),!0}$("body").on("click",".bSubscibe",function(){return $(this).hasClass("checked")?($(this).removeClass("checked"),$(this).find(".subscibe").removeAttr("checked"),$(this).find('input[name="subscribe"]').val(0)):($(this).addClass("checked"),$(this).find(".subscibe").attr("checked","checked"),$(this).find('input[name="subscribe"]').val(1)),!1}),$(".bMainMenuLevel-1__eLink").bind("click","Верхнее меню",e),$(".bMainMenuLevel-2__eLink").bind("click","Верхнее меню",e),$(".bMainMenuLevel-3__eLink").bind("click","Верхнее меню",e),$(".breadcrumbs").first().find("a").bind("click","Хлебные крошки сверху",e),$(".breadcrumbs-footer").find("a").bind("click","Хлебные крошки снизу",e),$(".bCtg__eMore").bind("click",function(e){e.preventDefault();var t=$(this);t.parent().find("li.hf").slideToggle();var o=t.find("a");o.text("еще..."==o.text()?"скрыть":"еще...")}),$(".product_buy-container").each(function(){var e=$(this).data("order");"object"!=typeof e||$.isEmptyObject(e)||$.ajax({url:$(this).data("url"),data:e,type:"POST",timeout:2e4})}),$(".searchtextClear").length&&($(".searchtextClear").each(function(){$(this).val().length?$(this).removeClass("vh"):$(this).addClass("vh")}),$(".searchtextClear").click(function(){$(this).siblings(".searchtext").val(""),$(this).addClass("vh"),$("#searchAutocomplete").length&&$("#searchAutocomplete").html("")})),function(){$(".bGoodsList .bGoodsList__eItem").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}),$(".bigcarousel-brand .goodsbox").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")})}()}),function(){var e=function e(e,t){var o=$(".bSubscribeLightboxPopupNotNow"),r=$(".bSubscribeLightboxPopup"),i=$(".bSubscribeLightboxPopup__eInput"),n=$(".bSubscribeLightboxPopup__eBtn"),a=function a(){var e=i.val(),t=$(this).data("url");return n.hasClass("mDisabled")?!1:($.post(t,{email:e},function(e){return e.success?(r.html('<span class="bSubscribeLightboxPopup__eTitle mType">Спасибо! подтверждение подписки отправлено на указанный e-mail</span>'),window.docCookies.setItem("subscribed",1,15768e4,"/"),setTimeout(function(){r.slideUp(300)},3e3),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Account","Emailing sign up","Page top"]),void 0):!1}),!1)},s=function s(){r.slideDown(300),n.bind("click",a),$(".bSubscribeLightboxPopup__eNotNow").bind("click",function(){var e=$(this).data("url");return r.slideUp(300,d),window.docCookies.setItem("subscribed",0,15768e4,"/"),$.post(e),!1})},d=function d(){o.slideDown(300),o.bind("click",function(){$(this).slideUp(300),s()})};return i.placeholder(),i.emailValidate({onValid:function(){i.removeClass("mError"),n.removeClass("mDisabled")},onInvalid:function(){n.addClass("mDisabled"),i.addClass("mError")}}),t.show?(s(),void 0):(t.agreed||d(),!1)};$("body").bind("showsubscribe",e)}(),function(){var e=$("body"),t=$("div.searchbox form"),o=t.find("input.searchtext"),r=$("#searchAutocomplete"),i=$(".bSearchSuggest__eRes"),n=-1,a=0,s={},d=null,c=function c(){var e=i.eq(n).attr("href"),t=i.eq(n).hasClass("bSearchSuggest__eCategoryRes")?"suggest_category":"suggest_product";"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Search",t,e])},l=function l(e){var t=e.which,n=o.attr("value"),c=function c(e){s[n]=e,r.html(e),i=$(".bSearchSuggest__eRes"),a=i.length},l=function l(){var e="/search/autocomplete?q="+encodeURI(n);$.ajax({type:"GET",url:e,success:c})};return t>=37&&40>=t||27===t||13===t?!1:0===n.length?(r.empty(),!1):(clearTimeout(d),s[n]?(c(s[n]),!1):(d=setTimeout(l,300),void 0))},u=function u(){var e=o.val().replace(/(^\s*)|(\s*$)/g,"").replace(/(\s+)/g," ");o.val(e)},h=function h(e){var t=e.which,o=function o(){i.removeClass("hover").eq(n).addClass("hover")},s=function s(){n-1>=0?(n--,o()):(n=-1,i.removeClass("hover"),$(this).focus())},d=function d(){a-1>=n+1&&(n++,o())},l=function l(){var e=i.eq(n).attr("href");c(),document.location.href=e};return 38===t?(s(),!1):40===t?(d(),!1):27===t?(r.empty(),!1):13===t&&(u(),-1!==n)?(l(),!1):void 0},m=function m(){var e=o.attr("value");return 0===e.length?!1:(u(),void 0)},g=function g(){r.show()},f=function f(e){var t=e.target.className;t.indexOf("bSearchSuggest")+1||t.indexOf("searchtext")+1||r.hide()},p=function p(){var e=0;i.removeClass("hover"),e=$(this).addClass("hover").index(),n=e-1},v=function v(){var e=$(this).text(),t=o.val();return t&&(e=t+" "+e),o.val(e+" ").focus()};$(document).ready(function(){o.bind("keydown",h),o.bind("keyup",l),o.bind("focus",g),t.bind("submit",m),o.placeholder(),e.bind("click",f),e.on("mouseenter",".bSearchSuggest__eRes",p),e.on("click",".bSearchSuggest__eRes",c),e.on("click",".sHint_value",v)})}(),function(){var e=300,t=600,o=15,r=null,i=null,n=!1,a=null,s=null,d=null,c=null,l=null,u={x:0,y:0},h={x:0,y:0},m={x:0,y:0},g={x:0,y:0},f=function(e){r=new Date,i=e,$(".bMainMenuLevel-2__eItem").removeClass("hover"),e.addClass("hover")},p=function(){var t=$(this);r=new Date,n=!0,setTimeout(function(){n&&new Date-r>e&&f(t)},e+20)},v=function(){var e=$(this);e.removeClass("hover"),n=!1},y=function(){u={x:g.x,y:g.y-$(window).scrollTop()},h={x:l.left-o,y:l.top-$(window).scrollTop()},m={x:l.left-o,y:l.top+l.height-$(window).scrollTop()}},_=function(){var e=(u.x-g.x)*(h.y-u.y)-(h.x-u.x)*(u.y-g.y),t=(h.x-g.x)*(m.y-h.y)-(m.x-h.x)*(h.y-g.y),r=(m.x-g.x)*(u.y-m.y)-(u.x-m.x)*(m.y-g.y);return e>=0&&t>=0&&r>=0||0>=e&&0>=t&&0>=r||g.x>=h.x&&g.x<=h.x+o&&g.y>=h.y&&g.y<=m.y?!0:!1},b=function(e){g={x:e.pageX,y:e.pageY-$(window).scrollTop()};var t=$(this);s&&t.attr("class")===s.attr("class")&&(L(t),a=new Date),x(t)},k=function(e){s=e,e.addClass("hover"),a=new Date,L(e)},C=function(){var e=$(this);x(e),e.addClass("hoverNowLvl2"),a&&t>=new Date-a&&_()&&setTimeout(function(){e.hasClass("hoverNowLvl2")&&new Date-a>t&&x(e)},t+20)},w=function(){var e=$(this);e.removeClass("hoverNowLvl2")},x=function(e){a?(!_()||a&&new Date-a>t&&_())&&(s.removeClass("hover"),k(e)):k(e)},L=function(e){d=S(e),c=S(e.find(".bMainMenuLevel-3"));var t=e.find(".bMainMenuLevel-2__eTitle")[0].offsetWidth;l={top:c.top,left:c.left+t,width:c.width-t,height:c.height},y()},S=function(e){var t=$(e).width(),o=$(e).height();e=e[0];for(var r=0,i=0;e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop);)r+=e.offsetLeft-e.scrollLeft,i+=e.offsetTop-e.scrollTop,e=e.offsetParent;return{top:i,left:r,width:t,height:o}};$(".bMainMenuLevel-1__eItem").mouseenter(p),$(".bMainMenuLevel-1__eItem").mouseleave(v),$(".bMainMenuLevel-2__eItem").mouseenter(C),$(".bMainMenuLevel-2__eItem").mousemove(b),$(".bMainMenuLevel-2__eItem").mouseleave(w)}(),function(){var e=$("#upper"),t=!1,o=function o(){$(window).scrollTop()>600&&!t?(t=!0,e.animate({marginTop:"0"},400)):600>$(window).scrollTop()&&t&&(t=!1,e.animate({marginTop:"-55px"},400))},r=function r(){return $(window).scrollTo("0px",400),!1};$(window).scroll(o),e.bind("click",r)}(),function(e){var t,o,r=e.config,i=e.utils,n=r.clientCart,a=i.extendApp("ENTER.userBar"),s=a.userBarFixed=$(".fixedTopBar.mFixed"),d=a.userBarStatic=$(".fixedTopBar.mStatic"),c=s.find(".fixedTopBar__upLink"),l=s.data("value"),u=$("body"),h=$(window),m=!1,g=$("<div>").css({position:"fixed",display:"none",width:"100%",height:"100%",top:0,left:0,zIndex:900,background:"black",opacity:.4});a.showOverlay=!1;var f=function f(){s.slideDown()},p=function p(){s.slideUp()},v=function v(){var e=h.scrollTop();m||(e>=o?f():p())},y=function y(){return $.scrollTo(t,500),e.catalog.filter.openFilter(),!1},_=function _(e,t){console.info("userbar::updateUserInfo"),console.log(t);var o,r=s.find(".fixedTopBar__logIn"),i=d.find(".fixedTopBar__logIn"),n=$("#userbar_user_tmpl"),a=n.data("partial");t&&t.name&&t.link&&(o=Mustache.render(n.html(),t,a),i.removeClass("mLogin"),r.removeClass("mLogin"),i.html(o),r.html(o))},b=function b(){console.info("userbar::showBuyInfo");var e,t,o=s.find(".fixedTopBar__cart"),r=s.find(".fixedTopBar__logIn"),d=$("#buyinfo_tmpl"),c=d.data("partial"),l="mOpenedPopup",h={};h.products=i.cloneObject(n.products),h.showTransparent=!!(h.products.length>3);var p=function p(){var t=o.find(".hintDd");return t.removeClass("mhintDdOn"),r.removeClass(l),o.removeClass(l),e.slideUp(300,function(){v(),e.remove(),m=!1}),a.showOverlay?(g.fadeOut(300,function(){g.off("click"),g.remove(),a.showOverlay=!1}),!1):void 0};h.products.reverse(),console.log(h),t=Mustache.render(d.html(),h,c),e=$(t).css({left:-129}),e.find(".cartList__item").eq(0).addClass("mHover"),r.addClass(l),o.addClass(l),o.append(e),a.showOverlay||(u.append(g),g.fadeIn(300),a.showOverlay=!0),e.slideDown(300),f(),m=!0,g.on("click",p)},k=function k(e,t){console.info("userbar::updateBasketInfo"),console.log(t),console.log(n);var o,r=s.find(".fixedTopBar__cart"),a=d.find(".fixedTopBar__cart"),c=$("#userbar_cart_tmpl"),l=c.data("partial");console.log("vars inited"),t.hasProducts=!1,t.showTransparent=!1,t&&t.quantity&&t.sum&&(0!==n.products.length&&(t.hasProducts=!0,t.products=i.cloneObject(n.products),t.products.reverse()),n.products.length>3&&(t.showTransparent=!0),t.sum=printPrice(t.sum),o=Mustache.render(c.html(),t,l),a.removeClass("mEmpty"),r.removeClass("mEmpty"),a.html(o),r.html(o))},C=function C(e,t,o){console.info("userbar::showUpsell");var r,i=s.find(".fixedTopBar__cart"),n=i.find(".hintDd"),a=function a(e){if(console.log(e),e.success){if(console.info('Получены рекомендации "С этим товаром также покупают" от RetailRocket'),n.find(".bGoodsSlider").remove(),r=$(e.content)[0],n.append(r),n.addClass("mhintDdOn"),$(r).goodsSlider(),!t.product.article)return console.warn("Не получен article продукта"),void 0;console.log("Трекинг товара при показе блока рекомендаций"),_gaq&&_gaq.push(["_trackEvent","cart_recommendation","cart_rec_shown",t.product.article]),_kmq&&_kmq.push(["record","cart recommendation shown",{"SKU cart rec shown":t.product.article}])
}};console.log(o),o.url&&$.ajax({type:"GET",url:o.url,success:a})},w=function w(){var e=$(this).parents(".jsSliderItem").data("product");return e.article?(console.log("Трекинг при клике по товару из списка рекомендаций"),_gaq&&_gaq.push(["_trackEvent","cart_recommendation","cart_rec_clicked",e.article]),_kmq&&_kmq.push(["record","cart recommendation clicked",{"SKU cart rec clicked":e.article}]),void 0):(console.warn("Не получен article продукта"),void 0)};console.info("Init userbar module"),console.log(l),u.on("click",".jsUpsaleProduct",w),u.on("userLogged",_),u.on("basketUpdate",k),u.on("addtocart",b),u.on("getupsale",C),s.length&&(t=$(l.target),c.length&&c.on("click",y),t.length&&(o=t.offset().top+s.height(),h.on("scroll",v)))}(window.ENTER);