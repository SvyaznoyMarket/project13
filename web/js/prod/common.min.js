$.ajaxSetup({timeout:1e4,statusCode:{404:function(){var e=this.url,t={event:"ajax_error",type:"404 ошибка",ajaxUrl:e};window.ENTER.utils.logError(t),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","404 ошибка, страница не найдена"])},401:function(){$("#auth-block").length?$("#auth-block").lightbox_me({centered:!0,onLoad:function(){$("#auth-block").find("input:first").focus()}}):"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","401 ошибка, авторизуйтесь заново"])},500:function(){var e=this.url,t={event:"ajax_error",type:"500 ошибка",ajaxUrl:e};window.ENTER.utils.logError(t),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","500 сервер перегружен"])},503:function(){var e=this.url,t={event:"ajax_error",type:"503 ошибка",ajaxUrl:e};window.ENTER.utils.logError(t),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","503 ошибка, сервер перегружен"])},504:function(){var e=this.url,t={event:"ajax_error",type:"504 ошибка",ajaxUrl:e};window.ENTER.utils.logError(t),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","504 ошибка, проверьте соединение с интернетом"])}},error:function(e,t){var r=this.url,i={event:"ajax_error",type:"неизвестная ajax ошибка",ajaxUrl:r};if("error"===e.statusText)window.ENTER.utils.logError(i),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","неизвестная ajax ошибка"]);else if("timeout"===t)return}}),function(){var e=!1,t=!1,r=function(){e?($("#mobilePhoneWrapper").hide(),$("#mobilePhoneWrapper").parent().find(".red").html(""),e=!1):($("#mobilePhoneWrapper").show(),e=!0)},i=function(){t?($("#emailWrapper").hide(),$("#emailWrapper").parent().find(".red").html(""),t=!1):($("#emailWrapper").show(),t=!0)};$(document).ready(function(){e=$(".smsCheckbox").hasClass("checked"),$("#user_mobile_phone").val()||$(".smsCheckbox").bind("click",r),t=$(".emailCheckbox").hasClass("checked"),$("#user_email").val()||$(".emailCheckbox").bind("click",i)})}(),function(){var e=$("body"),t=function t(){var t=$(this),r=t.attr("href"),i=function i(r){var i=t.data("group");return r.success?(t.removeClass("mLoading"),$('.jsBuyButton[data-group="'+i+'"]').html("В корзине").addClass("mBought").attr("href","/cart"),e.trigger("addtocart",[r]),e.trigger("updatespinner",[i]),void 0):!1};return $.get(r,i),!1},r=function r(){var e=$(this),t=e.attr("href");return e.hasClass("mDisabled")?!1:e.hasClass("mBought")?(document.location.href(t),!1):(e.addClass("mLoading"),e.trigger("buy"),!1)},i=function i(e,t){for(var r=0,i=t.product.length;i>r;r++)$("."+t.product[r].id).html("В корзине").addClass("mBought").attr("href","/cart")};$(document).ready(function(){e.bind("markcartbutton",i),e.on("click",".jsBuyButton",r),e.on("buy",".jsBuyButton",t)})}(),function(e){var t=e.ENTER.utils,r=t.blackBox,i=$("body"),n=function n(e,t){var r=t.product,i=t.service,n=t.warranty,a=window.location.href,o={};"undefined"!=typeof _kmq&&(r&&(o={"Add to Cart SKU":r.article,"Add to Cart SKU Quantity":r.quantity,"Add to Cart Product Name":r.name,"Add to Cart Root category":r.category[0].name,"Add to Cart Root ID":r.category[0].id,"Add to Cart Category name":r.category?r.category[r.category.length-1].name:0,"Add to Cart Category ID":r.category?r.category[r.category.length-1].id:0,"Add to Cart SKU Price":r.price,"Add to Cart Page URL":a,"Add to Cart F1 Quantity":r.serviceQuantity},_kmq.push(["record","Add to Cart",o])),i&&(o={"Add F1 F1 Name":i.name,"Add F1 F1 Price":i.price,"Add F1 SKU":r.article,"Add F1 Product Name":r.name,"Add F1 Root category":r.category[0].name,"Add F1 Root ID":r.category[0].id,"Add F1 Category name":r.category?r.category[r.category.length-1].name:0,"Add F1 Category ID":r.category?r.category[r.category.length-1].id:0},_kmq.push(["record","Add F1",o])),n&&(o={"Add Warranty Warranty Name":n.name,"Add Warranty Warranty Price":n.price,"Add Warranty SKU":r.article,"Add Warranty Product Name":r.name,"Add Warranty Root category":r.category[0].name,"Add Warranty Root ID":r.category[0].id,"Add Warranty Category name":r.category?r.category[r.category.length-1].name:0,"Add Warranty Category ID":r.category?r.category[r.category.length-1].id:0},_kmq.push(["record","Add Warranty",o])))},a=function a(e,t){var r=t.product;r&&"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Add2Basket","product",r.article])},o=function o(e,t){var r=t.product,i=r.id,n=r.category?r.category[r.category.length-1].id:0,a="http://ad.adriver.ru/cgi-bin/rle.cgi?sid=182615&sz=add_basket&custom=10="+i+";11="+n+"&bt=55&pz=0&rnd=![rnd]",o=document,s=o.createElement("IMG"),l=o.body;a=a.replace(/!\[rnd\]/,Math.round(9999999*Math.random()))+"&tail256="+escape(o.referrer||"unknown"),s.style.position="absolute",s.style.width=s.style.height="0px",s.onload=s.onerror=function(){l.removeChild(s),s=l=null},s.src=a,l.insertBefore(s,l.firstChild)},s=function s(e,r){var i,n=r.product;if("object"==typeof rcApi)try{rcApi.addToBasket(n.id)}catch(a){i={event:"rcApi.addToBasket",type:"ошибка отправки данных в RetailRocket",err:a},t.logError(i)}},l=function l(e,t){t.redirect?(console.warn("redirect"),document.location.href=t.redirect):r&&r.basket().add(t)};i.on("addtocart",l),i.on("addtocart",n),i.on("addtocart",a),i.on("addtocart",o),i.on("addtocart",s)}(this),function(e){var t=$("body"),r=$(".popupRegion"),i=$("#jscity"),n=$("#jschangecity"),a=r.find(".inputClear"),o=$(".jsChangeRegion"),s=$(".jsChangeRegionAnalytics"),l=r.find(".regionSlidesWrap"),c=r.find(".moreCity"),u=r.find(".leftArr"),h=r.find(".rightArr"),f=r.find(".regionSlides"),d=r.find(".regionSlides_slide");i.autocomplete({autoFocus:!0,appendTo:"#jscities",source:function(e,t){$.ajax({url:i.data("url-autocomplete"),dataType:"json",data:{q:e.term},success:function(e){var r=e.data.slice(0,15);t($.map(r,function(e){return{label:e.name,value:e.name,url:e.url}}))}})},minLength:2,select:function(e,t){n.data("url",t.item.url),n.removeClass("mDisabled")},open:function(){$(this).removeClass("ui-corner-all").addClass("ui-corner-top")},close:function(){$(this).removeClass("ui-corner-top").addClass("ui-corner-all")}});var p=function p(){r.lightbox_me({autofocus:!0,onLoad:function(){i.val().length&&(i.putCursorAtEnd(),n.removeClass("mDisabled"))},onClose:function(){var t=o.data("region-id");e.docCookies.hasItem("geoshop")||e.docCookies.setItem("geoshop",t,31536e3,"/")}}),"/"===document.location.pathname&&(console.info("run analytics for main page"),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","citySelector","viewed"]))},m=function m(){var e=$(this),t=e.data("autoresolve-url"),r=function r(e){if(!e.data.length)return $(".popupRegion .mAutoresolve").html(""),!1;var t=e.data[0].url,r=e.data[0].name,i=e.data[0].id;return 14974===i||108136===i?!1:($(".popupRegion .mAutoresolve").length?$(".popupRegion .mAutoresolve").html('<a href="'+t+'">'+r+"</a>"):$(".popupRegion .cityInline").prepend('<div class="cityItem mAutoresolve"><a href="'+t+'">'+r+"</a></div>"),void 0)};return"undefined"!==t&&$.ajax({type:"GET",url:t,success:r}),p(),!1},v=function v(){var e=1*d.width(),t=1*f.width(),r=parseInt(f.css("left"),10);return u.show(),f.animate({left:r-e}),-t>=r-2*e&&h.hide(),!1},_=function _(){var e=1*d.width(),t=(1*f.width(),parseInt(f.css("left"),10));return h.show(),f.animate({left:t+e}),t+2*e>=0&&u.hide(),!1},g=function g(){return $(this).toggleClass("mExpand"),l.slideToggle(300),!1},E=function E(){return i.val(""),a.hide(),!1},y=function y(){$(this).val()?a.show():a.hide()},T=function T(e){"/"===document.location.pathname&&(console.info("run analytics for main page "+e),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","citySelector","selected",e]))},b=function b(){var e=$(this).text();T(e)},R=function R(){var t=$(this).data("url"),n=i.val();return T(n),t?e.location=t:r.trigger("close"),!1};n.on("click",R),c.on("click",g),a.on("click",E),h.on("click",v),u.on("click",_),i.on("keyup",y),t.on("click",".jsChangeRegion",m),s.on("click",b),e.docCookies.hasItem("geoshop")||p()}(this),function(){var e=$("input.bCustomInput"),t=$("body"),r=function r(){if($(this).is("[type=checkbox]")||$(this).is("[type=radio]")){var e=$(this),t=e.attr("id"),r=e.is("[type=checkbox]")?"checkbox":"radio",i=e.attr("name")||"",n=$('label[for="'+t+'"]');"checkbox"===r&&(e.is(":checked")?n.addClass("mChecked"):n.removeClass("mChecked")),"radio"===r&&e.is(":checked")&&($('input[name="'+i+'"]').each(function(){var e=$(this),t=e.attr("id");$('label[for="'+t+'"]').removeClass("mChecked")}),n.addClass("mChecked"))}};t.on("updateState",".bCustomInput",r),t.on("change",".bCustomInput",function(){$(this).trigger("updateState")}),e.trigger("updateState")}(),$(document).ready(function(){if($("#similarGoodsSlider").length){var e=$("#similarGoodsSlider"),t=e.find(".bSimilarGoodsSlider_eWrap"),r=e.find(".bSimilarGoodsSlider_eArrow"),i=0,n=0,a=0,o=0,s=0,l=function l(){var e=$(this),t={"Recommended Item Clicked Similar Recommendation Place":"product","Recommended Item Clicked Similar Clicked SKU":e.data("article"),"Recommended Item Clicked Similar Clicked Product Name":e.data("name"),"Recommended Item Clicked Similar Product Position":e.data("pos")};"undefined"!=typeof _kmq&&_kmq.push(["record","Recommended Item Clicked Similar",t])},c=function c(r){var s=e.find(".bSimilarGoodsSlider_eGoods");for(var l in r){var c=tmpl("similarGoodTmpl",r[l]);t.append(c)}i=s.width()+2*parseInt(s.css("paddingLeft"),10),a=s.length,o=i*a,t.width(o),a>0&&$(".bSimilarGoods").fadeIn(300,function(){n=e.width()}),4>a&&$(".bSimilarGoodsSlider_eArrow.mRight").hide()};$.getJSON($("#similarGoodsSlider").data("url"),function(e){if(!$.isEmptyObject(e)){var t=e;c(t)}}).done(function(){var r=e.find(".bSimilarGoodsSlider_eGoods");a=r.length,o=i*a,t.width(o),a>0&&$(".bSimilarGoods").fadeIn(300,function(){n=e.width()})}),r.bind("click",function(){return $(this).hasClass("mLeft")?s+=2*i:s-=2*i,n-o>=s?(s=n-o,$(".bSimilarGoodsSlider_eArrow.mRight").hide(),$(".bSimilarGoodsSlider_eArrow.mLeft").show()):s>=0?(s=0,$(".bSimilarGoodsSlider_eArrow.mLeft").hide(),$(".bSimilarGoodsSlider_eArrow.mRight").show()):r.show(),t.animate({left:s}),!1}),$(".bSimilarGoods.mProduct .bSimilarGoodsSlider_eGoods").on("click",l)}window.navigator.userAgent.indexOf("MSIE")>=0&&$(".allpageinner").on("hover",".goodsbox__inner",function(){$(this).toggleClass("hover")}),$("body").on("click",".goodsbox__inner",function(){$(this).attr("data-url")&&(window.location.href=$(this).attr("data-url"))});var u=function u(){var e=$("#_categoryData").data("category"),t={"Viewed Category Category Type":e.type,"Viewed Category Category Level":e.level,"Viewed Category Parent category":e.parent_category,"Viewed Category Category name":e.category,"Viewed Category Category ID":e.id};"undefined"!=typeof _kmq&&_kmq.push(["record","Viewed Category",t])},h=function h(){var e,t,r=$(this),i=!1,n=$("#_categoryData").data("category");e=r.parents("div.goodsbox__inner"),e.length||(e=r.parents("div.goodsboxlink")),t=e.length?e.data("add"):!1,t&&n&&(i={"Category Results Clicked Category Type":n.type,"Category Results Clicked Category Level":n.level,"Category Results Clicked Parent category":n.parent_category,"Category Results Clicked Category name":n.category,"Category Results Clicked Category ID":n.id,"Category Results Clicked SKU":t.article,"Category Results Clicked Product Name":t.name,"Category Results Clicked Page Number":t.page,"Category Results Clicked Product Position":t.position}),i&&"undefined"!=typeof _kmq&&_kmq.push(["record","Category Results Clicked",i])};$("#_categoryData").length&&(u(),$("body").delegate("div.goodsbox a","click",h));var f=function f(){var e=$("#_searchKiss").data("search"),t={"Search String":e.query,"Search Page URL":e.url,"Search Items Found":e.count};"undefined"!=typeof _kmq&&_kmq.push(["record","Search",t]);var r=function(){var t=$(this).data("add"),r={"Search Results Clicked Search String":e.query,"Search Results Clicked SKU":t.article,"Search Results Clicked Product Name":t.name,"Search Results Clicked Page Number":t.page,"Search Results Clicked Product Position":t.position};"undefined"!=typeof _kmq&&_kmq.push(["record","Search Results Clicked",r])};$(".goodsbox__inner").on("click",r),$(".goodsboxlink").on("click",r)};$("#_searchKiss").length&&f()}),function(){var e=function e(){var e=$(this).data("goto");return $(document).stop().scrollTo($("#"+e),800),!1};$(document).ready(function(){$(".jsGoToId").bind("click",e)})}(),function(){var e=function(){var e=$(this);return e.hasClass("expanded")?(e.parent().parent().find(".toHide").hide(),e.html("Все метки"),e.removeClass("expanded")):(e.parent().parent().find(".toHide").show(),e.html("Основные метки"),e.addClass("expanded")),!1};$(document).ready(function(){$(".hotlinksToggle").bind("click",e)})}(),function(){$.ajax({url:"https://jira.enter.ru/s/ru_RU-istibo/773/3/1.2.4/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=2e17c5d6",type:"get",cache:!0,dataType:"script"}),window.ATL_JQ_PAGE_PROPS={triggerFunction:function(e){$("#jira").click(function(t){t.preventDefault(),e()})}}}(),function(ENTER){var constructors=ENTER.constructors,registerMailPhoneField=$(".jsRegisterUsername"),body=$("body"),authBlock=$("#auth-block"),forgotPwdLogin=$(".jsForgotPwdLogin"),resetPwdForm=$(".jsResetPwdForm"),registerForm=$(".jsRegisterForm"),loginForm=$(".jsLoginForm"),completeRegister=$(".jsRegisterFormComplete"),showLoginFormLink=$(".jsShowLoginForm"),signinValidationConfig={fields:[{fieldNode:$(".jsSigninUsername"),require:!0,customErr:"Не указан логин"},{fieldNode:$(".jsSigninPassword"),require:!0,customErr:"Не указан пароль"}]},signinValidator=new FormValidator(signinValidationConfig),registerValidationConfig={fields:[{fieldNode:$(".jsRegisterFirstName"),require:!0,customErr:"Не указано имя"},{fieldNode:registerMailPhoneField,validBy:"isEmail",require:!0,customErr:"Некорректно введен e-mail"}]},registerValidator=new FormValidator(registerValidationConfig),forgotPwdValidationConfig={fields:[{fieldNode:forgotPwdLogin,require:!0,customErr:"Не указан email или мобильный телефон",validateOnChange:!0}]},forgotValidator=new FormValidator(forgotPwdValidationConfig);constructors.Login=function(){"use strict";function Login(){return this instanceof Login?(this.form=null,body.on("click",".registerAnotherWayBtn",$.proxy(this.registerAnotherWay,this)),body.on("click",".bAuthLink",this.openAuth),$(".jsLoginForm, .jsRegisterForm, .jsResetPwdForm").data("redirect",!0).on("submit",$.proxy(this.formSubmit,this)),body.on("click",".jsForgotPwdTrigger, .jsRememberPwdTrigger",this.forgotFormToggle),body.on("click","#bUserlogoutLink",this.logoutLinkClickLog),showLoginFormLink.length&&(loginForm.hide(),body.on("click",".jsShowLoginForm",this.showLoginForm)),void 0):new Login}return Login.prototype.showError=function(e,t){var r=$("ul.error_list",this.form);return void 0!==t&&t(),r.length?r.html("<li>"+e+"</li>"):$(".bFormLogin__ePlaceTitle",this.form).after($('<ul class="error_list" />').append("<li>"+e+"</li>")),!1},Login.prototype.formErrorHandler=function(e){var t=this.getFormValidator(),r=$('[name="'+this.getFormName()+"["+e.field+']"]'),i=function i(){t._unmarkFieldError($(this))};return console.warn("Ошибка в поле"),t._markFieldError(r,e.message),r.bind("focus",i),!1},Login.serverErrorHandler={"default":function(e){return console.log("Обработчик ошибки"),e.error&&e.error.message?(this.showError(e.error.message,function(){document.location.href=e.redirect}),!1):(document.location.href=e.redirect,void 0)},0:function(e){var t=null;if(console.warn("Обработка ошибок формы"),e.redirect)return this.showError(e.error.message,function(){document.location.href=e.redirect}),void 0;$("ul.error_list",this.form).length&&$("ul.error_list",this.form).html("");for(var r=e.form.error.length-1;r>=0;r--)t=e.form.error[r],console.warn(t),"global"!==t.field&&null!==t.message?$.proxy(this.formErrorHandler,this)(t):"global"===t.field&&null!==t.message&&this.showError(t.message);return!1}},Login.prototype.checkEmail=function(){return registerMailPhoneField.hasClass("jsRegisterPhone")?!1:!0},Login.prototype.registerAnotherWay=function(){var e=$(".registerAnotherWay"),t=$(".registerAnotherWayBtn");return registerMailPhoneField.val(""),this.checkEmail()?(e.html("Ваш мобильный телефон:"),t.html("Ввести e-mail"),registerMailPhoneField.addClass("jsRegisterPhone"),registerValidator.setValidate(registerMailPhoneField,{validBy:"isPhone",customErr:"Некорректно введен телефон"}),$.mask.definitions.n="[0-9]",registerMailPhoneField.mask("+7 (nnn) nnn-nn-nn")):(e.html("Ваш e-mail:"),t.html("У меня нет e-mail"),registerMailPhoneField.removeClass("jsRegisterPhone"),registerValidator.setValidate(registerMailPhoneField,{validBy:"isEmail",customErr:"Некорректно введен e-mail"}),registerMailPhoneField.unmask()),!1},Login.prototype.openAuth=function(){return authBlock.lightbox_me({centered:!0,autofocus:!0,onLoad:function(){authBlock.find("input:first").focus()}}),!1},Login.prototype.submitBtnLoadingDisplay=function(e){if(e.length){var t=e.val(),r=e.data("loading-value");e.attr("disabled","disabled"===e.attr("disabled")?!1:!0).val(r).data("loading-value",t)}return!1},Login.prototype.getFormValidator=function(){return eval(this.getFormName()+"Validator")},Login.prototype.getFormName=function(){return this.form.hasClass("jsLoginForm")?"signin":this.form.hasClass("jsRegisterForm")?"register":this.form.hasClass("jsResetPwdForm")?"forgot":""},Login.prototype.formSubmit=function(e){e.preventDefault(),this.form=$(e.target);var t=this.form.serializeArray(),r=this.getFormValidator(),i=$(".jsSubmit",this.form),n=this.getUrlParams(),a=function(e){return e.error?(console.warn("Form has error"),Login.serverErrorHandler.hasOwnProperty(e.error.code)?(console.log("Есть обработчик"),$.proxy(Login.serverErrorHandler[e.error.code],this)(e)):(console.log("Стандартный обработчик"),Login.serverErrorHandler["default"](e)),this.submitBtnLoadingDisplay(i),!1):($.proxy(this.formSubmitLog,this),forgotPwdLogin.length&&forgotPwdLogin.is(":visible")&&(this.submitBtnLoadingDisplay(i),forgotPwdLogin.hide(),$(".jsForgotPwdLoginLabel",this.form).hide(),i.hide(),this.showError(e.notice.message)),console.log(this.form.data("redirect")),console.log(e.data.link),this.form.data("redirect")?e.data.link!==void 0?(console.info("try to redirect to2 "+e.data.link),console.log(typeof e.data.link),document.location.href=e.data.link,console.log("try reload...."),document.location.reload()):(completeRegister.html(e.message),completeRegister.show(),registerForm.hide(),this.showLoginForm()):authBlock.trigger("close"),$("#order-form").length&&($("#user-block").html('Привет, <strong><a href="'+e.data.link+'">'+e.data.user.first_name+"</a></strong>"),$("#order_recipient_first_name").val(e.data.user.first_name),$("#order_recipient_last_name").val(e.data.user.last_name),$("#order_recipient_phonenumbers").val(e.data.user.mobile_phone.slice(1)),$("#qiwi_phone").val(e.data.user.mobile_phone.slice(1))),void 0)},o=function(){this.submitBtnLoadingDisplay(i),t.push({name:"redirect_to",value:n.redirect_to?n.redirect_to:window.location.href}),$.post(this.form.attr("action"),t,$.proxy(a,this),"json")};return r.validate({onInvalid:function(e){console.warn("invalid"),console.log(e)},onValid:$.proxy(o,this)}),!1},Login.prototype.showLoginForm=function(){showLoginFormLink.hide(),loginForm.slideDown(300),$.scrollTo(loginForm,500)},Login.prototype.forgotFormToggle=function(){return resetPwdForm.is(":visible")?(resetPwdForm.hide(),loginForm.show()):(resetPwdForm.show(),loginForm.hide()),!1},Login.prototype.formSubmitLog=function(){var e="";"signin"===this.getFormName()?("undefined"!=typeof _gaq&&(e=-1!==this.form.find(".jsSigninUsername").val().search("@")?"email":"mobile",_gaq.push(["_trackEvent","Account","Log in",e,window.location.href])),"undefined"!=typeof _kmq&&_kmq.push(["identify",this.form.find(".jsSigninUsername").val()])):"register"===this.getFormName()?("undefined"!=typeof _gaq&&(e=this.checkEmail()?"email":"mobile",_gaq.push(["_trackEvent","Account","Create account",e])),"undefined"!=typeof _kmq&&_kmq.push(["identify",this.form.find(".jsRegisterUsername").val()])):"forgot"===this.getFormName()&&"undefined"!=typeof _gaq&&(e=-1!==this.form.find(".jsForgotPwdLogin").val().search("@")?"email":"mobile",_gaq.push(["_trackEvent","Account","Forgot password",e]))},Login.prototype.logoutLinkClickLog=function(){"undefined"!=typeof _kmq&&_kmq.push(["clearIdentity"])},Login.prototype.getUrlParams=function(){var e,t,r={},i=window.location.search.substring(1).split("&");for(t=0;i.length>t;t++)e=i[t].split("="),r[e[0]]=e[1]===void 0?"":e[1];return r},Login}(),$(document).ready(function(){new ENTER.constructors.Login})}(window.ENTER),$(document).ready(function(){function e(e){return"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","CategoryClick",e.data,window.location.pathname]),!0}$("body").on("click",".bSubscibe",function(){return $(this).hasClass("checked")?($(this).removeClass("checked"),$(this).find(".subscibe").removeAttr("checked"),$(this).find('input[name="subscribe"]').val(0)):($(this).addClass("checked"),$(this).find(".subscibe").attr("checked","checked"),$(this).find('input[name="subscribe"]').val(1)),!1}),$(".bMainMenuLevel-1__eLink").bind("click","Верхнее меню",e),$(".bMainMenuLevel-2__eLink").bind("click","Верхнее меню",e),$(".bMainMenuLevel-3__eLink").bind("click","Верхнее меню",e),$(".breadcrumbs").first().find("a").bind("click","Хлебные крошки сверху",e),$(".breadcrumbs-footer").find("a").bind("click","Хлебные крошки снизу",e),$(".bCtg__eMore").bind("click",function(e){e.preventDefault();var t=$(this);t.parent().find("li.hf").slideToggle();var r=t.find("a");r.text("еще..."==r.text()?"скрыть":"еще...")}),$(".product_buy-container").each(function(){var e=$(this).data("order");"object"!=typeof e||$.isEmptyObject(e)||$.ajax({url:$(this).data("url"),data:e,type:"POST",timeout:2e4})}),$(".searchtextClear").length&&($(".searchtextClear").each(function(){$(this).val().length?$(this).removeClass("vh"):$(this).addClass("vh")}),$(".searchtextClear").click(function(){$(this).siblings(".searchtext").val(""),$(this).addClass("vh"),$("#searchAutocomplete").length&&$("#searchAutocomplete").html("")})),function(){$(".bGoodsList .bGoodsList__eItem").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}),$(".bigcarousel-brand .goodsbox").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")})}()}),function(){var e=function e(e,t){var r=$(".bSubscribeLightboxPopupNotNow"),i=$(".bSubscribeLightboxPopup"),n=$(".bSubscribeLightboxPopup__eInput"),a=$(".bSubscribeLightboxPopup__eBtn"),o=function o(){var e=n.val(),t=$(this).data("url");return a.hasClass("mDisabled")?!1:($.post(t,{email:e},function(e){return e.success?(i.html('<span class="bSubscribeLightboxPopup__eTitle mType">Спасибо! подтверждение подписки отправлено на указанный e-mail</span>'),window.docCookies.setItem("subscribed",1,15768e4,"/"),setTimeout(function(){i.slideUp(300)},3e3),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Account","Emailing sign up","Page top"]),void 0):!1}),!1)},s=function s(){i.slideDown(300),a.bind("click",o),$(".bSubscribeLightboxPopup__eNotNow").bind("click",function(){var e=$(this).data("url");return i.slideUp(300,l),window.docCookies.setItem("subscribed",0,15768e4,"/"),$.post(e),!1})},l=function l(){r.slideDown(300),r.bind("click",function(){$(this).slideUp(300),s()})};return n.placeholder(),n.emailValidate({onValid:function(){n.removeClass("mError"),a.removeClass("mDisabled")},onInvalid:function(){a.addClass("mDisabled"),n.addClass("mError")}}),t.show?(s(),void 0):(t.agreed||l(),!1)};$("body").bind("showsubscribe",e)}(),function(){var e=$("div.searchbox form"),t=e.find("input.searchtext"),r=$("#searchAutocomplete"),i=$(".bSearchSuggest__eRes"),n=-1,a=0,o={},s=null,l=function l(){var e=i.eq(n).attr("href"),t=i.eq(n).hasClass("bSearchSuggest__eCategoryRes")?"suggest_category":"suggest_product";"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Search",t,e])},c=function c(e){var n=e.which,l=t.attr("value"),c=function c(e){o[l]=e,r.html(e),i=$(".bSearchSuggest__eRes"),a=i.length},u=function u(){var e="/search/autocomplete?q="+encodeURI(l);$.ajax({type:"GET",url:e,success:c})};return n>=37&&40>=n||27===n||13===n?!1:0===l.length?(r.empty(),!1):(clearTimeout(s),o[l]?(c(o[l]),!1):(s=setTimeout(u,300),void 0))},u=function u(e){var t=e.which,o=function o(){i.removeClass("hover").eq(n).addClass("hover")},s=function s(){n-1>=0?(n--,o()):(n=-1,i.removeClass("hover"),$(this).focus())},c=function c(){a-1>=n+1&&(n++,o())},u=function u(){var e=i.eq(n).attr("href");l(),document.location.href=e};return 38===t?(s(),!1):40===t?(c(),!1):27===t?(r.empty(),!1):13===t&&-1!==n?(u(),!1):void 0},h=function h(){var e=t.attr("value");return 0===e.length?!1:void 0},f=function f(){r.show()},d=function d(e){var t=e.target.className;t.indexOf("bSearchSuggest")+1||t.indexOf("searchtext")+1||r.hide()},p=function p(){var e=0;i.removeClass("hover"),e=$(this).addClass("hover").index(),n=e-1};$(document).ready(function(){t.bind("keydown",u),t.bind("keyup",c),t.bind("focus",f),e.bind("submit",h),t.placeholder(),$("body").bind("click",d),$("body").on("mouseenter",".bSearchSuggest__eRes",p),$("body").on("click",".bSearchSuggest__eRes",l)})}(),function(){var e=300,t=600,r=15,i=null,n=null,a=!1,o=null,s=null,l=null,c=null,u=null,h={x:0,y:0},f={x:0,y:0},d={x:0,y:0},p={x:0,y:0},m=function(e){i=new Date,n=e,$(".bMainMenuLevel-2__eItem").removeClass("hover"),e.addClass("hover")},v=function(){var t=$(this);i=new Date,a=!0,setTimeout(function(){a&&new Date-i>e&&m(t)},e+20)},_=function(){var e=$(this);e.removeClass("hover"),a=!1},g=function(){h={x:p.x,y:p.y-$(window).scrollTop()},f={x:u.left-r,y:u.top-$(window).scrollTop()},d={x:u.left-r,y:u.top+u.height-$(window).scrollTop()}},E=function(){var e=(h.x-p.x)*(f.y-h.y)-(f.x-h.x)*(h.y-p.y),t=(f.x-p.x)*(d.y-f.y)-(d.x-f.x)*(f.y-p.y),i=(d.x-p.x)*(h.y-d.y)-(h.x-d.x)*(d.y-p.y);return e>=0&&t>=0&&i>=0||0>=e&&0>=t&&0>=i||p.x>=f.x&&p.x<=f.x+r&&p.y>=f.y&&p.y<=d.y?!0:!1},y=function(e){p={x:e.pageX,y:e.pageY-$(window).scrollTop()};var t=$(this);s&&t.attr("class")===s.attr("class")&&(w(t),o=new Date),x(t)},T=function(e){s=e,e.addClass("hover"),o=new Date,w(e)},b=function(){var e=$(this);x(e),e.addClass("hoverNowLvl2"),o&&t>=new Date-o&&E()&&setTimeout(function(){e.hasClass("hoverNowLvl2")&&new Date-o>t&&x(e)},t+20)},R=function(){var e=$(this);e.removeClass("hoverNowLvl2")},x=function(e){o?(!E()||o&&new Date-o>t&&E())&&(s.removeClass("hover"),T(e)):T(e)},w=function(e){l=H(e),c=H(e.find(".bMainMenuLevel-3"));var t=e.find(".bMainMenuLevel-2__eTitle")[0].offsetWidth;u={top:c.top,left:c.left+t,width:c.width-t,height:c.height},g()},H=function(e){var t=$(e).width(),r=$(e).height();e=e[0];for(var i=0,n=0;e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop);)i+=e.offsetLeft-e.scrollLeft,n+=e.offsetTop-e.scrollTop,e=e.offsetParent;return{top:n,left:i,width:t,height:r}};$(".bMainMenuLevel-1__eItem").mouseenter(v),$(".bMainMenuLevel-1__eItem").mouseleave(_),$(".bMainMenuLevel-2__eItem").mouseenter(b),$(".bMainMenuLevel-2__eItem").mousemove(y),$(".bMainMenuLevel-2__eItem").mouseleave(R)}(),function(){var e=$("#upper"),t=!1,r=function r(){$(window).scrollTop()>600&&!t?(t=!0,e.animate({marginTop:"0"},400)):600>$(window).scrollTop()&&t&&(t=!1,e.animate({marginTop:"-55px"},400))},i=function i(){return $(window).scrollTo("0px",400),!1};$(window).scroll(r),e.bind("click",i)}(),function(e){var t,r,i=e.config,n=(i.pageConfig.userUrl,e.utils,$(".fixedTopBar.mFixed")),a=$(".fixedTopBar.mStatic"),o=n.find(".fixedTopBar__upLink"),s=n.data("value"),l=$("body"),c=$(window),u=!1,h=function h(){n.slideDown()},f=function f(){n.slideUp()},d=function d(){var e=c.scrollTop();u||(e>=r?h():f())},p=function p(){return $.scrollTo(t,500),e.catalog.filter.openFilter(),!1},m=function m(e,t){console.info("userbar::updateUserInfo"),console.log(t);var r,i=n.find(".fixedTopBar__logIn"),o=a.find(".fixedTopBar__logIn"),s=$("#userbar_user_tmpl"),l=s.data("partial");return t&&t.name&&t.link?(r=Mustache.render(s.html(),t,l),o.removeClass("mLogin"),i.removeClass("mLogin"),o.html(r),i.html(r),void 0):(console.warn("123123"),void 0)},v=function v(e,t){console.info("userbar::showBuyInfo"),console.log(t);var r,i,a=n.find(".fixedTopBar__cart"),o=$("<div>").css({position:"fixed",display:"none",width:"100%",height:"100%",top:0,left:0,zIndex:900,background:"black",opacity:.4}),s=t.product,c=$("#buyinfo_tmpl"),f=c.data("partial"),p=function p(){return r.slideUp(300,function(){u=!1,d(),r.remove()}),o.fadeOut(300,function(){o.off("click"),o.remove()}),!1};s.price=printPrice(s.price),i=Mustache.render(c.html(),t.product,f),r=$(i).css({left:-129}),a.append(r),l.append(o),r.slideDown(300),o.fadeIn(300),h(),u=!0,o.on("click",p)},_=function _(e,t){console.info("userbar::updateBasketInfo"),console.log(t);var r,i=n.find(".fixedTopBar__cart"),o=a.find(".fixedTopBar__cart"),s=$("#userbar_cart_tmpl"),l=s.data("partial");return console.log("vars inited"),t&&t.quantity&&t.sum?(t.sum=printPrice(t.sum),r=Mustache.render(s.html(),t,l),o.removeClass("mEmpty"),i.removeClass("mEmpty"),o.html(r),i.html(r),void 0):(console.warn("123"),void 0)};console.info("Init userbar module"),console.log(s),l.on("userLogged",m),l.on("basketUpdate",_),l.on("addtocart",v),n.length&&(t=$(s.target),o.length&&o.on("click",p),t.length&&(r=t.offset().top+n.height(),c.on("scroll",d)))}(window.ENTER);