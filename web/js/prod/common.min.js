(function(e,t,o,r){o.ajaxSetup({timeout:1e4,statusCode:{404:function(){var e=this.url,t={event:"ajax_error",type:"404 ошибка",ajaxUrl:e};r.utils.logError(t),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","404 ошибка, страница не найдена"])},401:function(){o("#auth-block").length?o("#auth-block").lightbox_me({centered:!0,onLoad:function(){o("#auth-block").find("input:first").focus()}}):"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","401 ошибка, авторизуйтесь заново"])},500:function(){var e=this.url,t={event:"ajax_error",type:"500 ошибка",ajaxUrl:e};r.utils.logError(t),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","500 сервер перегружен"])},503:function(){var e=this.url,t={event:"ajax_error",type:"503 ошибка",ajaxUrl:e};r.utils.logError(t),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","503 ошибка, сервер перегружен"])},504:function(){var e=this.url,t={event:"ajax_error",type:"504 ошибка",ajaxUrl:e};r.utils.logError(t),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","504 ошибка, проверьте соединение с интернетом"])}},error:function(e,t){var o=this.url,i={event:"ajax_error",type:"неизвестная ajax ошибка",ajaxUrl:o};if("error"===e.statusText)r.utils.logError(i),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Errors","Ajax Errors","неизвестная ajax ошибка"]);else if("timeout"===t)return}})})(this,this.document,this.jQuery,this.ENTER),function(){var e=!1,t=!1,o=function(){e?($("#mobilePhoneWrapper").hide(),$("#mobilePhoneWrapper").parent().find(".red").html(""),e=!1):($("#mobilePhoneWrapper").show(),e=!0)},r=function(){t?($("#emailWrapper").hide(),$("#emailWrapper").parent().find(".red").html(""),t=!1):($("#emailWrapper").show(),t=!0)};$(document).ready(function(){e=$(".smsCheckbox").hasClass("checked"),$("#user_mobile_phone").val()||$(".smsCheckbox").bind("click",o),t=$(".emailCheckbox").hasClass("checked"),$("#user_email").val()||$(".emailCheckbox").bind("click",r)})}(),function(e){var t=$("body"),o=e.config.clientCart,r=function r(){var e=$(this),o=e.attr("href"),r=function r(o){var r=e.data("group"),i=e.data("upsale")?e.data("upsale"):null,a=e.parents(".jsSliderItem").data("product");return o.success?(e.removeClass("mLoading"),o.product&&(o.product.isUpsale=a&&a.isUpsale?!0:!1,o.product.fromUpsale=i&&i.fromUpsale?!0:!1),$('.jsBuyButton[data-group="'+r+'"]').html("В корзине").addClass("mBought").attr("href","/cart"),t.trigger("addtocart",[o]),t.trigger("getupsale",[o,i]),t.trigger("updatespinner",[r]),void 0):!1};return $.get(o,r),!1},i=function i(){var e=$(this),t=e.attr("href");return e.hasClass("mDisabled")?!1:e.hasClass("mBought")?(document.location.href(t),!1):(e.addClass("mLoading"),e.trigger("buy"),!1)},a=function a(){var e,t,r=o.products;for(console.info("markCartButton"),e=0,t=r.length;t>e;e++)$("."+r[e].cartButton.id).html("В корзине").addClass("mBought").attr("href","/cart")};$(document).ready(function(){t.bind("markcartbutton",a),t.on("click",".jsBuyButton",i),t.on("buy",".jsBuyButton",r)})}(window.ENTER),function(e){var t=e.utils,o=t.blackBox,r=$("body"),i=function i(e,t){t.redirect?(console.warn("redirect"),document.location.href=t.redirect):o&&o.basket().add(t)},a=function a(e,o){var r=function r(e,t){var o=t.product,r=t.service,i=t.warranty,a=window.location.href,n={};"undefined"!=typeof _kmq&&(o&&(n={"Add to Cart SKU":o.article,"Add to Cart SKU Quantity":o.quantity,"Add to Cart Product Name":o.name,"Add to Cart Root category":o.category[0].name,"Add to Cart Root ID":o.category[0].id,"Add to Cart Category name":o.category?o.category[o.category.length-1].name:0,"Add to Cart Category ID":o.category?o.category[o.category.length-1].id:0,"Add to Cart SKU Price":o.price,"Add to Cart Page URL":a,"Add to Cart F1 Quantity":o.serviceQuantity},_kmq.push(["record","Add to Cart",n]),o.isUpsale&&_kmq.push(["record","cart rec added from rec",{"SKU cart added from rec":o.article}]),o.fromUpsale&&_kmq.push(["record","cart recommendation added",{"SKU cart rec added":o.article}])),r&&(n={"Add F1 F1 Name":r.name,"Add F1 F1 Price":r.price,"Add F1 SKU":o.article,"Add F1 Product Name":o.name,"Add F1 Root category":o.category[0].name,"Add F1 Root ID":o.category[0].id,"Add F1 Category name":o.category?o.category[o.category.length-1].name:0,"Add F1 Category ID":o.category?o.category[o.category.length-1].id:0},_kmq.push(["record","Add F1",n])),i&&(n={"Add Warranty Warranty Name":i.name,"Add Warranty Warranty Price":i.price,"Add Warranty SKU":o.article,"Add Warranty Product Name":o.name,"Add Warranty Root category":o.category[0].name,"Add Warranty Root ID":o.category[0].id,"Add Warranty Category name":o.category?o.category[o.category.length-1].name:0,"Add Warranty Category ID":o.category?o.category[o.category.length-1].id:0},_kmq.push(["record","Add Warranty",n])))},i=function i(e,t){var o=t.product;o&&"undefined"!=typeof _gaq&&(_gaq.push(["_trackEvent","Add2Basket","product",o.article]),o.isUpsale&&_gaq.push(["_trackEvent","cart_recommendation","cart_rec_added_from_rec",o.article]),o.fromUpsale&&_gaq.push(["_trackEvent","cart_recommendation","cart_rec_added_to_cart",o.article]))},a=function a(e,t){var o=t.product;o&&"undefined"!=typeof MyThings&&MyThings.Track({EventType:MyThings.Event.Visit,Action:"1013",ProductId:o.id})},n=function n(e,t){var o=t.product,r=o.id,i=o.category?o.category[o.category.length-1].id:0,a="http://ad.adriver.ru/cgi-bin/rle.cgi?sid=182615&sz=add_basket&custom=10="+r+";11="+i+"&bt=55&pz=0&rnd=![rnd]",n=document,s=n.createElement("IMG"),d=n.body;a=a.replace(/!\[rnd\]/,Math.round(9999999*Math.random()))+"&tail256="+escape(n.referrer||"unknown"),s.style.position="absolute",s.style.width=s.style.height="0px",s.onload=s.onerror=function(){d.removeChild(s),s=d=null},s.src=a,d.insertBefore(s,d.firstChild)},s=function s(e,o){var r,i=o.product;if("object"==typeof rcApi)try{rcApi.addToBasket(i.id)}catch(a){r={event:"rcApi.addToBasket",type:"ошибка отправки данных в RetailRocket",err:a},t.logError(r)}},d=function d(e,t){var o=t.product,r=o.id,i=o.price,a=o.category?o.category[o.category.length-1].id:0,n=document,s=n.body,d=n.createElement("IMG");d.src="//e.visualdna.com/conversion?api_key=enter.ru&id=added_to_basket&product_id="+r+"&product_category="+a+"&value="+i+"&currency=RUB",d.width=d.height="1",d.alt="",s.appendChild(d)};try{r(e,o),i(e,o),a(e,o),n(e,o),s(e,o),d(e,o)}catch(l){console.warn("addtocartAnalytics error"),console.log(l)}};r.on("addtocart",i),r.on("addtocart",a)}(window.ENTER),function(e){var t=$("body"),o=$(".popupRegion"),r=$("#jscity"),i=$("#jschangecity"),a=o.find(".inputClear"),n=$(".jsChangeRegion"),s=$(".jsChangeRegionAnalytics"),d=o.find(".regionSlidesWrap"),l=o.find(".moreCity"),c=o.find(".leftArr"),u=o.find(".rightArr"),h=o.find(".regionSlides"),g=o.find(".regionSlides_slide");r.autocomplete({autoFocus:!0,appendTo:"#jscities",source:function(e,t){$.ajax({url:r.data("url-autocomplete"),dataType:"json",data:{q:e.term},success:function(e){var o=e.data.slice(0,15);t($.map(o,function(e){return{label:e.name,value:e.name,url:e.url}}))}})},minLength:2,select:function(e,t){i.data("url",t.item.url),i.removeClass("mDisabled")},open:function(){$(this).removeClass("ui-corner-all").addClass("ui-corner-top")},close:function(){$(this).removeClass("ui-corner-top").addClass("ui-corner-all")}});var m=function m(){o.lightbox_me({autofocus:!0,onLoad:function(){r.val().length&&(r.putCursorAtEnd(),i.removeClass("mDisabled"))},onClose:function(){var t=n.data("region-id");e.docCookies.hasItem("geoshop")||e.docCookies.setItem("geoshop",t,31536e3,"/")}}),"/"===document.location.pathname&&(console.info("run analytics for main page"),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","citySelector","viewed"]))},f=function f(){var e=$(this),t=e.data("autoresolve-url"),o=function o(e){if(!e.data.length)return $(".popupRegion .mAutoresolve").html(""),!1;var t=e.data[0].url,o=e.data[0].name,r=e.data[0].id;return 14974===r||108136===r?!1:($(".popupRegion .mAutoresolve").length?$(".popupRegion .mAutoresolve").html('<a href="'+t+'">'+o+"</a>"):$(".popupRegion .cityInline").prepend('<div class="cityItem mAutoresolve"><a href="'+t+'">'+o+"</a></div>"),void 0)};return"undefined"!==t&&$.ajax({type:"GET",url:t,success:o}),m(),!1},p=function p(){var e=1*g.width(),t=1*h.width(),o=parseInt(h.css("left"),10);return c.show(),h.animate({left:o-e}),-t>=o-2*e&&u.hide(),!1},v=function v(){var e=1*g.width(),t=(1*h.width(),parseInt(h.css("left"),10));return u.show(),h.animate({left:t+e}),t+2*e>=0&&c.hide(),!1},y=function y(){return $(this).toggleClass("mExpand"),d.slideToggle(300),!1},b=function b(){return r.val(""),a.hide(),!1},_=function _(){$(this).val()?a.show():a.hide()},k=function k(e){"/"===document.location.pathname&&(console.info("run analytics for main page "+e),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","citySelector","selected",e]))},C=function C(){var e=$(this).text();k(e)},w=function w(){var t=$(this).data("url"),i=r.val();return k(i),t?e.location=t:o.trigger("close"),!1};i.on("click",w),l.on("click",y),a.on("click",b),u.on("click",p),c.on("click",v),r.on("keyup",_),t.on("click",".jsChangeRegion",f),s.on("click",C),e.docCookies.hasItem("geoshop")||m()}(this),function(){var e=$("input.bCustomInput"),t=$("body"),o=function o(){if($(this).is("[type=checkbox]")||$(this).is("[type=radio]")){var e=$(this),t=e.attr("id"),o=e.is("[type=checkbox]")?"checkbox":"radio",r=e.attr("name")||"",i=$('label[for="'+t+'"]');"checkbox"===o&&(e.is(":checked")?i.addClass("mChecked"):i.removeClass("mChecked")),"radio"===o&&e.is(":checked")&&($('input[name="'+r+'"]').each(function(){var e=$(this),t=e.attr("id");$('label[for="'+t+'"]').removeClass("mChecked")}),i.addClass("mChecked"))}};t.on("updateState",".bCustomInput",o),t.on("change",".bCustomInput",function(){$(this).trigger("updateState")}),e.trigger("updateState")}(),$(document).ready(function(){if($("#similarGoodsSlider").length){var e=$("#similarGoodsSlider"),t=e.find(".bSimilarGoodsSlider_eWrap"),o=e.find(".bSimilarGoodsSlider_eArrow"),r=0,i=0,a=0,n=0,s=0,d=function d(){var e=$(this),t={"Recommended Item Clicked Similar Recommendation Place":"product","Recommended Item Clicked Similar Clicked SKU":e.data("article"),"Recommended Item Clicked Similar Clicked Product Name":e.data("name"),"Recommended Item Clicked Similar Product Position":e.data("pos")};"undefined"!=typeof _kmq&&_kmq.push(["record","Recommended Item Clicked Similar",t])},l=function l(o){var s=e.find(".bSimilarGoodsSlider_eGoods");for(var d in o){var l=tmpl("similarGoodTmpl",o[d]);t.append(l)}r=s.width()+2*parseInt(s.css("paddingLeft"),10),a=s.length,n=r*a,t.width(n),a>0&&$(".bSimilarGoods").fadeIn(300,function(){i=e.width()}),4>a&&$(".bSimilarGoodsSlider_eArrow.mRight").hide()};$.getJSON($("#similarGoodsSlider").data("url"),function(e){if(!$.isEmptyObject(e)){var t=e;l(t)}}).done(function(){var o=e.find(".bSimilarGoodsSlider_eGoods");a=o.length,n=r*a,t.width(n),a>0&&$(".bSimilarGoods").fadeIn(300,function(){i=e.width()})}),o.bind("click",function(){return $(this).hasClass("mLeft")?s+=2*r:s-=2*r,i-n>=s?(s=i-n,$(".bSimilarGoodsSlider_eArrow.mRight").hide(),$(".bSimilarGoodsSlider_eArrow.mLeft").show()):s>=0?(s=0,$(".bSimilarGoodsSlider_eArrow.mLeft").hide(),$(".bSimilarGoodsSlider_eArrow.mRight").show()):o.show(),t.animate({left:s}),!1}),$(".bSimilarGoods.mProduct .bSimilarGoodsSlider_eGoods").on("click",d)}window.navigator.userAgent.indexOf("MSIE")>=0&&$(".allpageinner").on("hover",".goodsbox__inner",function(){$(this).toggleClass("hover")}),$("body").on("click",".goodsbox__inner",function(){$(this).attr("data-url")&&(window.location.href=$(this).attr("data-url"))});var c=function c(){var e=$("#_categoryData").data("category"),t={"Viewed Category Category Type":e.type,"Viewed Category Category Level":e.level,"Viewed Category Parent category":e.parent_category,"Viewed Category Category name":e.category,"Viewed Category Category ID":e.id};"undefined"!=typeof _kmq&&_kmq.push(["record","Viewed Category",t])},u=function u(){var e,t,o=$(this),r=!1,i=$("#_categoryData").data("category");e=o.parents("div.goodsbox__inner"),e.length||(e=o.parents("div.goodsboxlink")),t=e.length?e.data("add"):!1,t&&i&&(r={"Category Results Clicked Category Type":i.type,"Category Results Clicked Category Level":i.level,"Category Results Clicked Parent category":i.parent_category,"Category Results Clicked Category name":i.category,"Category Results Clicked Category ID":i.id,"Category Results Clicked SKU":t.article,"Category Results Clicked Product Name":t.name,"Category Results Clicked Page Number":t.page,"Category Results Clicked Product Position":t.position}),r&&"undefined"!=typeof _kmq&&_kmq.push(["record","Category Results Clicked",r])};$("#_categoryData").length&&(c(),$("body").delegate("div.goodsbox a","click",u));var h=function h(){var e=$("#_searchKiss").data("search"),t={"Search String":e.query,"Search Page URL":e.url,"Search Items Found":e.count};"undefined"!=typeof _kmq&&_kmq.push(["record","Search",t]);var o=function(){var t=$(this).data("add"),o={"Search Results Clicked Search String":e.query,"Search Results Clicked SKU":t.article,"Search Results Clicked Product Name":t.name,"Search Results Clicked Page Number":t.page,"Search Results Clicked Product Position":t.position};"undefined"!=typeof _kmq&&_kmq.push(["record","Search Results Clicked",o])};$(".goodsbox__inner").on("click",o),$(".goodsboxlink").on("click",o)};$("#_searchKiss").length&&h()}),function(){var e=function e(){var e=$(this).data("goto");return $(document).stop().scrollTo($("#"+e),800),!1};$(document).ready(function(){$(".jsGoToId").bind("click",e)})}(),function(){var e=function(){var e=$(this);return e.hasClass("expanded")?(e.parent().parent().find(".toHide").hide(),e.html("Все метки"),e.removeClass("expanded")):(e.parent().parent().find(".toHide").show(),e.html("Основные метки"),e.addClass("expanded")),!1};$(document).ready(function(){$(".hotlinksToggle").bind("click",e)})}(),function(){$.ajax({url:"https://jira.enter.ru/s/ru_RU-istibo/773/3/1.2.4/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=2e17c5d6",type:"get",cache:!0,dataType:"script"}),window.ATL_JQ_PAGE_PROPS={triggerFunction:function(e){$("#jira").click(function(t){t.preventDefault(),e()})}}}(),function(ENTER){var constructors=ENTER.constructors,registerMailPhoneField=$(".jsRegisterUsername"),body=$("body"),authBlock=$("#auth-block"),forgotPwdLogin=$(".jsForgotPwdLogin"),resetPwdForm=$(".jsResetPwdForm"),registerForm=$(".jsRegisterForm"),loginForm=$(".jsLoginForm"),completeRegister=$(".jsRegisterFormComplete"),showLoginFormLink=$(".jsShowLoginForm"),signinValidationConfig={fields:[{fieldNode:$(".jsSigninUsername"),require:!0,customErr:"Не указан логин"},{fieldNode:$(".jsSigninPassword"),require:!0,customErr:"Не указан пароль"}]},signinValidator=new FormValidator(signinValidationConfig),registerValidationConfig={fields:[{fieldNode:$(".jsRegisterFirstName"),require:!0,customErr:"Не указано имя"},{fieldNode:registerMailPhoneField,validBy:"isEmail",require:!0,customErr:"Некорректно введен e-mail"}]},registerValidator=new FormValidator(registerValidationConfig),forgotPwdValidationConfig={fields:[{fieldNode:forgotPwdLogin,require:!0,customErr:"Не указан email или мобильный телефон",validateOnChange:!0}]},forgotValidator=new FormValidator(forgotPwdValidationConfig);constructors.Login=function(){"use strict";function Login(){return this instanceof Login?(this.form=null,this.redirect_to=null,body.on("click",".registerAnotherWayBtn",$.proxy(this.registerAnotherWay,this)),body.on("click",".bAuthLink",this.openAuth),body.on("click",".jsEnterprizeAuthLink",$.proxy(this.enterprizeAuthLinkClick,this)),$(".jsLoginForm, .jsRegisterForm, .jsResetPwdForm").data("redirect",!0).on("submit",$.proxy(this.formSubmit,this)),body.on("click",".jsForgotPwdTrigger, .jsRememberPwdTrigger",this.forgotFormToggle),body.on("click","#bUserlogoutLink",this.logoutLinkClickLog),showLoginFormLink.length&&(loginForm.hide(),body.on("click",".jsShowLoginForm",this.showLoginForm)),void 0):new Login}return Login.prototype.showError=function(e,t){var o=$("ul.error_list",this.form);return void 0!==t&&t(),o.length?o.html("<li>"+e+"</li>"):$(".bFormLogin__ePlaceTitle",this.form).after($('<ul class="error_list" />').append("<li>"+e+"</li>")),!1},Login.prototype.formErrorHandler=function(e){var t=this.getFormValidator(),o=$('[name="'+this.getFormName()+"["+e.field+']"]'),r=function r(){t._unmarkFieldError($(this))};return console.warn("Ошибка в поле"),t._markFieldError(o,e.message),o.bind("focus",r),!1},Login.serverErrorHandler={"default":function(e){return console.log("Обработчик ошибки"),e.error&&e.error.message?(this.showError(e.error.message,function(){document.location.href=e.redirect}),!1):(document.location.href=e.redirect,void 0)},0:function(e){var t=null;if(console.warn("Обработка ошибок формы"),e.redirect)return this.showError(e.error.message,function(){document.location.href=e.redirect}),void 0;$("ul.error_list",this.form).length&&$("ul.error_list",this.form).html("");for(var o=e.form.error.length-1;o>=0;o--)t=e.form.error[o],console.warn(t),"global"!==t.field&&null!==t.message?$.proxy(this.formErrorHandler,this)(t):"global"===t.field&&null!==t.message&&this.showError(t.message);return!1}},Login.prototype.checkEmail=function(){return registerMailPhoneField.hasClass("jsRegisterPhone")?!1:!0},Login.prototype.registerAnotherWay=function(){var e=$(".registerAnotherWay"),t=$(".registerAnotherWayBtn");return registerMailPhoneField.val(""),this.checkEmail()?(e.html("Ваш мобильный телефон:"),t.html("Ввести e-mail"),registerMailPhoneField.addClass("jsRegisterPhone"),registerValidator.setValidate(registerMailPhoneField,{validBy:"isPhone",customErr:"Некорректно введен телефон"}),$.mask.definitions.n="[0-9]",registerMailPhoneField.mask("+7 (nnn) nnn-nn-nn")):(e.html("Ваш e-mail:"),t.html("У меня нет e-mail"),registerMailPhoneField.removeClass("jsRegisterPhone"),registerValidator.setValidate(registerMailPhoneField,{validBy:"isEmail",customErr:"Некорректно введен e-mail"}),registerMailPhoneField.unmask()),!1},Login.prototype.openAuth=function(){return authBlock.lightbox_me({centered:!0,autofocus:!0,onLoad:function(){authBlock.find("input:first").focus()}}),!1},Login.prototype.enterprizeAuthLinkClick=function(e){e.preventDefault();var t=$(e.target),o=t.hasClass("jsEnterprizeAuthLink")?t:t.parents(".jsEnterprizeAuthLink"),r=o.attr("href");return r&&(this.redirect_to=r),this.openAuth(),!1},Login.prototype.submitBtnLoadingDisplay=function(e){if(e.length){var t=e.val(),o=e.data("loading-value");e.attr("disabled","disabled"===e.attr("disabled")?!1:!0).val(o).data("loading-value",t)}return!1},Login.prototype.getFormValidator=function(){return eval(this.getFormName()+"Validator")},Login.prototype.getFormName=function(){return this.form.hasClass("jsLoginForm")?"signin":this.form.hasClass("jsRegisterForm")?"register":this.form.hasClass("jsResetPwdForm")?"forgot":""},Login.prototype.formSubmit=function(e){e.preventDefault(),this.form=$(e.target);var t=this.form.serializeArray(),o=this.getFormValidator(),r=$(".jsSubmit",this.form),i=this.getUrlParams();i.redirect_to&&(this.redirect_to=i.redirect_to);var a=function(e){if(e.error)return console.warn("Form has error"),Login.serverErrorHandler.hasOwnProperty(e.error.code)?(console.log("Есть обработчик"),$.proxy(Login.serverErrorHandler[e.error.code],this)(e)):(console.log("Стандартный обработчик"),Login.serverErrorHandler["default"](e)),this.submitBtnLoadingDisplay(r),!1;if($.proxy(this.formSubmitLog,this),forgotPwdLogin.length&&forgotPwdLogin.is(":visible")&&(this.submitBtnLoadingDisplay(r),forgotPwdLogin.hide(),$(".jsForgotPwdLoginLabel",this.form).hide(),r.hide(),this.showError(e.notice.message)),console.log(this.form.data("redirect")),console.log(e.data.link),this.form.data("redirect")){if(e.data.link!==void 0)return console.info("try to redirect to2 "+e.data.link),console.log(typeof e.data.link),document.location.href=e.data.link,!1;completeRegister.html(e.message),completeRegister.show(),registerForm.hide(),this.showLoginForm()}else authBlock.trigger("close");$("#order-form").length&&($("#user-block").html('Привет, <strong><a href="'+e.data.link+'">'+e.data.user.first_name+"</a></strong>"),$("#order_recipient_first_name").val(e.data.user.first_name),$("#order_recipient_last_name").val(e.data.user.last_name),$("#order_recipient_phonenumbers").val(e.data.user.mobile_phone.slice(1)),$("#qiwi_phone").val(e.data.user.mobile_phone.slice(1)))},n=function(){this.submitBtnLoadingDisplay(r),t.push({name:"redirect_to",value:this.redirect_to?this.redirect_to:window.location.href}),$.post(this.form.attr("action"),t,$.proxy(a,this),"json")};return o.validate({onInvalid:function(e){console.warn("invalid"),console.log(e)},onValid:$.proxy(n,this)}),!1},Login.prototype.showLoginForm=function(){showLoginFormLink.hide(),loginForm.slideDown(300),$.scrollTo(loginForm,500)},Login.prototype.forgotFormToggle=function(){return resetPwdForm.is(":visible")?(resetPwdForm.hide(),loginForm.show()):(resetPwdForm.show(),loginForm.hide()),!1},Login.prototype.formSubmitLog=function(){var e="";"signin"===this.getFormName()?("undefined"!=typeof _gaq&&(e=-1!==this.form.find(".jsSigninUsername").val().search("@")?"email":"mobile",_gaq.push(["_trackEvent","Account","Log in",e,window.location.href])),"undefined"!=typeof _kmq&&_kmq.push(["identify",this.form.find(".jsSigninUsername").val()])):"register"===this.getFormName()?("undefined"!=typeof _gaq&&(e=this.checkEmail()?"email":"mobile",_gaq.push(["_trackEvent","Account","Create account",e])),"undefined"!=typeof _kmq&&_kmq.push(["identify",this.form.find(".jsRegisterUsername").val()])):"forgot"===this.getFormName()&&"undefined"!=typeof _gaq&&(e=-1!==this.form.find(".jsForgotPwdLogin").val().search("@")?"email":"mobile",_gaq.push(["_trackEvent","Account","Forgot password",e]))},Login.prototype.logoutLinkClickLog=function(){"undefined"!=typeof _kmq&&_kmq.push(["clearIdentity"])},Login.prototype.getUrlParams=function(){var e,t,o={},r=window.location.search.substring(1).split("&");for(t=0;r.length>t;t++)e=r[t].split("="),o[e[0]]=e[1]===void 0?"":e[1];return o},Login}(),$(document).ready(function(){new ENTER.constructors.Login})}(window.ENTER),$(document).ready(function(){function e(e){return"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","CategoryClick",e.data,window.location.pathname]),!0}$("body").on("click",".bSubscibe",function(){return $(this).hasClass("checked")?($(this).removeClass("checked"),$(this).find(".subscibe").removeAttr("checked"),$(this).find('input[name="subscribe"]').val(0)):($(this).addClass("checked"),$(this).find(".subscibe").attr("checked","checked"),$(this).find('input[name="subscribe"]').val(1)),!1}),$(".bMainMenuLevel-1__eLink").bind("click","Верхнее меню",e),$(".bMainMenuLevel-2__eLink").bind("click","Верхнее меню",e),$(".bMainMenuLevel-3__eLink").bind("click","Верхнее меню",e),$(".breadcrumbs").first().find("a").bind("click","Хлебные крошки сверху",e),$(".breadcrumbs-footer").find("a").bind("click","Хлебные крошки снизу",e),$(".bCtg__eMore").bind("click",function(e){e.preventDefault();var t=$(this);t.parent().find("li.hf").slideToggle();var o=t.find("a");o.text("еще..."==o.text()?"скрыть":"еще...")}),$(".product_buy-container").each(function(){var e=$(this).data("order");"object"!=typeof e||$.isEmptyObject(e)||$.ajax({url:$(this).data("url"),data:e,type:"POST",timeout:2e4})}),$(".searchtextClear").length&&($(".searchtextClear").each(function(){$(this).val().length?$(this).removeClass("vh"):$(this).addClass("vh")}),$(".searchtextClear").click(function(){$(this).siblings(".searchtext").val(""),$(this).addClass("vh"),$("#searchAutocomplete").length&&$("#searchAutocomplete").html("")})),function(){$(".bGoodsList .bGoodsList__eItem").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}),$(".bigcarousel-brand .goodsbox").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")})}()}),function(e){var t=function(t,o,r,i){var a=this;a.inputVars={domID:t,totalPages:o,visPages:r?r:10,activePage:i?i:1};var n=e("#"+a.inputVars.domID),s=n.width(),d=s*a.inputVars.visPages/a.inputVars.totalPages,l=d/a.inputVars.visPages,c=s/a.inputVars.visPages,u=Math.round(a.inputVars.visPages/2),h=function h(t){var o=Math.round(t/l);e(".bPaginator_eWrap",n).css("left",-(c*o))},g=function g(){var t=!1,o=0,r=0;e(".bPaginatorSlider",n).bind("mousedown",function(i){o=i.pageX,r=parseInt(e(".bPaginatorSlider_eFill",n).css("left"),10),t=!0}),e(".bPaginatorSlider",n).bind("mouseup",function(){t=!1}),n.bind("mouseout",function(){t=!1}),e(".bPaginatorSlider",n).bind("mousemove",function(i){if(t){var a=r+(i.pageX-o);a>=0&&s-d>=a&&(e(".bPaginatorSlider_eFill",n).css("left",r+(i.pageX-o)),h(a))}})},m=function m(){n.append('<div class="bPaginator_eWrap"></div>'),n.append('<div class="bPaginatorSlider"><div class="bPaginatorSlider_eWrap"><div class="bPaginatorSlider_eFill" style="width:'+d+'px"></div></div></div>');for(var t=0;a.inputVars.totalPages>t;t++)e(".bPaginator_eWrap",n).append('<a class="bPaginator_eLink" href="#'+t+'">'+(t+1)+"</a>"),t+1===a.inputVars.activePage&&e(".bPaginator_eLink",n).eq(t).addClass("active");var o=e(".bPaginator_eLink",n).width();e(".bPaginator_eLink",n).css({marginLeft:(c-o-2)/2,marginRight:(c-o-2)/2}),e(".bPaginator_eWrap",n).addClass("clearfix").width(c*a.inputVars.totalPages)};a.setActive=function(t){var o=parseInt(e(".bPaginator_eWrap",n).css("left"),10),r=parseInt(e(".bPaginatorSlider_eFill",n).css("left"),10),i=-1*Math.round(o/c),s=-(u-(t-i));e(".bPaginator_eLink",n).removeClass("active"),e(".bPaginator_eLink",n).eq(t).addClass("active"),o-s*c>0?(o=0,r=0):t>a.inputVars.totalPages-u?(o=-1*Math.round(a.inputVars.totalPages-a.inputVars.visPages)*c,r=Math.round(a.inputVars.totalPages-a.inputVars.visPages)*l):(o-=s*c,r+=s*l),e(".bPaginator_eWrap").animate({left:o}),e(".bPaginatorSlider_eFill",n).animate({left:r})},m(),g()};if(e("#promoCatalog").length){console.log("promoCatalog promoSlider");var o=e("#promoCatalog").data("slides"),r=o.length,i=new t("promoCatalogPaginator",r,12,1),a=function a(){for(var t in o){var r=tmpl("slide_tmpl",o[t]);e(".bPromoCatalogSliderWrap").append(r),""===e(".bPromoCatalogSliderWrap_eSlideLink").eq(t).attr("href")&&e(".bPromoCatalogSliderWrap_eSlideLink").eq(t).removeAttr("href"),e(".bPromoCatalogNav").append('<a id="promoCatalogSlide'+t+'" href="#'+t+'" class="bPromoCatalogNav_eLink">'+(1*t+1)+"</a>")}};a();var n=e(".bPromoCatalogSliderWrap_eSlide").width(),s=(e(".bPromoCatalogSliderWrap").width(n*r+(470-n/2)),0);e(".bPromoCatalogSlider_eArrow").bind("click",function(){var t=e(this).hasClass("mArLeft")?"-1":"1";return d(s+1*t),!1}),e(".bPaginator_eLink").bind("click",function(){if(e(this).hasClass("active"))return!1;var t=1*e(this).attr("href").slice(1);return d(t),!1});var d=function d(t){0===t?e(".bPromoCatalogSlider_eArrow.mArLeft").hide():e(".bPromoCatalogSlider_eArrow.mArLeft").show(),t===r-1?e(".bPromoCatalogSlider_eArrow.mArRight").hide():e(".bPromoCatalogSlider_eArrow.mArRight").show(),e(".bPromoCatalogSliderWrap").animate({left:-(n*t)},500,function(){s=t}),window.location.hash="slide"+(t+1),i.setActive(t)},l=window.location.hash;if(l.indexOf("slide")+1){var c=parseInt(l.slice(6),10)-1;d(c)}}}(jQuery),function(){var e=$("body"),t="subscribed",o=function o(){var e=$(".bSubscribeLightboxPopupNotNow"),o=$(".bSubscribeLightboxPopup"),r=$(".bSubscribeLightboxPopup__eInput"),i=$(".bSubscribeLightboxPopup__eBtn"),a={show:!window.docCookies.hasItem(t),agreed:1===window.docCookies.getItem(t)},n=new FormValidator({fields:[{fieldNode:r,customErr:"Неправильный емейл",required:!0,email:!0,validBy:"isEmail"}]}),s=function s(){n.validate({onInvalid:function(e){console.log("Email is invalid"),console.log(e)},onValid:function(){console.log("Email is valid")}})},d=function d(){var e=r.val(),t=$(this).data("url");return i.hasClass("mDisabled")?!1:($.post(t,{email:e},function(e){return e.success?(o.html('<span class="bSubscribeLightboxPopup__eTitle mType">Спасибо! подтверждение подписки отправлено на указанный e-mail</span>'),window.docCookies.setItem("subscribed",1,15768e4,"/"),setTimeout(function(){o.slideUp(300)},3e3),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Account","Emailing sign up","Page top"]),void 0):!1}),!1)},l=function l(){o.slideDown(300),i.bind("click",d),$(".bSubscribeLightboxPopup__eNotNow").bind("click",function(){var e=$(this).data("url");return o.slideUp(300,c),window.docCookies.setItem("subscribed",0,15768e4,"/"),$.post(e),!1})},c=function c(){e.slideDown(300),e.bind("click",function(){$(this).slideUp(300),l()})};return r.placeholder(),a.show?(l(),r.bind("keyup",s),void 0):(a.agreed||c(),!1)};e.bind("showsubscribe",o),e.trigger("showsubscribe")}(),function(){var e=$("body"),t=$("div.searchbox form"),o=t.find("input.searchtext"),r=$("#searchAutocomplete"),i=$(".bSearchSuggest__eRes"),a=-1,n=0,s={},d=null,l=function l(){var e=i.eq(a).attr("href"),t=i.eq(a).hasClass("bSearchSuggest__eCategoryRes")?"suggest_category":"suggest_product";"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Search",t,e])},c=function c(){var e=o.val(),t=function t(t){s[e]=t,r.html(t),i=$(".bSearchSuggest__eRes"),n=i.length,n&&setTimeout(f,99)},a=function a(){var o="/search/autocomplete?q=";return 3>e.length?!1:(o+=encodeURI(e),$.ajax({type:"GET",url:o,success:t}),void 0)};return 0===e.length?(r.empty(),!1):(clearTimeout(d),s[e]?(t(s[e]),!1):(d=setTimeout(a,300),void 0))},u=function u(){var e=o.val().replace(/(^\s*)|(\s*$)/g,"").replace(/(\s+)/g," ");o.val(e)};h=function h(e){var t=e.which;return t>=37&&40>=t||27===t||13===t?!1:(c(),void 0)},g=function g(e){var t=e.which,o=function o(){i.removeClass("hover").eq(a).addClass("hover")},s=function s(){a-1>=0?(a--,o()):(a=-1,i.removeClass("hover"),$(this).focus())},d=function d(){n-1>=a+1&&(a++,o())},c=function c(){var e=i.eq(a).attr("href");l(),document.location.href=e};return 38===t?(s(),!1):40===t?(d(),!1):27===t?(r.empty(),!1):13===t&&(u(),-1!==a)?(c(),!1):void 0},m=function m(){var e=o.attr("value");return 0===e.length?!1:(u(),void 0)},f=function f(){r.show()},p=function p(e){var t=e.target.className;t.indexOf("bSearchSuggest")+1||t.indexOf("searchtext")+1||r.hide()},v=function v(){var e=0;i.removeClass("hover"),e=$(this).addClass("hover").index(),a=e-1},y=function y(){var e=$(this).text();o.val(e+" ").focus(),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","tooltip",e]),c()},$(document).ready(function(){o.bind("keydown",g),o.bind("keyup",h),o.bind("focus",f),t.bind("submit",m),o.placeholder(),e.bind("click",p),e.on("mouseenter",".bSearchSuggest__eRes",v),e.on("click",".bSearchSuggest__eRes",l),e.on("click",".sHint_value",y)})}(),function(){var e=300,t=600,o=15,r=null,i=null,a=!1,n=null,s=null,d=null,l=null,c=null,u={x:0,y:0},h={x:0,y:0},g={x:0,y:0},m={x:0,y:0},f=function(e){r=new Date,i=e,$(".bMainMenuLevel-2__eItem").removeClass("hover"),e.addClass("hover")},p=function(){var t=$(this);t.hasClass("jsEmptyChild")||(r=new Date,a=!0,setTimeout(function(){a&&new Date-r>e&&f(t)},e+20))},v=function(){var e=$(this);e.removeClass("hover"),a=!1},y=function(){u={x:m.x,y:m.y-$(window).scrollTop()},h={x:c.left-o,y:c.top-$(window).scrollTop()},g={x:c.left-o,y:c.top+c.height-$(window).scrollTop()}},b=function(){var e=(u.x-m.x)*(h.y-u.y)-(h.x-u.x)*(u.y-m.y),t=(h.x-m.x)*(g.y-h.y)-(g.x-h.x)*(h.y-m.y),r=(g.x-m.x)*(u.y-g.y)-(u.x-g.x)*(g.y-m.y);return e>=0&&t>=0&&r>=0||0>=e&&0>=t&&0>=r||m.x>=h.x&&m.x<=h.x+o&&m.y>=h.y&&m.y<=g.y?!0:!1},_=function(e){m={x:e.pageX,y:e.pageY-$(window).scrollTop()};var t=$(this);s&&t.attr("class")===s.attr("class")&&(S(t),n=new Date),P(t)},k=function(e){s=e,e.addClass("hover"),n=new Date,S(e)},C=function(){var e=$(this);P(e),e.addClass("hoverNowLvl2"),n&&t>=new Date-n&&b()&&setTimeout(function(){e.hasClass("hoverNowLvl2")&&new Date-n>t&&P(e)
},t+20)},w=function(){var e=$(this);e.removeClass("hoverNowLvl2")},P=function(e){n?(!b()||n&&new Date-n>t&&b())&&(s.removeClass("hover"),k(e)):k(e)},S=function(e){d=L(e),l=L(e.find(".bMainMenuLevel-3"));var t=e.find(".bMainMenuLevel-2__eTitle")[0].offsetWidth;c={top:l.top,left:l.left+t,width:l.width-t,height:l.height},y()},L=function(e){var t=$(e).width(),o=$(e).height();e=e[0];for(var r=0,i=0;e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop);)r+=e.offsetLeft-e.scrollLeft,i+=e.offsetTop-e.scrollTop,e=e.offsetParent;return{top:i,left:r,width:t,height:o}};$(".bMainMenuLevel-1__eItem").mouseenter(p),$(".bMainMenuLevel-1__eItem").mouseleave(v),$(".bMainMenuLevel-2__eItem").mouseenter(C),$(".bMainMenuLevel-2__eItem").mousemove(_),$(".bMainMenuLevel-2__eItem").mouseleave(w)}(),function(){var e=$("#upper"),t=!1,o=function o(){$(window).scrollTop()>600&&!t?(t=!0,e.animate({marginTop:"0"},400)):600>$(window).scrollTop()&&t&&(t=!1,e.animate({marginTop:"-55px"},400))},r=function r(){return $(window).scrollTo("0px",400),!1};$(window).scroll(o),e.bind("click",r)}(),function(e){var t,o,r=e.config,i=e.utils,a=r.clientCart,n=i.extendApp("ENTER.userBar"),s=n.userBarFixed=$(".fixedTopBar.mFixed"),d=n.userBarStatic=$(".fixedTopBar.mStatic"),l=s.find(".fixedTopBar__upLink"),c=s.data("value"),u=$("body"),h=$(window),g=!1,m=$("<div>").css({position:"fixed",display:"none",width:"100%",height:"100%",top:0,left:0,zIndex:900,background:"black",opacity:.4});n.showOverlay=!1;var f=function f(){s.slideDown(),d.css("visibility","hidden")},p=function p(){s.slideUp(),d.css("visibility","visible")},v=function v(){var e=h.scrollTop();g||(e>=o?f():p())},y=function y(){return $.scrollTo(t,500),e.catalog.filter.openFilter(),!1},b=function b(e,t){console.info("userbar::updateUserInfo"),console.log(t);var o,r=s.find(".fixedTopBar__logIn"),i=d.find(".fixedTopBar__logIn"),a=$("#userbar_user_tmpl"),n=a.data("partial");t&&t.name&&t.link&&(o=Mustache.render(a.html(),t,n),i.removeClass("mLogin"),r.removeClass("mLogin"),i.html(o),r.html(o))},_=function _(e){console.info("userbar::showBuyInfo");var t,o,r=s.find(".fixedTopBar__cart"),d=s.find(".fixedTopBar__logIn"),l=$("#buyinfo_tmpl"),c=l.data("partial"),h="mOpenedPopup",p={};p.products=i.cloneObject(a.products),p.showTransparent=!!(p.products.length>3);var y=function y(){var e=r.find(".hintDd");return e.removeClass("mhintDdOn"),d.removeClass(h),r.removeClass(h),t.slideUp(300,function(){t.remove(),g=!1}),n.showOverlay?(m.fadeOut(300,function(){m.off("click"),m.remove(),v(),n.showOverlay=!1}),!1):void 0};p.products.reverse(),console.log(p),o=Mustache.render(l.html(),p,c),t=$(o).css({left:-129}),t.find(".cartList__item").eq(0).addClass("mHover"),d.addClass(h),r.addClass(h),r.append(t),n.showOverlay||(u.append(m),m.fadeIn(300),n.showOverlay=!0),e?t.slideDown(300):t.show(),f(),g=!0,m.on("click",y)},k=function k(){console.log("deleteProductHandler click!");var e=$(this),t=e.attr("href"),o=function o(e){if(console.warn(e),!e.success)return console.warn("удаление не получилось :("),void 0;i.blackBox.basket().deleteItem(e),0!==a.products.length&&_(),0==a.products.length&&(m.fadeOut(300,function(){m.off("click"),m.remove(),n.showOverlay=!1}),g=!1,console.log("clientCart is empty"),v());var t=e.product.addUrl;addBtnBuy=e.product.cartButton.id,$("."+addBtnBuy).html("Купить").removeClass("mBought").attr("href",t)};return $.ajax({type:"GET",url:t,success:o}),!1},C=function C(e,t){console.info("userbar::updateBasketInfo"),console.log(t),console.log(a);var o,r=s.find(".fixedTopBar__cart"),n=d.find(".fixedTopBar__cart"),l=$("#userbar_cart_tmpl"),c=l.data("partial");if(console.log("vars inited"),t.hasProducts=!1,t.showTransparent=!1,!(t&&t.quantity&&t.sum)){console.warn("data and data.quantuty and data.sum not true");var l=$("#userbar_cart_empty_tmpl");return c=l.data("partial"),o=Mustache.render(l.html(),t,c),r.addClass("mEmpty"),n.addClass("mEmpty"),n.html(o),r.html(o),void 0}0!==a.products.length&&(t.hasProducts=!0,t.products=i.cloneObject(a.products),t.products.reverse()),a.products.length>3&&(t.showTransparent=!0),t.sum=printPrice(t.sum),o=Mustache.render(l.html(),t,c),n.removeClass("mEmpty"),r.removeClass("mEmpty"),n.html(o),r.html(o)},w=function w(e,t,o){console.info("userbar::showUpsell");var r,i=s.find(".fixedTopBar__cart"),a=i.find(".hintDd"),n=function n(e){if(console.log(e),e.success){if(console.info('Получены рекомендации "С этим товаром также покупают" от RetailRocket'),a.find(".bGoodsSlider").remove(),r=$(e.content)[0],a.append(r),a.addClass("mhintDdOn"),$(r).goodsSlider(),!t.product.article)return console.warn("Не получен article продукта"),void 0;console.log("Трекинг товара при показе блока рекомендаций"),_gaq&&_gaq.push(["_trackEvent","cart_recommendation","cart_rec_shown",t.product.article]),_kmq&&_kmq.push(["record","cart recommendation shown",{"SKU cart rec shown":t.product.article}])}};console.log(o),o.url&&$.ajax({type:"GET",url:o.url,success:n})},P=function P(){var e=$(this).parents(".jsSliderItem").data("product");return e.article?(console.log("Трекинг при клике по товару из списка рекомендаций"),_gaq&&_gaq.push(["_trackEvent","cart_recommendation","cart_rec_clicked",e.article]),_kmq&&_kmq.push(["record","cart recommendation clicked",{"SKU cart rec clicked":e.article}]),void 0):(console.warn("Не получен article продукта"),void 0)};console.info("Init userbar module"),console.log(c),u.on("click",".jsUpsaleProduct",P),u.on("userLogged",b),u.on("basketUpdate",C),u.on("getupsale",w),d.on("click",".jsCartDelete",k),s.length?(u.on("addtocart",_),s.on("click",".jsCartDelete",k),t=$(c.target),l.length&&l.on("click",y),t.length&&(o=t.offset().top+s.height(),h.on("scroll",v))):(m.remove(),m=!1)}(window.ENTER);