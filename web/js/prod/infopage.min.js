$(document).ready(function(){function e(e){return""===e.val().replace(/\s/g,"")?(e.addClass("mEmpty"),e.after($('<span class="mEmpty">(!) Пожалуйста, верно заполните поле</span>')),!1):(e.hasClass("mEmpty")&&(e.removeClass("mEmpty"),e.parent().find(".mEmpty").remove()),!0)}function t(){$("#f_success").show(),$("#f_init").hide()}function r(){$("#oneClickPromo input[type=text]").removeAttr("disabled"),$("#f_init h2").text("Произошла ошибка :( Попробуйте ещё"),button.text("Отправить предзаказ")}function i(){$(f).hide()}function n(e){return f=e,$(e).show(),!1}if($(".subscribe-form__btn").length){var a=$(".subscribe-form__email"),o=$(".subscribe-form"),s=function(){var e=$(this).data("url"),t=a.val();return-1!==t.search("@")?$.post(e,{email:t},function(e){return e.success?(o.html('<div class="subscribe-form__title">Спасибо! подтверждение подписки отправлено на указанный e-mail</div>'),docCookies.setItem(!1,"subscribed",1,15768e4,"/"),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Account","Emailing sign up","Page be-friends"]),void 0):!1}):a.addClass("mError"),!1};$(".subscribe-form__btn").bind("click",s)}if($(".infiniteCarousel").infiniteCarousel(),$(".getProductList").length&&(console.log("yes!"),$(".getProductList").each(function(){var e=$(this),t=e.data("product"),r="/products/widget/"+t;$.get(r,function(t){return t.success?(e.html(t.content),void 0):!1})})),$("#corp_select").length&&($('form[action="/corporate-register"]').bind("submit",function(){return"Другая форма"===$("#corp_select").find("option:selected").val()?!1:void 0}),$("#corp_select").change(function(){"Другая форма"===$(this).find("option:selected").val()&&$("#corpNotice").lightbox_me({centered:!0,closeSelector:".close"})})),$("#oneClickPromo").length&&($(".halfline .bOrangeButton.active").click(function(){var e=$(this).parent().parent(),t={};t.token=e.find(".ttl").text(),t.price=e.find(".price").text(),t.image=e.find("img").attr("src"),$("#ipadwrapper").html(tmpl("ipad",t)),$("#order1click-container-new").lightbox_me({})}),$("#oneClickPromo").submit(function(e){return e.preventDefault(),!1}),$.mask!==void 0&&($.mask.definitions.n="[()0-9 -]",$("#phonemask").mask("8nnnnnnnnnnnnnnnnn",{placeholder:" ",maxlength:10})),$("#oneClickPromo input[type=text]").change(function(){e($(this))}),$(".bBigOrangeButton").click(function(e){if(e.preventDefault(),$("#oneClickPromo input[type=text]").trigger("change"),!$(".mEmpty").length){var i=$(this);i.text("Идёт отправка...");var n=$("#oneClickPromo").serializeArray();$("#oneClickPromo input[type=text]").attr("disabled","disabled");var a=$("#oneClickPromo").attr("action");$.ajax({url:a,data:n,success:function(e){return"success"in e?"ok"!==e.success?(r(),!1):(t(),!0):(r(),!1)}})}})),$(".bCreditLine").length){document.getElementById("requirementsFullInfoHref").style.cursor="pointer",$("#requirementsFullInfoHref").bind("click",function(){$(".bCreditLine2").toggle()});for(var l=$("#creditOptions").data("value"),c=$("#bankInfo").data("value"),h=$("#relations").data("value"),u=0;l.length>u;u++)creditOption=l[u],$("<option>").val(creditOption.id).text(creditOption.name).appendTo("#productSelector");$("#productSelector").change(function(){var e=$(this).val(),t=h[e];$("#bankProductInfoContainer").empty();for(u in t){var r={};r.bankName=c[u].name,r.bankImage=c[u].image,programNames="";for(j in t[u]){programNames+="<h4>"+c[u].programs[t[u][j]].name+"</h4>\r\n<ul>";for(k in c[u].programs[t[u][j]].params)programNames+="	<li>"+c[u].programs[t[u][j]].params[k]+"</li>\r\n";programNames+="</ul>"}r.programNames=programNames;var i=tmpl("bank_program_list_tmpl",r);$("#bankProductInfoContainer").append(i)}$("#bankProductInfoContainer").append('<p class="ac mb25"><a class="bBigOrangeButton" href="'+l[e-1].url+'">'+l[e-1].button_name+"</a></p>")})}if($(".bMobileApps").length){var f="";$("body").bind("click.mob",i),$("div.bMobDown").click(function(e){e.stopPropagation()}),$(".bMobDown__eClose").click(function(){return i(),!1}),$(".android-load").click(function(){return n(".android-block"),!1}),$(".iphone-load").click(function(){return n(".iphone-block"),!1}),$(".symbian-load").click(function(){return n(".symbian-block"),!1})}$("#hideLoginform").length&&$("#hideLoginform").bind("click",function(){var e=$("#login-form");return $("#hideLoginform").hide(),e.slideDown(300),$.scrollTo(e,500),console.log("123"),!1});var d=function(e,t,r,i){function n(){for(s.append('<div class="bPaginator_eWrap"></div>'),s.append('<div class="bPaginatorSlider"><div class="bPaginatorSlider_eWrap"><div class="bPaginatorSlider_eFill" style="width:'+c+'px"></div></div></div>'),u=0;self.inputVars.totalPages>u;u++)$(".bPaginator_eWrap",s).append('<a class="bPaginator_eLink" href="#'+u+'">'+(u+1)+"</a>"),u+1===self.inputVars.activePage&&$(".bPaginator_eLink",s).eq(u).addClass("active");var e=$(".bPaginator_eLink",s).width();$(".bPaginator_eLink",s).css({marginLeft:(f-e-2)/2,marginRight:(f-e-2)/2}),$(".bPaginator_eWrap",s).addClass("clearfix").width(f*self.inputVars.totalPages)}function a(){var e=!1,t=0,r=0;$(".bPaginatorSlider",s).bind("mousedown",function(i){t=i.pageX,r=parseInt($(".bPaginatorSlider_eFill",s).css("left")),e=!0}),$(".bPaginatorSlider",s).bind("mouseup",function(){e=!1}),s.bind("mouseout",function(){e=!1}),$(".bPaginatorSlider",s).bind("mousemove",function(i){if(e){var n=r+(i.pageX-t);n>=0&&l-c>=n&&($(".bPaginatorSlider_eFill",s).css("left",r+(i.pageX-t)),o(n))}})}function o(e){var t=Math.round(e/h);$(".bPaginator_eWrap",s).css("left",-(f*t))}self=this,self.inputVars={domID:e,totalPages:t,visPages:r?r:10,activePage:i?i:1};var s=$("#"+self.inputVars.domID),l=s.width(),c=l*self.inputVars.visPages/self.inputVars.totalPages,h=c/self.inputVars.visPages,f=l/self.inputVars.visPages,d=Math.round(self.inputVars.visPages/2);self.setActive=function(e){$(".bPaginator_eLink",s).removeClass("active"),$(".bPaginator_eLink",s).eq(e).addClass("active");var t=parseInt($(".bPaginator_eWrap",s).css("left")),r=parseInt($(".bPaginatorSlider_eFill",s).css("left")),i=-1*Math.round(t/f),n=-(d-(e-i));t-n*f>0?(t=0,r=0):e>self.inputVars.totalPages-d?(t=-1*Math.round(self.inputVars.totalPages-self.inputVars.visPages)*f,r=Math.round(self.inputVars.totalPages-self.inputVars.visPages)*h):(t-=n*f,r+=n*h),$(".bPaginator_eWrap").animate({left:t}),$(".bPaginatorSlider_eFill",s).animate({left:r})},n(),a()};if($("#promoCatalog").length){var p=$("#promoCatalog").data("slides"),m=p.length,v=new d("promoCatalogPaginator",m,12,1),_=function(){for(var e in p){var t=tmpl("slide_tmpl",p[e]);$(".bPromoCatalogSliderWrap").append(t),""==$(".bPromoCatalogSliderWrap_eSlideLink").eq(e).attr("href")&&$(".bPromoCatalogSliderWrap_eSlideLink").eq(e).removeAttr("href"),$(".bPromoCatalogNav").append('<a id="promoCatalogSlide'+e+'" href="#'+e+'" class="bPromoCatalogNav_eLink">'+(1*e+1)+"</a>")}};_();var g=$(".bPromoCatalogSliderWrap_eSlide").width();$(".bPromoCatalogSliderWrap").width(g*m+(460-g/2));var E=0;$(".bPromoCatalogSlider_eArrow").bind("click",function(){var e=$(this).hasClass("mArLeft")?"-1":"1";return y(E+1*e),!1}),$(".bPaginator_eLink").bind("click",function(){if($(this).hasClass("active"))return!1;var e=1*$(this).attr("href").slice(1);return y(e),!1});var y=function(e){0===e?$(".bPromoCatalogSlider_eArrow.mArLeft").hide():$(".bPromoCatalogSlider_eArrow.mArLeft").show(),e===m-1?$(".bPromoCatalogSlider_eArrow.mArRight").hide():$(".bPromoCatalogSlider_eArrow.mArRight").show(),$(".bPromoCatalogSliderWrap").animate({left:-(g*e)},500,function(){E=e}),window.location.hash="slide"+(e+1),v.setActive(e)},T=window.location.hash;if(T.indexOf("slide")+1){var b=parseInt(T.slice(6))-1;y(b)}}});