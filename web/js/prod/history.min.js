(function(e,t){"use strict";var a=e.History=e.History||{},r=e.jQuery;if(a.Adapter!==t)throw Error("History.js Adapter has already been loaded...");a.Adapter={bind:function(e,t,a){r(e).bind(t,a)},trigger:function(e,t,a){r(e).trigger(t,a)},extractEventData:function(e,a,r){var n=a&&a.originalEvent&&a.originalEvent[e]||r&&r[e]||t;return n},onDomLoad:function(e){r(e)}},a.init!==t&&a.init()})(window),function(e,t){"use strict";var a=e.console||t,r=e.document,n=e.navigator,o=e.sessionStorage||!1,i=e.setTimeout,s=e.clearTimeout,l=e.setInterval,d=e.clearInterval,u=e.JSON,p=e.alert,c=e.History=e.History||{},f=e.history;try{o.setItem("TEST","1"),o.removeItem("TEST")}catch(h){o=!1}if(u.stringify=u.stringify||u.encode,u.parse=u.parse||u.decode,c.init!==t)throw Error("History.js Core has already been loaded...");c.init=function(){return c.Adapter===t?!1:(c.initCore!==t&&c.initCore(),c.initHtml4!==t&&c.initHtml4(),!0)},c.initCore=function(){if(c.initCore.initialized!==t)return!1;if(c.initCore.initialized=!0,c.options=c.options||{},c.options.hashChangeInterval=c.options.hashChangeInterval||100,c.options.safariPollInterval=c.options.safariPollInterval||500,c.options.doubleCheckInterval=c.options.doubleCheckInterval||500,c.options.disableSuid=c.options.disableSuid||!1,c.options.storeInterval=c.options.storeInterval||1e3,c.options.busyDelay=c.options.busyDelay||250,c.options.debug=c.options.debug||!1,c.options.initialTitle=c.options.initialTitle||r.title,c.options.html4Mode=c.options.html4Mode||!1,c.options.delayInit=c.options.delayInit||!1,c.intervalList=[],c.clearAllIntervals=function(){var e,a=c.intervalList;if(a!==t&&null!==a){for(e=0;a.length>e;e++)d(a[e]);c.intervalList=null}},c.debug=function(){c.options.debug&&c.log.apply(c,arguments)},c.log=function(){var e,n,o,i,s,l=!(a===t||a.log===t||a.log.apply===t),d=r.getElementById("log");for(l?(i=Array.prototype.slice.call(arguments),e=i.shift(),a.debug!==t?a.debug.apply(a,[e,i]):a.log.apply(a,[e,i])):e="\n"+arguments[0]+"\n",n=1,o=arguments.length;o>n;++n){if(s=arguments[n],"object"==typeof s&&u!==t)try{s=u.stringify(s)}catch(c){}e+="\n"+s+"\n"}return d?(d.value+=e+"\n-----\n",d.scrollTop=d.scrollHeight-d.clientHeight):l||p(e),!0},c.getInternetExplorerMajorVersion=function(){var e=c.getInternetExplorerMajorVersion.cached=c.getInternetExplorerMajorVersion.cached!==t?c.getInternetExplorerMajorVersion.cached:function(){for(var e=3,t=r.createElement("div"),a=t.getElementsByTagName("i");(t.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->")&&a[0];);return e>4?e:!1}();return e},c.isInternetExplorer=function(){var e=c.isInternetExplorer.cached=c.isInternetExplorer.cached!==t?c.isInternetExplorer.cached:Boolean(c.getInternetExplorerMajorVersion());return e},c.emulated=c.options.html4Mode?{pushState:!0,hashChange:!0}:{pushState:!Boolean(e.history&&e.history.pushState&&e.history.replaceState&&!(/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(n.userAgent)||/AppleWebKit\/5([0-2]|3[0-2])/i.test(n.userAgent))),hashChange:Boolean(!("onhashchange"in e||"onhashchange"in r)||c.isInternetExplorer()&&8>c.getInternetExplorerMajorVersion())},c.enabled=!c.emulated.pushState,c.bugs={setHash:Boolean(!c.emulated.pushState&&"Apple Computer, Inc."===n.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(n.userAgent)),safariPoll:Boolean(!c.emulated.pushState&&"Apple Computer, Inc."===n.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(n.userAgent)),ieDoubleCheck:Boolean(c.isInternetExplorer()&&8>c.getInternetExplorerMajorVersion()),hashEscape:Boolean(c.isInternetExplorer()&&7>c.getInternetExplorerMajorVersion())},c.isEmptyObject=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},c.cloneObject=function(e){var t,a;return e?(t=u.stringify(e),a=u.parse(t)):a={},a},c.getRootUrl=function(){var e=r.location.protocol+"//"+(r.location.hostname||r.location.host);return r.location.port&&(e+=":"+r.location.port),e+="/"},c.getBaseHref=function(){var e=r.getElementsByTagName("base"),t=null,a="";return 1===e.length&&(t=e[0],a=t.href.replace(/[^\/]+$/,"")),a=a.replace(/\/+$/,""),a&&(a+="/"),a},c.getBaseUrl=function(){var e=c.getBaseHref()||c.getBasePageUrl()||c.getRootUrl();return e},c.getPageUrl=function(){var e,t=c.getState(!1,!1),a=(t||{}).url||c.getLocationHref();return e=a.replace(/\/+$/,"").replace(/[^\/]+$/,function(e){return/\./.test(e)?e:e+"/"})},c.getBasePageUrl=function(){var e=c.getLocationHref().replace(/[#\?].*/,"").replace(/[^\/]+$/,function(e){return/[^\/]$/.test(e)?"":e}).replace(/\/+$/,"")+"/";return e},c.getFullUrl=function(e,a){var r=e,n=e.substring(0,1);return a=a===t?!0:a,/[a-z]+\:\/\//.test(e)||(r="/"===n?c.getRootUrl()+e.replace(/^\/+/,""):"#"===n?c.getPageUrl().replace(/#.*/,"")+e:"?"===n?c.getPageUrl().replace(/[\?#].*/,"")+e:a?c.getBaseUrl()+e.replace(/^(\.\/)+/,""):c.getBasePageUrl()+e.replace(/^(\.\/)+/,"")),r.replace(/\#$/,"")},c.getShortUrl=function(e){var t=e,a=c.getBaseUrl(),r=c.getRootUrl();return c.emulated.pushState&&(t=t.replace(a,"")),t=t.replace(r,"/"),c.isTraditionalAnchor(t)&&(t="./"+t),t=t.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")},c.getLocationHref=function(e){return e=e||r,e.URL===e.location.href?e.location.href:e.location.href===decodeURIComponent(e.URL)?e.URL:e.location.hash&&decodeURIComponent(e.location.href.replace(/^[^#]+/,""))===e.location.hash?e.location.href:-1==e.URL.indexOf("#")&&-1!=e.location.href.indexOf("#")?e.location.href:e.URL||e.location.href},c.store={},c.idToState=c.idToState||{},c.stateToId=c.stateToId||{},c.urlToId=c.urlToId||{},c.storedStates=c.storedStates||[],c.savedStates=c.savedStates||[],c.normalizeStore=function(){c.store.idToState=c.store.idToState||{},c.store.urlToId=c.store.urlToId||{},c.store.stateToId=c.store.stateToId||{}},c.getState=function(e,a){e===t&&(e=!0),a===t&&(a=!0);var r=c.getLastSavedState();return!r&&a&&(r=c.createStateObject()),e&&(r=c.cloneObject(r),r.url=r.cleanUrl||r.url),r},c.getIdByState=function(e){var a,r=c.extractId(e.url);if(!r)if(a=c.getStateString(e),c.stateToId[a]!==t)r=c.stateToId[a];else if(c.store.stateToId[a]!==t)r=c.store.stateToId[a];else{for(;;)if(r=(new Date).getTime()+(Math.random()+"").replace(/\D/g,""),c.idToState[r]===t&&c.store.idToState[r]===t)break;c.stateToId[a]=r,c.idToState[r]=e}return r},c.normalizeState=function(e){var a,r;return e&&"object"==typeof e||(e={}),e.normalized!==t?e:(e.data&&"object"==typeof e.data||(e.data={}),a={},a.normalized=!0,a.title=e.title||"",a.url=c.getFullUrl(e.url?e.url:c.getLocationHref()),a.hash=c.getShortUrl(a.url),a.data=c.cloneObject(e.data),a.id=c.getIdByState(a),a.cleanUrl=a.url.replace(/\??\&_suid.*/,""),a.url=a.cleanUrl,r=!c.isEmptyObject(a.data),(a.title||r)&&c.options.disableSuid!==!0&&(a.hash=c.getShortUrl(a.url).replace(/\??\&_suid.*/,""),/\?/.test(a.hash)||(a.hash+="?"),a.hash+="&_suid="+a.id),a.hashedUrl=c.getFullUrl(a.hash),(c.emulated.pushState||c.bugs.safariPoll)&&c.hasUrlDuplicate(a)&&(a.url=a.hashedUrl),a)},c.createStateObject=function(e,t,a){var r={data:e,title:t,url:a};return r=c.normalizeState(r)},c.getStateById=function(e){e+="";var a=c.idToState[e]||c.store.idToState[e]||t;return a},c.getStateString=function(e){var t,a,r;return t=c.normalizeState(e),a={data:t.data,title:e.title,url:e.url},r=u.stringify(a)},c.getStateId=function(e){var t,a;return t=c.normalizeState(e),a=t.id},c.getHashByState=function(e){var t,a;return t=c.normalizeState(e),a=t.hash},c.extractId=function(e){var t,a,r,n;return n=-1!=e.indexOf("#")?e.split("#")[0]:e,a=/(.*)\&_suid=([0-9]+)$/.exec(n),r=a?a[1]||e:e,t=a?(a[2]||"")+"":"",t||!1},c.isTraditionalAnchor=function(e){var t=!/[\/\?\.]/.test(e);return t},c.extractState=function(e,t){var a,r,n=null;return t=t||!1,a=c.extractId(e),a&&(n=c.getStateById(a)),n||(r=c.getFullUrl(e),a=c.getIdByUrl(r)||!1,a&&(n=c.getStateById(a)),n||!t||c.isTraditionalAnchor(e)||(n=c.createStateObject(null,null,r))),n},c.getIdByUrl=function(e){var a=c.urlToId[e]||c.store.urlToId[e]||t;return a},c.getLastSavedState=function(){return c.savedStates[c.savedStates.length-1]||t},c.getLastStoredState=function(){return c.storedStates[c.storedStates.length-1]||t},c.hasUrlDuplicate=function(e){var t,a=!1;return t=c.extractState(e.url),a=t&&t.id!==e.id},c.storeState=function(e){return c.urlToId[e.url]=e.id,c.storedStates.push(c.cloneObject(e)),e},c.isLastSavedState=function(e){var t,a,r,n=!1;return c.savedStates.length&&(t=e.id,a=c.getLastSavedState(),r=a.id,n=t===r),n},c.saveState=function(e){return c.isLastSavedState(e)?!1:(c.savedStates.push(c.cloneObject(e)),!0)},c.getStateByIndex=function(e){var a=null;return a=e===t?c.savedStates[c.savedStates.length-1]:0>e?c.savedStates[c.savedStates.length+e]:c.savedStates[e]},c.getCurrentIndex=function(){var e=null;return e=1>c.savedStates.length?0:c.savedStates.length-1},c.getHash=function(e){var t,a=c.getLocationHref(e);return t=c.getHashByUrl(a)},c.unescapeHash=function(e){var t=c.normalizeHash(e);return t=decodeURIComponent(t)},c.normalizeHash=function(e){var t=e.replace(/[^#]*#/,"").replace(/#.*/,"");return t},c.setHash=function(e,t){var a,n;return t!==!1&&c.busy()?(c.pushQueue({scope:c,callback:c.setHash,args:arguments,queue:t}),!1):(c.busy(!0),a=c.extractState(e,!0),a&&!c.emulated.pushState?c.pushState(a.data,a.title,a.url,!1):c.getHash()!==e&&(c.bugs.setHash?(n=c.getPageUrl(),c.pushState(null,null,n+"#"+e,!1)):r.location.hash=e),c)},c.escapeHash=function(t){var a=c.normalizeHash(t);return a=e.encodeURIComponent(a),c.bugs.hashEscape||(a=a.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),a},c.getHashByUrl=function(e){var t=(e+"").replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return t=c.unescapeHash(t)},c.setTitle=function(e){var t,a=e.title;a||(t=c.getStateByIndex(0),t&&t.url===e.url&&(a=t.title||c.options.initialTitle));try{r.getElementsByTagName("title")[0].innerHTML=a.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(n){}return r.title=a,c},c.queues=[],c.busy=function(e){if(e!==t?c.busy.flag=e:c.busy.flag===t&&(c.busy.flag=!1),!c.busy.flag){s(c.busy.timeout);var a=function(){var e,t,r;if(!c.busy.flag)for(e=c.queues.length-1;e>=0;--e)t=c.queues[e],0!==t.length&&(r=t.shift(),c.fireQueueItem(r),c.busy.timeout=i(a,c.options.busyDelay))};c.busy.timeout=i(a,c.options.busyDelay)}return c.busy.flag},c.busy.flag=!1,c.fireQueueItem=function(e){return e.callback.apply(e.scope||c,e.args||[])},c.pushQueue=function(e){return c.queues[e.queue||0]=c.queues[e.queue||0]||[],c.queues[e.queue||0].push(e),c},c.queue=function(e,a){return"function"==typeof e&&(e={callback:e}),a!==t&&(e.queue=a),c.busy()?c.pushQueue(e):c.fireQueueItem(e),c},c.clearQueue=function(){return c.busy.flag=!1,c.queues=[],c},c.stateChanged=!1,c.doubleChecker=!1,c.doubleCheckComplete=function(){return c.stateChanged=!0,c.doubleCheckClear(),c},c.doubleCheckClear=function(){return c.doubleChecker&&(s(c.doubleChecker),c.doubleChecker=!1),c},c.doubleCheck=function(e){return c.stateChanged=!1,c.doubleCheckClear(),c.bugs.ieDoubleCheck&&(c.doubleChecker=i(function(){return c.doubleCheckClear(),c.stateChanged||e(),!0},c.options.doubleCheckInterval)),c},c.safariStatePoll=function(){var t,a=c.extractState(c.getLocationHref());if(!c.isLastSavedState(a))return t=a,t||(t=c.createStateObject()),c.Adapter.trigger(e,"popstate"),c},c.back=function(e){return e!==!1&&c.busy()?(c.pushQueue({scope:c,callback:c.back,args:arguments,queue:e}),!1):(c.busy(!0),c.doubleCheck(function(){c.back(!1)}),f.go(-1),!0)},c.forward=function(e){return e!==!1&&c.busy()?(c.pushQueue({scope:c,callback:c.forward,args:arguments,queue:e}),!1):(c.busy(!0),c.doubleCheck(function(){c.forward(!1)}),f.go(1),!0)},c.go=function(e,t){var a;if(e>0)for(a=1;e>=a;++a)c.forward(t);else{if(!(0>e))throw Error("History.go: History.go requires a positive or negative integer passed.");for(a=-1;a>=e;--a)c.back(t)}return c},c.emulated.pushState){var h=function(){};c.pushState=c.pushState||h,c.replaceState=c.replaceState||h}else c.onPopState=function(t,a){var r,n,o=!1,i=!1;return c.doubleCheckComplete(),(r=c.getHash())?(n=c.extractState(r||c.getLocationHref(),!0),n?c.replaceState(n.data,n.title,n.url,!1):(c.Adapter.trigger(e,"anchorchange"),c.busy(!1)),c.expectedStateId=!1,!1):(o=c.Adapter.extractEventData("state",t,a)||!1,i=o?c.getStateById(o):c.expectedStateId?c.getStateById(c.expectedStateId):c.extractState(c.getLocationHref()),i||(i=c.createStateObject(null,null,c.getLocationHref())),c.expectedStateId=!1,c.isLastSavedState(i)?(c.busy(!1),!1):(c.storeState(i),c.saveState(i),c.setTitle(i),c.Adapter.trigger(e,"statechange"),c.busy(!1),!0))},c.Adapter.bind(e,"popstate",c.onPopState),c.pushState=function(t,a,r,n){if(c.getHashByUrl(r)&&c.emulated.pushState)throw Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(n!==!1&&c.busy())return c.pushQueue({scope:c,callback:c.pushState,args:arguments,queue:n}),!1;c.busy(!0);var o=c.createStateObject(t,a,r);return c.isLastSavedState(o)?c.busy(!1):(c.storeState(o),c.expectedStateId=o.id,f.pushState(o.id,o.title,o.url),c.Adapter.trigger(e,"popstate")),!0},c.replaceState=function(t,a,r,n){if(c.getHashByUrl(r)&&c.emulated.pushState)throw Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(n!==!1&&c.busy())return c.pushQueue({scope:c,callback:c.replaceState,args:arguments,queue:n}),!1;c.busy(!0);var o=c.createStateObject(t,a,r);return c.isLastSavedState(o)?c.busy(!1):(c.storeState(o),c.expectedStateId=o.id,f.replaceState(o.id,o.title,o.url),c.Adapter.trigger(e,"popstate")),!0};if(o){try{c.store=u.parse(o.getItem("History.store"))||{}}catch(m){c.store={}}c.normalizeStore()}else c.store={},c.normalizeStore();c.Adapter.bind(e,"unload",c.clearAllIntervals),c.saveState(c.storeState(c.extractState(c.getLocationHref(),!0))),o&&(c.onUnload=function(){var e,t,a;try{e=u.parse(o.getItem("History.store"))||{}}catch(r){e={}}e.idToState=e.idToState||{},e.urlToId=e.urlToId||{},e.stateToId=e.stateToId||{};for(t in c.idToState)c.idToState.hasOwnProperty(t)&&(e.idToState[t]=c.idToState[t]);for(t in c.urlToId)c.urlToId.hasOwnProperty(t)&&(e.urlToId[t]=c.urlToId[t]);for(t in c.stateToId)c.stateToId.hasOwnProperty(t)&&(e.stateToId[t]=c.stateToId[t]);c.store=e,c.normalizeStore(),a=u.stringify(e);try{o.setItem("History.store",a)}catch(n){if(n.code!==DOMException.QUOTA_EXCEEDED_ERR)throw n;o.length&&(o.removeItem("History.store"),o.setItem("History.store",a))}},c.intervalList.push(l(c.onUnload,c.options.storeInterval)),c.Adapter.bind(e,"beforeunload",c.onUnload),c.Adapter.bind(e,"unload",c.onUnload)),c.emulated.pushState||(c.bugs.safariPoll&&c.intervalList.push(l(c.safariStatePoll,c.options.safariPollInterval)),("Apple Computer, Inc."===n.vendor||"Mozilla"===(n.appCodeName||""))&&(c.Adapter.bind(e,"hashchange",function(){c.Adapter.trigger(e,"popstate")}),c.getHash()&&c.Adapter.onDomLoad(function(){c.Adapter.trigger(e,"hashchange")})))},c.options&&c.options.delayInit||c.init()}(window);