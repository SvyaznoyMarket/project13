(function(window){function emptyFunction(){}function parseURL(e,t,r){var n=/(?:([\w0-9]+:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/;if(e&&!t){var i=parseURL(),s=i._pathname,o=i._protocol;e=/^(?:[\w0-9]+\:)?\/\//.test(e)?0===e.indexOf("/")?o+e:e:o+"//"+i._host+(0===e.indexOf("/")?e:0===e.indexOf("?")?s+e:0===e.indexOf("#")?s+i._search+e:s.replace(/[^\/]+$/g,"")+e)}else e=t?e:windowLocation.href,(!isSupportHistoryAPI||r)&&(e=e.replace(/^[^#]*/,"")||"#",e=windowLocation.protocol+"//"+windowLocation.host+settings.basepath+e.replace(RegExp("^#[/]?(?:"+settings.type+")?"),""));anchorElement.href=e;var a=n.exec(anchorElement.href),c=a[2]+(a[3]?":"+a[3]:""),l=a[4]||"/",u=a[5]||"",d="#"===a[6]?"":a[6]||"",p=l+u+d,h=l.replace(RegExp("^"+settings.basepath,"i"),settings.type)+u;return{_href:a[1]+"//"+c+p,_protocol:a[1],_host:c,_hostname:a[2],_port:a[3]||"",_pathname:l,_search:u,_hash:d,_relative:p,_nohash:h,_special:h+d}}function storageInitialize(){var e="";if(sessionStorage)e+=sessionStorage.getItem(sessionStorageKey);else{var t=document.cookie.split(sessionStorageKey+"=");t.length>1&&(e+=t.pop().split(";").shift()||"null")}try{stateStorage=JSON.parse(e)||{}}catch(r){stateStorage={}}addEvent(eventNamePrefix+"unload",function(){if(sessionStorage)sessionStorage.setItem(sessionStorageKey,JSON.stringify(stateStorage));else{var e={};(e[windowLocation.href]=historyObject.state)&&(document.cookie=sessionStorageKey+"="+JSON.stringify(e))}},!1)}function redefineProperty(e,t,r,n){r=r||{set:emptyFunction};var i=!r.set,s=!r.get,o={configurable:!0,set:function(){i=1},get:function(){s=1}};try{defineProperty(e,t,o),e[t]=e[t],defineProperty(e,t,r)}catch(a){}if(!i||!s)if(e.__defineGetter__&&(e.__defineGetter__(t,o.get),e.__defineSetter__(t,o.set),e[t]=e[t],r.get&&e.__defineGetter__(t,r.get),r.set&&e.__defineSetter__(t,r.set)),i&&s||e!==window){if(!i||!s)try{try{var c=Object.create(e);defineProperty(Object.getPrototypeOf(c)===e?c:e,t,r);for(var l in e)"function"==typeof e[l]&&(c[l]=e[l].bind(e));try{n.call(c,c,e)}catch(a){}e=c}catch(a){defineProperty(e.constructor.prototype,t,r)}}catch(a){return!1}}else{try{var u=e[t];e[t]=null}catch(a){}if("execScript"in window)window.execScript("Public "+t,"VBScript");else try{defineProperty(e,t,{value:emptyFunction})}catch(a){}e[t]=u}return e}function prepareDescriptorsForObject(e,t,r){return r=r||{},e=e===locationDescriptors?windowLocation:e,r.set=r.set||function(r){e[t]=r},r.get=r.get||function(){return e[t]},r}function addEventListener(e,t,r){e in eventsList?eventsList[e].push(t):arguments.length>3?addEvent(e,t,r,arguments[3]):addEvent(e,t,r)}function removeEventListener(e,t,r){var n=eventsList[e];if(n){for(var i=n.length;--i;)if(n[i]===t){n.splice(i,1);break}}else removeEvent(e,t,r)}function dispatchEvent(e,t){var r=(""+("string"==typeof e?e:e.type)).replace(/^on/,""),n=eventsList[r];if(n){if(t="string"==typeof e?t:e,null==t.target)for(var i=["target","currentTarget","srcElement","type"];e=i.pop();)t=redefineProperty(t,e,{get:"type"===e?function(){return r}:function(){return window}});(("popstate"===r?window.onpopstate:window.onhashchange)||emptyFunction).call(window,t);for(var s=0,o=n.length;o>s;s++)n[s].call(window,t);return!0}return dispatch(e,t)}function firePopState(){var e=document.createEvent?document.createEvent("Event"):document.createEventObject();e.initEvent?e.initEvent("popstate",!1,!1):e.type="popstate",e.state=historyObject.state,dispatchEvent(e)}function fireInitialState(){isFireInitialState&&(isFireInitialState=!1,firePopState())}function changeState(e,t,r,n){if(!isSupportHistoryAPI){var i=parseURL(t);i._relative!==parseURL()._relative&&(lastURL=n,r?windowLocation.replace("#"+i._special):windowLocation.hash=i._special)}!isSupportStateObjectInHistory&&e&&(stateStorage[windowLocation.href]=e),isFireInitialState=!1}function onHashChange(e){if(lastURL){checkUrlForPopState!==windowLocation.href&&firePopState(),e=e||window.event;var t=parseURL(lastURL,!0),r=parseURL();e.oldURL||(e.oldURL=t._href,e.newURL=r._href),t._hash!==r._hash&&dispatchEvent(e)}lastURL=windowLocation.href}function onLoad(e){setTimeout(function(){addEvent("popstate",function(e){checkUrlForPopState=windowLocation.href,isSupportStateObjectInHistory||(e=redefineProperty(e,"state",{get:function(){return historyObject.state}})),dispatchEvent(e)},!1)},0),!isSupportHistoryAPI&&e!==!0&&historyObject.location&&(scrollToAnchorId(historyObject.location.hash),fireInitialState())}function onAnchorClick(e){var t=e||window.event,r=t.target||t.srcElement,n="defaultPrevented"in t?t.defaultPrevented:t.returnValue===!1;if(r&&"A"===r.nodeName&&!n){var i=parseURL(),s=parseURL(r.getAttribute("href",2)),o=i._href.split("#").shift()===s._href.split("#").shift();o&&s._hash&&(i._hash!==s._hash&&(historyObject.location.hash=s._hash),scrollToAnchorId(s._hash),t.preventDefault?t.preventDefault():t.returnValue=!1)}}function scrollToAnchorId(e){var t=document.getElementById(e=(e||"").replace(/^#/,""));if(t&&t.id===e&&"A"===t.nodeName){var r=t.getBoundingClientRect();window.scrollTo(documentElement.scrollLeft||0,r.top+(documentElement.scrollTop||0)-(documentElement.clientTop||0))}}function initialize(){var e=document.getElementsByTagName("script"),t=(e[e.length-1]||{}).src||"",r=-1!==t.indexOf("?")?t.split("?").pop():"";r.replace(/(\w+)(?:=([^&]*))?/g,function(e,t,r){settings[t]=(r||("basepath"===t?"/":"")).replace(/^(0|false)$/,"")});try{sessionStorage=window.sessionStorage}catch(n){}ie6DriverStart(),addEvent(eventNamePrefix+"hashchange",onHashChange,!1);var i=[locationDescriptors,locationObject,eventsDescriptors,window,historyDescriptors,historyObject];isSupportStateObjectInHistory&&delete historyDescriptors.state;for(var s=0;i.length>s;s+=2)for(var o in i[s])if(i[s].hasOwnProperty(o))if("function"==typeof i[s][o])i[s+1][o]=i[s][o];else{var a=prepareDescriptorsForObject(i[s],o,i[s][o]);if(!redefineProperty(i[s+1],o,a,function(e,t){t===historyObject&&(window.history=historyObject=i[s+1]=e)}))return removeEvent(eventNamePrefix+"hashchange",onHashChange,!1),!1;i[s+1]===window&&(eventsList[o]=eventsList[o.substr(2)]=[])}return settings.redirect&&historyObject.redirect(),!isSupportStateObjectInHistory&&JSON&&storageInitialize(),isSupportHistoryAPI||document[addEventListenerName](eventNamePrefix+"click",onAnchorClick,!1),"complete"===document.readyState?onLoad(!0):(isSupportHistoryAPI||parseURL()._relative===settings.basepath||(isFireInitialState=!0),addEvent(eventNamePrefix+"load",onLoad,!1)),!0}function ie6DriverStart(){function createVBObjects(e){var t=[],r="VBHistoryClass"+(new Date).getTime()+msie++,n=["Class "+r];for(var i in e)if(e.hasOwnProperty(i)){var s=e[i];s&&(s.get||s.set)?(s.get&&n.push("Public "+("_"===i?"Default ":"")+"Property Get ["+i+"]","Call VBCVal([(accessors)].["+i+"].get.call(me),["+i+"])","End Property"),s.set&&n.push("Public Property Let ["+i+"](val)",s="Call [(accessors)].["+i+"].set.call(me,val)\nEnd Property","Public Property Set ["+i+"](val)",s)):(t.push(i),n.push("Public ["+i+"]"))}n.push("Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+r+"FactoryJS()","End Sub","End Class","Function "+r+"Factory()","Set "+r+"Factory=New "+r,"End Function"),window.execScript(n.join("\n"),"VBScript"),window[r+"FactoryJS"]=function(){return e};for(var o=window[r+"Factory"](),a=0;t.length>a;a++)o[t[a]]=e[t[a]];return o}function quote(e){var t=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,r={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return t.test(e)?'"'+e.replace(t,function(e){return e in r?r[e]:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}var msie=window.eval&&eval("/*@cc_on 1;@*/");if(msie&&!(+(/msie (\d+)/i.exec(navigator.userAgent)||[,8])[1]>7)){var originalChangeState=changeState,originalRedefineProperty=redefineProperty,currentHref=parseURL()._href,iFrame=document.createElement("iframe");iFrame.src="javascript:true;",iFrame=documentElement.firstChild.appendChild(iFrame).contentWindow,window.execScript("Public history\nFunction VBCVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript"),locationObject={_:{get:locationDescriptors.toString}},historyObject={back:windowHistory.back,forward:windowHistory.forward,go:windowHistory.go,emulate:null,_:{get:function(){return"[object History]"}}},JSON={parse:function(e){try{return Function("","return "+e)()}catch(t){return null}},stringify:function(e){var t=(typeof e).charCodeAt(2);return 114===t?quote(e):109===t?isFinite(e)?e+"":"null":111===t||108===t?e+"":106===t?e?function(t){var r=t?"[":"{";if(t)for(var n=0;e.length>n;n++)r+=(0==n?"":",")+JSON.stringify(e[n]);else for(var i in e)e.hasOwnProperty(i)&&(r+=(1==r.length?"":",")+quote(i)+":"+JSON.stringify(e[i]));return r+(t?"]":"}")}("[object Array]"===Object.prototype.toString.call(e)):"null":"void 0"}},changeState=function(e,t,r,n,i){var s=iFrame.document,o=parseURL(t);return isFireInitialState=!1,o._relative!==parseURL()._relative||i?(lastURL=n,r?iFrame.lfirst?(history.back(),changeState(e,o._href,0,n,1)):windowLocation.replace("#"+o._special):(o._href!=currentHref||i)&&(iFrame.lfirst||(iFrame.lfirst=1,changeState(e,currentHref,0,n,1)),s.open(),s.write('<script>lfirst=1;parent.location.hash="'+o._special.replace(/"/g,'\\"')+'";</script>'),s.close()),!i&&e&&(stateStorage[windowLocation.href]=e),void 0):(e&&(stateStorage[windowLocation.href]=e),void 0)},redefineProperty=function(e,t,r){return originalRedefineProperty.apply(this,arguments)||(e===locationObject?locationObject[t]=r:e===historyObject?(historyObject[t]=r,"state"===t&&(locationObject=createVBObjects(locationObject),window.history=historyObject=createVBObjects(historyObject))):e[t]=r.get&&r.get()),e};var interval=setInterval(function(){var e=parseURL()._href;if(e!=currentHref){var t=document.createEventObject();t.oldURL=currentHref,t.newURL=currentHref=e,t.type="hashchange",onHashChange(t)}},100);window.JSON=JSON}}if(window.history){var document=window.document,documentElement=document.documentElement,sessionStorage=null,Object=window.Object,JSON=window.JSON,windowLocation=window.location,windowHistory=window.history,historyObject=windowHistory,historyPushState=windowHistory.pushState,historyReplaceState=windowHistory.replaceState,isSupportHistoryAPI=!!historyPushState,isSupportStateObjectInHistory="state"in windowHistory,defineProperty=Object.defineProperty,locationObject=redefineProperty({},"t")?{}:document.createElement("a"),eventNamePrefix="",addEventListenerName=window.addEventListener?"addEventListener":(eventNamePrefix="on")&&"attachEvent",removeEventListenerName=window.removeEventListener?"removeEventListener":"detachEvent",dispatchEventName=window.dispatchEvent?"dispatchEvent":"fireEvent",addEvent=window[addEventListenerName],removeEvent=window[removeEventListenerName],dispatch=window[dispatchEventName],settings={basepath:"/",redirect:0,type:"/"},sessionStorageKey="__historyAPI__",anchorElement=document.createElement("a"),lastURL=windowLocation.href,checkUrlForPopState="",isFireInitialState=!1,stateStorage={},eventsList={},eventsDescriptors={onhashchange:null,onpopstate:null},fastFixChrome=function(e,t){var r=window.history!==windowHistory;r&&(window.history=windowHistory),e.apply(windowHistory,t),r&&(window.history=historyObject)},historyDescriptors={redirect:function(e,t){if(settings.basepath=t=null==t?settings.basepath:t,settings.type=e=null==e?settings.type:e,window.top==window.self){var r=parseURL(null,!1,!0)._relative,n=windowLocation.pathname+windowLocation.search;isSupportHistoryAPI?(n=n.replace(/([^\/])$/,"$1/"),r!=t&&RegExp("^"+t+"$","i").test(n)&&windowLocation.replace(r)):n!=t&&(n=n.replace(/([^\/])\?/,"$1/?"),RegExp("^"+t,"i").test(n)&&windowLocation.replace(t+"#"+n.replace(RegExp("^"+t,"i"),e)+windowLocation.hash))}},pushState:function(e,t,r){historyPushState&&fastFixChrome(historyPushState,arguments),changeState(e,r)},replaceState:function(e,t,r){delete stateStorage[windowLocation.href],historyReplaceState&&fastFixChrome(historyReplaceState,arguments),changeState(e,r,!0)},location:{set:function(e){window.location=e},get:function(){return isSupportHistoryAPI?windowLocation:locationObject}},state:{get:function(){return stateStorage[windowLocation.href]||null}}},locationDescriptors={assign:function(e){0===(""+e).indexOf("#")?changeState(null,e):windowLocation.assign(e)},reload:function(){windowLocation.reload()},replace:function(e){0===(""+e).indexOf("#")?changeState(null,e,!0):windowLocation.replace(e)},toString:function(){return this.href},href:{get:function(){return parseURL()._href}},protocol:null,host:null,hostname:null,port:null,pathname:{get:function(){return parseURL()._pathname}},search:{get:function(){return parseURL()._search}},hash:{set:function(e){changeState(null,(""+e).replace(/^(#|)/,"#"),!1,lastURL)},get:function(){return parseURL()._hash}}};initialize()&&(historyObject.emulate=!isSupportHistoryAPI,window[addEventListenerName]=addEventListener,window[removeEventListenerName]=removeEventListener,window[dispatchEventName]=dispatchEvent)}})(window);