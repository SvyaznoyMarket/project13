(function(e){console.info("New catalog history module");var n=(e.config.pageConfig,e.utils),o=n.extendApp("ENTER.catalog");o.history={gotoUrl:function(e){var n={title:"Enter - это выход!",url:e};return History.enabled?(console.info("link handler. push state new url: "+n.url),History.pushState(n,n.title,n.url),void 0):(document.location.href=e,void 0)}};var t=function t(){var e=$(this).attr("href");return o.history.gotoUrl(e),!1},a=function a(){console.info("resHandler")},i=function i(){var e=History.getState(),n=e.url;console.info("statechange"),n=n.addParameterToUrl("ajax","true"),console.log(n),console.log(e),$.ajax({type:"GET",url:n,success:a})};History.Adapter.bind(window,"statechange",i),$("body").on("click",".jsHistoryLink",t)})(window.ENTER),function(e){console.info("New catalog init: filter.js");var n=(e.config.pageConfig,e.utils),o=n.extendApp("ENTER.catalog"),t=$(".bFilter"),a=t.find(".bFilterToggle"),i=t.find(".bFilterCont"),l=t.find(".bFilterParams__eItem"),r=t.find(".bFilterValuesItem");o.filter={sendFilter:function(){var e=t.serialize(),n=t.attr("action");return n+="?"+e,console.log(n),console.log(e),o.history.gotoUrl(n),!1},updateFilter:function(){console.info("update filter")}};var s=function s(){var e="mOpen",n="mClose",o=a.hasClass(e);return o?(a.removeClass(e).addClass(n),i.slideUp(400)):(a.removeClass(n).addClass(e),i.slideDown(400)),!1},c=function c(){var e=$(this),n="mActive",o=e.hasClass(n),t=e.data("ref");return o?!1:(l.removeClass(n),e.addClass(n),r.fadeOut(300),r.promise().done(function(){$("#"+t).fadeIn(300)}),!1)},d=function d(){var e=$(this),n=e.find(".bFilterSlider"),o=n.data("config"),t=e.find(".mFromRange"),a=e.find(".mToRange"),i=o.min,l=o.max,r=o.step;n.slider({range:!0,step:r,min:i,max:l,values:[t.val(),a.val()],slide:function(e,n){t.val(n.values[0]),a.val(n.values[1])},change:function(){console.log("change slider")}});var s=function s(){var e="0"+$(this).val();e=parseInt(e,10),e=e>l?l:i>e?i:e,$(this).val(e),n.slider({values:[t.val(),a.val()]})};a.on("change",s),t.on("change",s)};a.on("click",s),l.on("click",c),t.on("submit",o.filter.sendFilter),$(".bRangeSlider").each(d)}(window.ENTER);