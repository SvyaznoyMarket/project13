!function(a){var b=a.utils,c=b.extendApp("ENTER.catalog"),d=$("#bCatalog").data("lastpage");c.enableHistoryAPI="object"==typeof Mustache&&History.enabled,c.listingWrap=$(".bListing"),c.liveScroll=!1,c.lastPage=null,d&&(c.lastPage=d),$(".bGoodsSlider").goodsSlider({onLoad:function(b){ko.applyBindings(a.UserModel,b)}})}(window.ENTER),function(a){var b,c=$("body"),d=(a.config.pageConfig,a.utils),e=d.extendApp("ENTER.catalog"),f=$(".js-filter"),g=f.hasClass("js-filter-hasAlwaysShowFilters"),h=f.find(".js-filter-otherParamsToggleButton"),i=f.find(".js-filter-otherParamsContent"),j=f.find(".js-filter-rangeSlider"),k=f.find(".js-filter-param"),l=f.find(".js-filter-element"),m=$(".bSortingLine"),n="fltrSet_tggl-dn";e.filter={lastRes:null,getViewType:function(){var a=m.find(".mViewer .mSortItem");return a.filter(".mActive").data("type")},applyTemplate:{list:function(a){e.listingWrap.empty(),e.listingWrap.html(a)},selectedFilter:function(a){var b=f.find(".bFilterFoot");b.empty(),b.html(a)},sorting:function(a){var b=m.find(".bSortingList.mSorting");b.empty(),b.html(a)},pagination:function(a){var b=$(".bSortingList.mPager");b.empty(),b.html(a)},page:function(a){var b=$(".bTitlePage");b.empty(),b.html(a)},countProducts:function(a){var b=$(".bBtnPick__eLink",".bFilter"),c=a?parseInt(a):-1;c>=0&&b.length&&b.text("Подобрать ("+a+")")}},render:{list:function(a){var b,c="undefined"!=typeof e.filter.getViewType()?e.filter.getViewType():"default",d={compact:$("#listing_compact_tmpl"),expanded:$("#listing_compact_tmpl"),"default":$("#listing_compact_tmpl")},f=d[c].html(),g=d[c].data("partial");return b=Mustache.render(f,a,g)},selectedFilter:function(a){if(a){var b,c=$("#tplSelectedFilter"),d=c.html(),f=c.data("partial");return b=Mustache.render(d,a,f),a.hasOwnProperty("values")&&e.filter.updateFilter(a.values),b}},sorting:function(a){var b,c=$("script.tplSorting:first"),d=c.html(),e=c.data("partial");return b=Mustache.render(d,a,e)},pagination:function(a){var b,c=$("script.tplPagination:first"),d=c.html(),e=c.data("partial");return b=Mustache.render(d,a,e)},page:function(a){var b=a.title;return b},countProducts:function(a){return a}},renderCatalogPage:function(a){var b,c,d=a?a:e.filter.lastRes,f=a.pagination?a.pagination.lastPage:!1;e.filter.resetForm();for(b in d)e.filter.render.hasOwnProperty(b)&&(c=e.filter.render[b](d[b])),e.filter.applyTemplate.hasOwnProperty(b)&&e.filter.applyTemplate[b](c);f&&(e.lastPage=f),e.filter.lastRes=d,e.infScroll.checkInfinity()},getSlidersInputState:function(){var a={changedSliders:[],unchangedSliders:[]},b=function(){var b=$(this),c=b.find(".bFilterSlider"),d=c.data("config"),e=b.find(".mFromRange"),f=b.find(".mToRange"),g=d.min,h=d.max;1*e.val()===g?a.unchangedSliders.push(e.attr("name")):a.changedSliders.push(e.attr("name")),1*f.val()===h?a.unchangedSliders.push(f.attr("name")):a.changedSliders.push(f.attr("name"))};return j.each(b),a},getFilterUrl:function(){for(var a,b=f.serializeArray(),c=f.attr("action")||"",d=e.filter.getSlidersInputState(),g=m.find(".mSortItem.mActive").find(".jsSorting"),h=g.data("sort"),i=e.filter.getUrlParams(),j=!1,k=b.length-1;k>=0;k--)-1!==d.unchangedSliders.indexOf(b[k].name)&&b.splice(k,1);return i&&i.category&&($.each(b,function(){"category"==this.name&&(j=!0)}),j||b.unshift({name:"category",value:i.category})),a=$.param(b),0!==a.length&&(c+=-1===c.indexOf("?")?"?"+a:"&"+a),c=c.addParameterToUrl("sort",h)},getUrlParams:function(){var a,b,c={},d=window.location.search.substring(1).split("&");for(b=0;b<d.length;b++)a=d[b].split("="),c[a[0]]="undefined"==typeof a[1]?"":a[1];return c},changeFilterHandler:function(a,c){var d=function(){f.trigger("submit")};("object"!=typeof a||!a.isTrigger||c)&&(clearTimeout(b),b=setTimeout(d,300))},sendFilter:function(a){var b=e.filter.getFilterUrl();return b!==document.location.pathname+document.location.search&&(e.enableHistoryAPI||(b=b.replace(/\#.*$|$/,"#productCatalog-filter-form")),e.history.gotoUrl(b)),a.isTrigger||"object"==typeof a&&e.enableHistoryAPI&&$.scrollTo(f.find(".bFilterFoot"),500),!1},resetForm:function(){var a=function(a,b){var c=$(b),d=c.attr("id"),e=f.find('label[for="'+d+'"]');c.removeAttr("checked"),e.removeClass("mChecked")},b=function(a,b){$(b).removeAttr("checked").trigger("change")},c=function(){var a=$(this),b=a.find(".bFilterSlider"),c=b.data("config"),d=a.find(".mFromRange"),e=a.find(".mToRange"),f=c.min,g=c.max;d.val(f).trigger("change"),e.val(g).trigger("change")};f.find(":input:radio:checked").each(a),f.find(":input:checkbox:checked").each(b),j.each(c)},updateFilter:function(a){var b,c,d,e,g={text:function(a,b){a.val(b).trigger("change")},radio:function(a,b){var c=a.filter('[value="'+b+'"]'),d=c.attr("id"),e=f.find('label[for="'+d+'"]');c.attr("checked","checked"),e.addClass("mChecked")},checkbox:function(a,b){a.filter('[value="'+b+'"]').attr("checked","checked").trigger("change")}};for(e in a){if(!a.hasOwnProperty(e))return;b=f.find('input[name="'+e+'"]'),c=a[e],d=b.attr("type"),g.hasOwnProperty(d)&&g[d](b,c)}},openFilter:function(){q(!0),$(".js-filter-toggle-container",f).each(function(){$(".js-filter-toggle-button",this).addClass(n),$(".js-filter-toggle-content",this).slideDown(400)})}};var o=function(){var a=$(this),b=a.find(".bFilterSlider"),c=b.data("config"),d=a.find(".mFromRange"),e=a.find(".mToRange"),f=c.min,g=c.max,h=c.step;b.slider({range:!0,step:h,min:f,max:g,values:[d.val(),e.val()],slide:function(a,b){d.val(b.values[0]),e.val(b.values[1])},change:function(a){a.originalEvent&&(d.trigger("change",[!0]),e.trigger("change",[!0]))}});var i=function(){var a="0"+$(this).val();a=parseFloat(a),a=a>g?g:f>a?f:a,$(this).val(a),b.slider({values:[d.val(),e.val()]})};e.on("change",i),d.on("change",i)},p=function(){var a=$(this),b=a.attr("href");return e.history.gotoUrl(b),!1},q=function(a){var b=h.hasClass(n);return b&&"boolean"!=typeof a?(h.removeClass(n),h.parent().removeClass("bFilterHead-open"),i.slideUp(400)):(h.addClass(n),h.parent().addClass("bFilterHead-open"),i.slideDown(400)),!1},r=function(a){var b=$(this),c=$(a.currentTarget),d=($(".js-filter-toggle-container"),$(".js-filter-toggle-content",c.closest(".js-filter-toggle-container")));return c.hasClass(n)?(c.removeClass(n),d.slideUp(400),b.parent(".js-filter-toggle-container").addClass("fltrSet-close")):(c.addClass(n),d.slideDown(400),b.parent(".js-filter-toggle-container").removeClass("fltrSet-close")),!1},s=function(){var a=$(this),b=a.attr("href"),c="mActive",d=a.parent(),g=d.hasClass(c);return g?!1:(e.history.gotoUrl(b),f.length&&$.scrollTo(f,500),!1)},t=function(){var a=$(this),b="mActive",c=a.hasClass(b),d=a.data("ref");return c?!1:(k.removeClass(b),a.addClass(b),l.fadeOut(300),l.promise().done(function(){$("#"+d).fadeIn(300)}),g||$.scrollTo(f,500),!1)},u=function(){var a=$(this),b=a.attr("href"),c="mActive",d=a.parent(),f=m.find(".mViewer .mSortItem"),g=d.hasClass(c);return g?!1:(f.removeClass(c),d.addClass(c),e.filter.lastRes?e.history.updateUrl(b):e.history.gotoUrl(b),!1)},v=function(){var a=$(this),b=a.attr("href"),c="mActive",d=a.parent(),f=m.find(".mSorting .mSortItem"),g=d.hasClass(c);return g?!1:(f.removeClass(c),d.addClass(c),e.history.gotoUrl(b),!1)};f.on("click",".js-filter-toggle-button",r),h.on("click",q),k.on("click",t),$("input, select, textarea",f).on("change",e.filter.changeFilterHandler),f.on("submit",e.filter.sendFilter),m.on("click",".jsSorting",v),m.on("click",".jsChangeView",u),m.on("click",".jsPagination",s),c.on("click",".jsHistoryLink",p),j.each(o)}(window.ENTER),function(a){var b=a.utils,c=b.extendApp("ENTER.catalog");c.history={_defaultCallback:c.filter.renderCatalogPage,_customCallback:null,gotoUrl:function(a,b,d){var e={title:document.title,url:a,data:{_onlychange:d?!0:!1}};return c.enableHistoryAPI?(c.history._customCallback=b?b:null,void History.pushState(e,e.title,e.url)):void(document.location.href=a)},updateUrl:function(a,b){var d=b?b:null;c.history.gotoUrl(a,d,!0)},getDataFromServer:function(a,b){c.loader&&c.loader.loading();var d=function(){c.loader&&c.loader.complete()},e=function(a){"object"==typeof a&&b(a),c.loader&&c.loader.complete()};$.ajax({type:"GET",url:a,success:e,statusCode:{500:d,503:d},error:d})}};var d=function(){var a=History.getState(),b=a.url,d=a.data.data,e="function"==typeof c.history._customCallback?c.history._customCallback:c.history._defaultCallback;d._onlychange?e():(b=b.addParameterToUrl("ajax","true"),c.history.getDataFromServer(b,e)),c.history._customCallback=null};History.Adapter.bind(window,"statechange",d)}(window.ENTER),function(a){var b=a.utils,c=b.extendApp("ENTER.catalog"),d=$(".bSortingLine"),e=$(".jsInfinityEnable").last();c.infScroll={loading:!1,nowPage:1,checkInfinity:function(){"1"===window.docCookies.getItem("infScroll")&&c.infScroll.enable()},checkScroll:function(){$(window),$(document);!c.infScroll.loading&&e.visible()&&(c.lastPage-c.infScroll.nowPage>0||null===c.lastPage)&&(c.infScroll.nowPage+=1,c.infScroll.load())},load:function(){var a=c.filter.getFilterUrl(),b=function(a){var b;b=c.filter.render.list(a.list),c.infScroll.loading=!1,c.listingWrap.append(b)};c.liveScroll=!0,c.infScroll.loading=!0,a=a.addParameterToUrl("page",c.infScroll.nowPage),a=a.addParameterToUrl("ajax","true"),c.history.getDataFromServer(a,b)},enable:function(){var a="mActive",b=d.find(".mInfinity"),f=d.find(".mPaging"),g=d.find(".bSortingList__eItem.mPage"),h=c.filter.getFilterUrl(),i=document.location.search.match("page=");f.show(),g.hide(),b.addClass(a),c.infScroll.nowPage=1,c.infScroll.loading=!1,window.docCookies.setItem("infScroll",1,2419200,"/"),c.infScroll.checkScroll(),$(window).on("scroll",c.infScroll.checkScroll),c.enableHistoryAPI&&i&&c.history.gotoUrl(h),e=$(".jsInfinityEnable").last(),e.visible()&&c.lastPage>1&&(c.infScroll.nowPage+=1,this.load())},disable:function(){var a=c.filter.getFilterUrl();c.liveScroll=!1,a=a.addParameterToUrl("ajax","true"),window.docCookies.setItem("infScroll",0,2419200,"/"),$(window).off("scroll",c.infScroll.checkScroll),c.history.getDataFromServer(a,c.filter.renderCatalogPage)}};var f=function(){var a="mActive",b=d.find(".mInfinity"),e=b.hasClass(a);return e?!1:(c.infScroll.enable(),!1)},g=function(){var a="mActive",b=d.find(".mInfinity"),e=b.hasClass(a);return e&&c.infScroll.disable(),!1};c.infScroll.checkInfinity(),d.on("click",".jsPaginationEnable",g),d.on("click",".jsInfinityEnable",f)}(window.ENTER),function(a){var b=(a.config.pageConfig,a.utils),c=b.extendApp("ENTER.catalog"),d=$(".bBtnPick__eLink",".bFilter");c.loader={_loader:null,loading:function(){c.loader._loader||(c.loader._loader=$("<li>").addClass("mLoader"),d.addClass("mButLoader").text("Подобрать"),c.liveScroll?c.listingWrap.append(c.loader._loader):(c.listingWrap.empty(),c.listingWrap.append(c.loader._loader)))},complete:function(){c.loader._loader&&(c.loader._loader.remove(),c.loader._loader=null),d.removeClass("mButLoader"),$("body").trigger("catalogLoadingComplete")}}}(window.ENTER),function(){var a=$(".jsChangePackageSet"),b=$(".jsPackageSetPopup"),c=function(){b.lightbox_me({autofocus:!0})};a.on("click",c)}(window.ENTER),$(function(){$(".spk-good-rating").length&&($.getScript("//static.sprosikupi.ru/js/widget/sprosikupi.bootstrap.js"),$("body").on("catalogLoadingComplete",function(){spkLoadRatings()}))}),$(function(){$(".shoppilot-category-container").length&&(_shoppilot=window._shoppilot||[],_shoppilot.push(["_setStoreId","535a852cec8d830a890000a6"]),_shoppilot.push(["_setOnReady",function(a){function b(){$(".shoppilot-category-container").each(function(){var b=$(this);new a.ProductWidget({name:"category-product-rating",styles:"product-reviews",product_id:b.data("productId")}).appendTo(b[0])})}b(),$("body").on("catalogLoadingComplete",b)}]),function(){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src="//ugc.shoppilot.ru/javascripts/require.js",a.setAttribute("data-main","//ugc.shoppilot.ru/javascripts/social-apps.js");var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}())}),$(function(){function a(){var a=$("#root_page_selected_brands_tmpl");d.html(Mustache.render(a.html(),{brandsCount:e.length,selectedBrandsCount:e.filter("."+b).length},a.data("partial")))}var b="active",c="opened",d=$(".js-productCategory-rootPage-brands-selectedBrandsWrapper"),e=$(".js-productCategory-rootPage-brands-link");e.click(function(c){c.preventDefault();var d=$(c.currentTarget),e=document.location.href,f=c.currentTarget.href.replace(/^.*?\?([^#]+)(\#.*)?$/,"$1"),g=decodeURIComponent(f.replace(/^(.*?)\=.*$/,"$1")),h=decodeURIComponent(f.replace(/^.*?\=(.*)$/,"$1"));d.hasClass(b)?(d.removeClass(b),e=ENTER.utils.setURLParam(g,null,e)):(d.addClass(b),e=ENTER.utils.setURLParam(g,h,e)),history.pushState({},document.title,e),a(),$.ajax({url:e,type:"GET",success:function(a){var b=$("#root_page_links_tmpl"),c=$(".js-productCategory-rootPage-linksWrapper");c.html(Mustache.render(b.html(),{links:a.links,category:a.category},b.data("partial")))}})}),$(".js-productCategory-rootPage-brands-else, .js-productCategory-rootPage-brands-title").click(function(a){a.preventDefault();var b=$(".js-productCategory-rootPage-brands-other"),d=$(".js-productCategory-rootPage-brands-else"),e=$(".js-productCategory-rootPage-brands-title");b.toggle(),"none"==b.css("display")?(d.show(),e.removeClass(c)):(d.hide(),e.addClass(c))}),d.on("click",".js-productCategory-rootPage-selectedBrands-clear",function(c){c.preventDefault(),e.removeClass(b),history.pushState({},document.title,"?"),a()})}),function(a){var b=a(".js-seo-list");b.find(".js-seo-list-item:lt(11)").css({display:"inline-block"}),b.each(function(){a(this).children(".js-seo-list-item").length>11&&a(this).append('<li class="bPopularSection_more js-seo-list-item-more">Показать ещё</li>')});var c=function(){var b=a(this).text();a(this).parent().children().toggleClass("seotext-show"),a(this).text(" Скрыть "==b?" Показать ещё ":" Скрыть ")};b.find(".js-seo-list-item-more").on("click",c)}(jQuery),$(document).ready(function(){function a(a,b){var c=window[window.GoogleAnalyticsObject],d=window._gaq,e=window.location.href;c&&c("send","event",a,e,b),d&&d.push(["_trackEvent",a,e,b])}var b=$(".jsDataSmartChoice"),c=$(".specialPriceItem"),d=b.attr("data-smartchoice");"undefined"!=typeof b.data("smartchoice")&&$.getJSON("/ajax/product-smartchoice",{"products[]":b.data("smartchoice")},function(a){if(a.success){$.each(a.result,function(a,b){$slider=$.parseHTML(b.content),$($slider).hide(),$(".specialBorderBox").append($slider),$(".smartChoiceSliderToggle-"+a).show()});var b=$(".bGoodsSlider");b.goodsSlider(),b.each(function(){ko.applyBindings(ENTER.UserModel,this)})}}),$(".jsSmartChoiceSliderToggle a").click(function(a){a.preventDefault();var b=$(a.target),c=b.closest("div").data("smartchoice"),d=b.closest("a"),e=$(".specialPriceItemFoot_link");d.hasClass("mActive")?(e.removeClass("mActive"),$(".smartChoiceId-"+c).parent().hide(),$(".specialBorderBox").removeClass("specialBorderBox_render")):(e.removeClass("mActive"),d.addClass("mActive"),$(".bGoodsSlider").hide(),$(".specialBorderBox").addClass("specialBorderBox_render"),$(".smartChoiceId-"+c).parent().show())}),"undefined"!=typeof d&&d!==!1?c.addClass("specialPriceItem_minHeight"):c.removeClass("specialPriceItem_minHeight"),c.on("click",".specialPriceItemCont_imgLink, .specialPriceItemCont_name",function(){var b=$(this).data("article");a("SmartChoice_click",b)}),b.on("click",".productImg, .productName a",function(b){var c=$(b.target).closest(".bSlider__eItem").data("product").article;a("SmartChoice_similar_click",c)});var e=$(".js-specialPrice");e.length&&ko.applyBindings(ENTER.UserModel,e[0])});