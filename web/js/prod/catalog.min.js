!function(a){var b=a.utils,c=b.extendApp("ENTER.catalog"),d=$("#bCatalog").data("lastpage");c.enableHistoryAPI="object"==typeof Mustache&&History.enabled,c.listingWrap=$(".bListing"),c.liveScroll=!1,c.lastPage=null,d&&(c.lastPage=d)}(window.ENTER),function(a){var b,c=$("body"),d=(a.config.pageConfig,a.utils),e=d.extendApp("ENTER.catalog"),f=$(".bFilter"),g=(f.find(".bBtnPick__eLink"),f.find(".bFilterToggle")),h=f.find(".bFilterCont"),i=f.find(".bRangeSlider"),j=f.find(".bFilterParams__eItem"),k=f.find(".bFilterValuesItem"),l=$(".bSortingLine");e.filter={lastRes:null,getViewType:function(){var a=l.find(".mViewer .mSortItem");return a.filter(".mActive").data("type")},applyTemplate:{list:function(a){e.listingWrap.empty(),e.listingWrap.html(a)},selectedFilter:function(a){var b=f.find(".bFilterFoot");b.empty(),b.html(a)},sorting:function(a){var b=l.find(".bSortingList.mSorting");b.empty(),b.html(a)},pagination:function(a){var b=$(".bSortingList.mPager");b.empty(),b.html(a)},page:function(a){var b=$(".bTitlePage");b.empty(),b.html(a)},countProducts:function(a){var b=$(".bBtnPick__eLink",".bFilter"),c=a?parseInt(a):-1;c>=0&&b.length&&b.text("Подобрать ("+a+")")}},render:{list:function(a){var b,c="undefined"!=typeof e.filter.getViewType()?e.filter.getViewType():"default",d={compact:$("#listing_compact_tmpl"),expanded:$("#listing_compact_tmpl"),"default":$("#listing_compact_tmpl")},f=d[c].html(),g=d[c].data("partial");return b=Mustache.render(f,a,g)},selectedFilter:function(a){if(a){var b,c=$("#tplSelectedFilter"),d=c.html(),f=c.data("partial");return b=Mustache.render(d,a,f),a.hasOwnProperty("values")&&e.filter.updateFilter(a.values),b}},sorting:function(a){var b,c=$("script.tplSorting:first"),d=c.html(),e=c.data("partial");return b=Mustache.render(d,a,e)},pagination:function(a){var b,c=$("script.tplPagination:first"),d=c.html(),e=c.data("partial");return b=Mustache.render(d,a,e)},page:function(a){var b=a.title;return b},countProducts:function(a){return a}},renderCatalogPage:function(a){var b,c,d=a?a:e.filter.lastRes,f=a.pagination?a.pagination.lastPage:!1;e.filter.resetForm();for(b in d)e.filter.render.hasOwnProperty(b)&&(c=e.filter.render[b](d[b])),e.filter.applyTemplate.hasOwnProperty(b)&&e.filter.applyTemplate[b](c);e.infScroll.checkInfinity(),f&&(e.lastPage=f),e.filter.lastRes=d},getSlidersInputState:function(){var a={changedSliders:[],unchangedSliders:[]},b=function(){var b=$(this),c=b.find(".bFilterSlider"),d=c.data("config"),e=b.find(".mFromRange"),f=b.find(".mToRange"),g=d.min,h=d.max;1*e.val()===g?a.unchangedSliders.push(e.attr("name")):a.changedSliders.push(e.attr("name")),1*f.val()===h?a.unchangedSliders.push(f.attr("name")):a.changedSliders.push(f.attr("name"))};return i.each(b),a},getFilterUrl:function(){for(var a,b=f.serializeArray(),c=f.attr("action")||"",d=e.filter.getSlidersInputState(),g=l.find(".mSortItem.mActive").find(".jsSorting"),h=g.data("sort"),i=e.filter.getUrlParams(),j=!1,k=b.length-1;k>=0;k--)-1!==d.unchangedSliders.indexOf(b[k].name)&&b.splice(k,1);return i&&i.category&&($.each(b,function(){"category"==this.name&&(j=!0)}),j||b.unshift({name:"category",value:i.category})),a=$.param(b),0!==a.length&&(c+=-1===c.indexOf("?")?"?"+a:"&"+a),c=c.addParameterToUrl("sort",h)},getUrlParams:function(){var a,b,c={},d=window.location.search.substring(1).split("&");for(b=0;b<d.length;b++)a=d[b].split("="),c[a[0]]="undefined"==typeof a[1]?"":a[1];return c},changeFilterHandler:function(a,c){var d=function(){f.trigger("submit")};("object"!=typeof a||!a.isTrigger||c)&&e.enableHistoryAPI&&(clearTimeout(b),b=setTimeout(d,300))},sendFilter:function(a){var b=e.filter.getFilterUrl();return b!==document.location.pathname+document.location.search&&e.history.gotoUrl(b),a.isTrigger||"object"==typeof a&&e.enableHistoryAPI&&$.scrollTo(f.find(".bFilterFoot"),500),!1},resetForm:function(){var a=function(a,b){var c=$(b),d=c.attr("id"),e=f.find('label[for="'+d+'"]');c.removeAttr("checked"),e.removeClass("mChecked")},b=function(a,b){$(b).removeAttr("checked").trigger("change")},c=function(){var a=$(this),b=a.find(".bFilterSlider"),c=b.data("config"),d=a.find(".mFromRange"),e=a.find(".mToRange"),f=c.min,g=c.max;d.val(f).trigger("change"),e.val(g).trigger("change")};f.find(":input:radio:checked").each(a),f.find(":input:checkbox:checked").each(b),i.each(c)},updateFilter:function(a){var b,c,d,e,g={text:function(a,b){a.val(b).trigger("change")},radio:function(a,b){var c=a.filter('[value="'+b+'"]'),d=c.attr("id"),e=f.find('label[for="'+d+'"]');c.attr("checked","checked"),e.addClass("mChecked")},checkbox:function(a,b){a.filter('[value="'+b+'"]').attr("checked","checked").trigger("change")}};for(e in a){if(!a.hasOwnProperty(e))return;b=f.find('input[name="'+e+'"]'),c=a[e],d=b.attr("type"),g.hasOwnProperty(d)&&g[d](b,c)}},openFilter:function(){o(!0)}};var m=function(){var a=$(this),b=a.find(".bFilterSlider"),c=b.data("config"),d=a.find(".mFromRange"),e=a.find(".mToRange"),g=c.min,h=c.max,i=c.step;b.slider({range:!0,step:i,min:g,max:h,values:[d.val(),e.val()],slide:function(a,b){d.val(b.values[0]),e.val(b.values[1])},change:function(a){a.originalEvent&&f.trigger("change",[!0])}});var j=function(){var a="0"+$(this).val();a=parseFloat(a),a=a>h?h:g>a?g:a,$(this).val(a),b.slider({values:[d.val(),e.val()]})};e.on("change",j),d.on("change",j)},n=function(){var a=$(this),b=a.attr("href");return e.history.gotoUrl(b),!1},o=function(a){var b="mOpen",c="mClose",d=g.hasClass(b);return d&&"boolean"!=typeof a?(g.removeClass(b).addClass(c),h.slideUp(400)):(g.removeClass(c).addClass(b),h.slideDown(400)),!1},p=function(){var a=$(this),b=a.attr("href"),c="mActive",d=a.parent(),g=d.hasClass(c);return g?!1:(e.history.gotoUrl(b),f.length&&$.scrollTo(f,500),!1)},q=function(){var a=$(this),b="mActive",c=a.hasClass(b),d=a.data("ref");return c?!1:(j.removeClass(b),a.addClass(b),k.fadeOut(300),k.promise().done(function(){$("#"+d).fadeIn(300)}),$.scrollTo(f,500),!1)},r=function(){var a=$(this),b=a.attr("href"),c="mActive",d=a.parent(),f=l.find(".mViewer .mSortItem"),g=d.hasClass(c);return g?!1:(f.removeClass(c),d.addClass(c),e.filter.lastRes?e.history.updateUrl(b):e.history.gotoUrl(b),!1)},s=function(){var a=$(this),b=a.attr("href"),c="mActive",d=a.parent(),f=l.find(".mSorting .mSortItem"),g=d.hasClass(c);return g?!1:(f.removeClass(c),d.addClass(c),e.history.gotoUrl(b),!1)};g.on("click",o),j.on("click",q),f.on("change",e.filter.changeFilterHandler),f.on("submit",e.filter.sendFilter),l.on("click",".jsSorting",s),l.on("click",".jsChangeView",r),l.on("click",".jsPagination",p),c.on("click",".jsHistoryLink",n),i.each(m)}(window.ENTER),function(a){var b=a.utils,c=b.extendApp("ENTER.catalog");c.history={_defaultCallback:c.filter.renderCatalogPage,_customCallback:null,gotoUrl:function(a,b,d){var e={title:document.title,url:a,data:{_onlychange:d?!0:!1}};return c.enableHistoryAPI?(c.history._customCallback=b?b:null,void History.pushState(e,e.title,e.url)):void(document.location.href=a)},updateUrl:function(a,b){var d=b?b:null;c.history.gotoUrl(a,d,!0)},getDataFromServer:function(a,b){c.loader&&c.loader.loading();var d=function(){c.loader&&c.loader.complete()},e=function(a){"object"==typeof a&&b(a),c.loader&&c.loader.complete()};$.ajax({type:"GET",url:a,success:e,statusCode:{500:d,503:d},error:d})}};var d=function(){var a=History.getState(),b=a.url,d=a.data.data,e="function"==typeof c.history._customCallback?c.history._customCallback:c.history._defaultCallback;d._onlychange?e():(b=b.addParameterToUrl("ajax","true"),c.history.getDataFromServer(b,e)),c.history._customCallback=null};History.Adapter.bind(window,"statechange",d)}(window.ENTER),function(a){var b=a.utils,c=b.extendApp("ENTER.catalog"),d=$(".bSortingLine"),e=$(".jsInfinityEnable").last();c.infScroll={loading:!1,nowPage:1,checkInfinity:function(){"1"===window.docCookies.getItem("infScroll")&&c.infScroll.enable()},checkScroll:function(){$(window),$(document);!c.infScroll.loading&&e.visible()&&(c.lastPage-c.infScroll.nowPage>0||null===c.lastPage)&&(c.infScroll.nowPage+=1,c.infScroll.load())},load:function(){var a=c.filter.getFilterUrl(),b=function(a){var b;b=c.filter.render.list(a.list),c.infScroll.loading=!1,c.listingWrap.append(b)};c.liveScroll=!0,c.infScroll.loading=!0,a=a.addParameterToUrl("page",c.infScroll.nowPage),a=a.addParameterToUrl("ajax","true"),c.history.getDataFromServer(a,b)},enable:function(){var a="mActive",b=d.find(".mInfinity"),f=d.find(".mPaging"),g=d.find(".bSortingList__eItem.mPage"),h=c.filter.getFilterUrl(),i=document.location.search.match("page=");f.show(),g.hide(),b.addClass(a),c.infScroll.nowPage=1,c.infScroll.loading=!1,window.docCookies.setItem("infScroll",1,2419200,"/"),c.infScroll.checkScroll(),$(window).on("scroll",c.infScroll.checkScroll),c.enableHistoryAPI&&i&&c.history.gotoUrl(h),e=$(".jsInfinityEnable").last(),e.visible()&&c.lastPage>1&&(c.infScroll.nowPage+=1,this.load())},disable:function(){var a=c.filter.getFilterUrl();c.liveScroll=!1,a=a.addParameterToUrl("ajax","true"),window.docCookies.setItem("infScroll",0,2419200,"/"),$(window).off("scroll",c.infScroll.checkScroll),c.history.getDataFromServer(a,c.filter.renderCatalogPage)}};var f=function(){var a="mActive",b=d.find(".mInfinity"),e=b.hasClass(a);return e?!1:(c.infScroll.enable(),!1)},g=function(){var a="mActive",b=d.find(".mInfinity"),e=b.hasClass(a);return e&&c.infScroll.disable(),!1};c.infScroll.checkInfinity(),d.on("click",".jsPaginationEnable",g),d.on("click",".jsInfinityEnable",f)}(window.ENTER),function(a){var b=(a.config.pageConfig,a.utils),c=b.extendApp("ENTER.catalog"),d=$(".bBtnPick__eLink",".bFilter");c.loader={_loader:null,loading:function(){c.loader._loader||(c.loader._loader=$("<li>").addClass("mLoader"),d.addClass("mButLoader").text("Подобрать"),c.liveScroll?c.listingWrap.append(c.loader._loader):(c.listingWrap.empty(),c.listingWrap.append(c.loader._loader)))},complete:function(){c.loader._loader&&(c.loader._loader.remove(),c.loader._loader=null),d.removeClass("mButLoader"),$("body").trigger("catalogLoadingComplete")}}}(window.ENTER),function(){var a=$(".jsChangePackageSet"),b=$(".jsPackageSetPopup"),c=function(){b.lightbox_me({autofocus:!0})};a.on("click",c)}(window.ENTER),$(function(){$(".spk-good-rating").length&&($.getScript("//static.sprosikupi.ru/js/widget/sprosikupi.bootstrap.js"),$("body").on("catalogLoadingComplete",function(){spkLoadRatings()}))}),$(function(){$(".shoppilot-category-container").length&&(_shoppilot=window._shoppilot||[],_shoppilot.push(["_setStoreId","535a852cec8d830a890000a6"]),_shoppilot.push(["_setOnReady",function(a){function b(){$(".shoppilot-category-container").each(function(){var b=$(this);new a.ProductWidget({name:"category-product-rating",styles:"product-reviews",product_id:b.data("productId")}).appendTo(b[0])})}b(),$("body").on("catalogLoadingComplete",b)}]),function(){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src="//ugc.shoppilot.ru/javascripts/require.js",a.setAttribute("data-main","//ugc.shoppilot.ru/javascripts/social-apps.js");var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}())}),$(document).ready(function(){function a(a,b){var c=window[window.GoogleAnalyticsObject],d=window._gaq,e=window.location.href;c&&c("send","event",a,e,b),d&&d.push(["_trackEvent",a,e,b])}var b=$(".jsDataSmartChoice"),c=$(".specialPriceItem"),d=b.attr("data-smartchoice");"undefined"!=typeof b.data("smartchoice")&&$.getJSON("/ajax/product-smartchoice",{"products[]":b.data("smartchoice")},function(a){if(a.success){$.each(a.result,function(a,b){$slider=$.parseHTML(b.content),$($slider).hide(),$(".specialBorderBox").append($slider),$(".smartChoiceSliderToggle-"+a).show()});var b=$(".bGoodsSlider");b.goodsSlider(),b.each(function(){ko.applyBindings(ENTER.UserModel,this)})}}),$(".jsSmartChoiceSliderToggle a").click(function(a){a.preventDefault();var b=$(a.target),c=b.closest("div").data("smartchoice"),d=b.closest("a"),e=$(".specialPriceItemFoot_link");d.hasClass("mActive")?(e.removeClass("mActive"),$(".smartChoiceId-"+c).parent().hide(),$(".specialBorderBox").removeClass("specialBorderBox_render")):(e.removeClass("mActive"),d.addClass("mActive"),$(".bGoodsSlider").hide(),$(".specialBorderBox").addClass("specialBorderBox_render"),$(".smartChoiceId-"+c).parent().show())}),"undefined"!=typeof d&&d!==!1?c.addClass("specialPriceItem_minHeight"):c.removeClass("specialPriceItem_minHeight"),c.on("click",".specialPriceItemCont_imgLink, .specialPriceItemCont_name",function(){var b=$(this).data("article");a("SmartChoice_click",b)}),b.on("click",".productImg, .productName a",function(b){var c=$(b.target).closest(".bSlider__eItem").data("product").article;a("SmartChoice_similar_click",c)})});