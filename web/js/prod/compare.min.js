!function(a){a(function(){function b(a){var b={};return b.id=a.id,b.prefix=a.prefix,b.webName=a.webName,b.link=a.link,b.price=a.price,b.priceOld=a.priceOld,b.inShopOnly=a.inShopOnly,b.inShopShowroomOnly=a.inShopShowroomOnly,b.isBuyable=a.isBuyable,b.statusId=a.statusId,b.imageUrl=a.imageUrl,b.reviews=a.reviews,b.deleteFromCompareUrl=a.deleteFromCompareUrl,b.upsale=a.upsale,b}function c(a){var b={};return b.name=a.name,b}function d(a){var b={};return b.text=a.text,b.productId=a.productId,b}function e(b){var c={};return c.name=b.name,c.isSimilar=ko.observable(),c.values=ko.observableArray(),a.each(b.values,function(){c.values.push(d(this))}),c}function f(b){var c={};return c.name=b.name,c.isSimilar=ko.observable(),c.opened=ko.observable(!0),c.properties=ko.observableArray(),a.each(b.properties,function(){c.properties.push(e(this))}),c}function g(d){var e={};return e.category=c(d.category),e.products=ko.observableArray(),a.each(d.products,function(){e.products.push(b(this))}),e.propertyGroups=ko.observableArray(),a.each(d.propertyGroups,function(){e.propertyGroups.push(f(this))}),e}function h(b){var c={};return c.compareGroups=ko.observableArray(),a.each(b,function(){c.compareGroups.push(g(this))}),c.activeCompareGroupIndex=ko.observable(0),c.similarOnly=ko.observable(!0),c.scrolled=ko.observable(!1),c.cart=ENTER.UserModel.cart,c.compare=ENTER.UserModel.compare,c}function i(){t.similarOnly(!0);var b=t.compareGroups();b.length&&a.each(b[t.activeCompareGroupIndex()].propertyGroups(),function(b,c){var d=!0;a.each(c.properties(),function(b,c){var e=!0,f=null;a.each(c.values(),function(a,b){return b.text!=f&&null!==f?(d=!1,e=!1,!1):void(f=b.text)}),c.isSimilar(e)}),c.isSimilar(d)})}function j(){t.similarOnly(!1);var b=t.compareGroups();b.length&&a.each(b[t.activeCompareGroupIndex()].propertyGroups(),function(b,c){a.each(c.properties(),function(a,b){b.isSimilar(!1)}),c.isSimilar(!1)})}function k(b,c,d){function e(d){d||(d=a(a.unique(a.merge(a.makeArray(b),a.makeArray(c))))),d.each(function(){a(this).css("min-height","0")}),d.each(function(){var b=a(this),c=b.closest("th, td"),d=c.height(),e=b.height(),f=parseInt(b.css("padding-top"))||0,g=parseInt(b.css("padding-bottom"))||0,h=parseInt(b.css("border-top-width"))||0,i=parseInt(b.css("border-bottom-width"))||0,j=e+f+g+h+i,k=f;d>j&&("middle"==c.css("vertical-align")?(k=Math.round((d-j)/2)+f,b.css("padding-top",k+"px")):"bottom"==c.css("vertical-align")&&(k=Math.round(d-j)+f,b.css("padding-top",k+"px"))),b.css("min-height",d+"px")})}function f(){var a=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,d=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,e=null,f=null;return a>j?(e=a-j,b.css("top",e+"px")):b.css("top","auto"),d>k?(f=d-k,c.css("left",f+"px")):c.css("left","auto"),{top:e,left:f}}function g(){var a=f();(d||{}).onScrollStart&&a.top&&!m&&(m=!0,d.onScrollStart(),setTimeout(function(){e(b)},0)),(d||{}).onScrollEnd&&!a.top&&m&&(m=!1,d.onScrollEnd(),e(b))}function h(){i=a(b.get(0)).offset(),j=i.top,k=i.left}if(!b[0])return null;var i=a(b[0]).offset(),j=i.top,k=i.left,l=a(window);b.css("position","relative"),b.css("z-index","110"),c.css("position","relative"),c.css("z-index","120"),b.each(function(){var b=this;c.each(function(){b===this&&a(this).css("z-index","130")})});var m=!1;return e(),l.scroll(g),l.resize(h),f(),{updatePosition:f,updateCellHeight:e,destroy:function(){l.unbind("scroll",g),l.unbind("resize",h)}}}function l(){u&&u.destroy(),u=k(a("tr.js-compare-tableHeadRow td .js-compare-fixed, tr.js-compare-tableHeadRow th .js-compare-fixed",r),a("th .js-compare-fixed",r),{onScrollStart:function(){t.scrolled(!0)},onScrollEnd:function(){t.scrolled(!1)}})}function m(){t.similarOnly()?i():j()}var n=a("body"),o=a(".js-compare"),p=a(".js-compare-header"),q=a(".js-compare-footer"),r=a(".js-compare-table",o),s=a(".js-topbar"),t=h(o.data("compare-groups")),u=null;m(),ko.applyBindings(t,o[0]),setTimeout(function(){l()},0),t.activeCompareGroupIndex.subscribe(function(){l(),t.cart.valueHasMutated(),m()}),t.similarOnly.subscribe(function(){u&&u.updateCellHeight()}),o.on("click",".js-compare-deleteProductLink",function(b){b.preventDefault();var c=b.currentTarget;a.ajax({url:b.currentTarget.href,success:function(){var b=a(c).data("product-id");t.compareGroups.remove(function(a){return a.products.remove(function(a){return a.id==b}),a.propertyGroups.remove(function(a){return a.properties.remove(function(a){return a.values.remove(function(a){return a.productId==b}),0==a.values().length}),0==a.properties().length}),0==a.products().length}),t.compare.remove(function(a){return a.id==b});var d=t.compareGroups().length;t.activeCompareGroupIndex()>d-1&&t.activeCompareGroupIndex(d-1),m()}})}),o.on("click",".js-compare-categoryLink",function(b){b.preventDefault(),t.activeCompareGroupIndex(a(b.currentTarget).data("index")),a(window).scroll()}),o.on("click",".js-compare-modeSimilarOnly",function(){i()}),o.on("click",".js-compare-modeAll",function(){j()}),o.on("click",".js-compare-propertyGroupLink",function(b){b.preventDefault();var c=t.compareGroups();if(c.length){var d=c[t.activeCompareGroupIndex()].propertyGroups(),e=a(b.currentTarget).closest("tr").data("property-group-index");d[e].opened(d[e].opened()?!1:!0)}}),a(window).scroll(function(){var a=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,b=r.width()-n.width();b>0?b>a?(s.css("left",a+"px"),p.css("left",a+"px"),q.css("left",a+"px")):a>=b&&(s.css("left",b+"px"),p.css("left",b+"px"),q.css("left",b+"px")):(s.css("left","0"),p.css("left","0"),q.css("left","0"))})})}(jQuery);