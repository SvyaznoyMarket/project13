!function(a){a(function(){function b(a){return a}function c(a){var b={};return b.name=a.name,b}function d(a){var b={};return b.text=a.text,b.productId=a.productId,b}function e(b){var c={};return c.name=b.name,c.isSimilar=ko.observable(),c.values=ko.observableArray(),a.each(b.values,function(){c.values.push(d(this))}),c}function f(b){var c={};return c.name=b.name,c.isSimilar=ko.observable(),c.opened=ko.observable(!0),c.properties=ko.observableArray(),a.each(b.properties,function(){c.properties.push(e(this))}),c}function g(d){var e={};return e.type=c(d.type),e.products=ko.observableArray(),a.each(d.products,function(){e.products.push(b(this))}),e.propertyGroups=ko.observableArray(),a.each(d.propertyGroups,function(){e.propertyGroups.push(f(this))}),e}function h(b,c){var d={};return d.compareGroups=ko.observableArray(),a.each(b,function(){d.compareGroups.push(g(this))}),d.activeCompareGroupIndex=ko.observable(c),d.similarOnly=ko.observable(!0),d.scrolled=ko.observable(!1),d.cart=ENTER.UserModel.cart,d.compare=ENTER.UserModel.compare,d}function i(){var b=w.compareGroups();b.length&&a.each(b[w.activeCompareGroupIndex()].propertyGroups(),function(b,c){var d=!0;a.each(c.properties(),function(b,c){var e=!0,f=null;a.each(c.values(),function(a,b){return b.text!=f&&null!==f?(d=!1,e=!1,!1):void(f=b.text)}),c.isSimilar(e)}),c.isSimilar(d)}),w.similarOnly(!0)}function j(){var b=w.compareGroups();b.length&&a.each(b[w.activeCompareGroupIndex()].propertyGroups(),function(b,c){a.each(c.properties(),function(a,b){b.isSimilar(!1)}),c.isSimilar(!1)}),w.similarOnly(!1)}function k(b,c,d){function e(d){d||(d=a(a.merge(a.makeArray(b),a.makeArray(c),a.makeArray(l))));var e={};d.each(function(b){a(this).attr("style",function(a,b){return(b||"").replace(/height:[^;]+;?/g,"")}),a(this).closest("th, td").attr("style",function(a,b){return(b||"").replace(/height:[^;]+;?/g,"")}),e[b]=a(this).attr("style"),a(this).css({position:"relative",left:"auto",top:"auto","margin-left":"0","margin-top":"0"})}),d.each(function(b){var c=a(this),d=c.closest("th, td"),f=d.height(),g=c.outerHeight(!1);if(a(this).attr("style",e[b]),f>g){var h=parseInt(c.css("padding-top"))||0;"middle"==d.css("vertical-align")?c.css("padding-top",Math.round((f-g)/2)+h+"px"):"bottom"==d.css("vertical-align")&&c.css("padding-top",Math.round(f-g)+h+"px")}c.css("height",f+"px"),d.css({height:f+"px","vertical-align":"top"})})}function f(){var a=o.scrollTop(),b=o.scrollLeft(),c=0,d=0;return a>j.top&&(c=a-j.top),b>j.left&&(d=b-j.left),{top:c,left:d}}function g(){var g=f();g.top&&(m?setTimeout(function(){b.css("margin-left",-g.left+"px")},0):(m=!0,q=!1,(d||{}).onVerticalScrollStart&&d.onVerticalScrollStart(),setTimeout(function(){e(a(a.merge(a.makeArray(b),a.makeArray(l)))),b.css({position:"fixed",top:"0","margin-left":-g.left+"px"}),l.css({position:"fixed",top:"0","margin-top":"0"})},0)),n||setTimeout(function(){l.css("margin-left",-g.left+"px")},0)),!g.top&&!q&&p.height()-(o.scrollTop()+o.height())>0&&(q=!0,(d||{}).onVerticalScrollEnd&&d.onVerticalScrollEnd(),m||setTimeout(function(){e(a(a.merge(a.makeArray(b),a.makeArray(l))))},0)),!g.top&&m&&(m=!1,setTimeout(function(){b.css({position:"relative",top:"auto","margin-left":"0"}),l.css({top:"auto","margin-left":"0"}),setTimeout(function(){e(a(a.merge(a.makeArray(b),a.makeArray(l))))},0)},0)),g.left&&(n||(n=!0,r=!1,(d||{}).onHorizontalScrollStart&&d.onHorizontalScrollStart(),setTimeout(function(){c.css({position:"fixed",left:"0"}),l.css({position:"fixed",left:"0","margin-left":"0"})},0)),setTimeout(function(){c.css("margin-top",-o.scrollTop()+"px")},0),m||setTimeout(function(){l.css("margin-top",-o.scrollTop()+"px")},0)),!g.left&&!r&&p.width()-(o.scrollLeft()+o.width())>0&&(r=!0,(d||{}).onHorizontalScrollEnd&&d.onHorizontalScrollEnd()),!g.left&&n&&(n=!1,setTimeout(function(){c.css({position:"relative",left:"auto","margin-top":"0"}),l.css({left:"auto","margin-top":"0"})},0)),g.top||g.left||setTimeout(function(){l.css("position","relative")},0)}function h(){j=i.offset()}if(!b[0])return null;var i=a(b[0]).closest("th, td"),j=i.offset(),k=a(window),l=a(),m=!1,n=!1,q=!0,r=!0;return b.each(function(){var a=this;c.each(function(){a===this&&(b=b.not(this),c=c.not(this),l=l.add(this))})}),b.css("z-index","110"),c.css("z-index","120"),l.css("z-index","130"),e(),g(),k.scroll(g),k.resize(h),{updateSize:e,destroy:function(){k.unbind("scroll",g),k.unbind("resize",h)}}}function l(){x&&x.destroy(),x=k(a("tr.js-compare-tableHeadRow td .js-compare-fixed, tr.js-compare-tableHeadRow th .js-compare-fixed",v),a("th .js-compare-fixed",v),{onVerticalScrollStart:function(){w.scrolled(!0)},onVerticalScrollEnd:function(){w.scrolled(!1)}})}function m(){w.similarOnly()?i():j()}function n(){var a=p.height(),b=o.height(),c=o.scrollTop(),d=b-u.outerHeight(!1),e=d+(a-b-c);r.css({"padding-top":s.outerHeight(!1)+t.outerHeight(!1)}),s.css({"margin-top":(c>=0?-c:0)+"px"}),t.css({top:s.outerHeight(!1)+"px","margin-top":(c>=0?-c:0)+"px"}),u.css({top:(e>d?e:d)+"px"})}var o=a(window),p=a(document),q=a(".js-compare"),r=a(".js-compare-content"),s=a(".js-compare-header1"),t=a(".js-compare-header2"),u=a(".js-compare-footer"),v=a(".js-compare-table",q),w=h(q.data("compare-groups"),q.data("active-compare-group-index")),x=null;m(),ko.applyBindings(w,q[0]),setTimeout(function(){l()},0),w.activeCompareGroupIndex.subscribe(function(){l(),w.cart.valueHasMutated(),m(),n()}),w.similarOnly.subscribe(function(){x&&x.updateSize(),n()}),a.each(w.compareGroups(),function(b,c){a.each(c.propertyGroups(),function(a,b){b.opened.subscribe(function(){x&&x.updateSize(),n()})})}),q.on("click",".js-compare-deleteProductLink",function(b){b.preventDefault();var c=b.currentTarget;a.ajax({url:b.currentTarget.href,success:function(){var b=a(c).data("product-id");w.compareGroups.remove(function(a){return a.products.remove(function(a){return a.id==b}),a.propertyGroups.remove(function(a){return a.properties.remove(function(a){return a.values.remove(function(a){return a.productId==b}),0==a.values().length}),0==a.properties().length}),0==a.products().length}),w.compare.remove(function(a){return a.id==b});var d=w.compareGroups().length;w.activeCompareGroupIndex()>d-1&&w.activeCompareGroupIndex(d-1),m(),n(),x&&x.updateSize()}})}),q.on("click",".js-compare-typeLink",function(b){b.preventDefault(),w.activeCompareGroupIndex(a(b.currentTarget).data("index"))}),q.on("click",".js-compare-modeSimilarOnly",function(){i()}),q.on("click",".js-compare-modeAll",function(){j()}),q.on("click",".js-compare-propertyGroupLink",function(b){b.preventDefault();var c=w.compareGroups();if(c.length){var d=c[w.activeCompareGroupIndex()].propertyGroups(),e=a(b.currentTarget).closest("tr").data("property-group-index");d[e].opened(d[e].opened()?!1:!0)}}),a(window).resize(n),a(window).scroll(n),n()})}(jQuery);