!function(a){a(function(){function b(a){var b={};return b.id=a.id,b.prefix=a.prefix,b.webName=a.webName,b.link=a.link,b.price=a.price,b.priceOld=a.priceOld,b.inShopOnly=a.inShopOnly,b.inShopShowroomOnly=a.inShopShowroomOnly,b.isBuyable=a.isBuyable,b.statusId=a.statusId,b.imageUrl=a.imageUrl,b.reviews=a.reviews,b.deleteFromCompareUrl=a.deleteFromCompareUrl,b.upsale=a.upsale,b}function c(a){var b={};return b.name=a.name,b}function d(a){var b={};return b.text=a.text,b.productId=a.productId,b}function e(b){var c={};return c.name=b.name,c.isSimilar=ko.observable(),c.values=ko.observableArray(),a.each(b.values,function(){c.values.push(d(this))}),c}function f(b){var c={};return c.name=b.name,c.isSimilar=ko.observable(),c.opened=ko.observable(!0),c.properties=ko.observableArray(),a.each(b.properties,function(){c.properties.push(e(this))}),c}function g(d){var e={};return e.category=c(d.category),e.products=ko.observableArray(),a.each(d.products,function(){e.products.push(b(this))}),e.propertyGroups=ko.observableArray(),a.each(d.propertyGroups,function(){e.propertyGroups.push(f(this))}),e}function h(b){var c={};return c.compareGroups=ko.observableArray(),a.each(b,function(){c.compareGroups.push(g(this))}),c.activeCompareGroupIndex=ko.observable(0),c.similarOnly=ko.observable(!0),c.scrolled=ko.observable(!1),c.cart=ENTER.UserModel.cart,c.compare=ENTER.UserModel.compare,c}function i(){s.similarOnly(!0);var b=s.compareGroups();b.length&&a.each(b[s.activeCompareGroupIndex()].propertyGroups(),function(b,c){var d=!0;a.each(c.properties(),function(b,c){var e=!0,f=null;a.each(c.values(),function(a,b){return b.text!=f&&null!==f?(d=!1,e=!1,!1):void(f=b.text)}),c.isSimilar(e)}),c.isSimilar(d)})}function j(){s.similarOnly(!1);var b=s.compareGroups();b.length&&a.each(b[s.activeCompareGroupIndex()].propertyGroups(),function(b,c){a.each(c.properties(),function(a,b){b.isSimilar(!1)}),c.isSimilar(!1)})}function k(b,c,d){function e(d){d||(d=a(a.merge(a.makeArray(b),a.makeArray(c),a.makeArray(l))));var e={};d.each(function(b){a(this).attr("style",function(a,b){return(b||"").replace(/height:[^;]+;?/g,"")}),a(this).closest("th, td").attr("style",function(a,b){return(b||"").replace(/height:[^;]+;?/g,"")}),e[b]=a(this).attr("style"),a(this).css({position:"relative",left:"auto",top:"auto","margin-left":"0","margin-top":"0"})}),d.each(function(b){var c=a(this),d=c.closest("th, td"),f=d.height(),g=c.outerHeight(!1);if(a(this).attr("style",e[b]),f>g){var h=parseInt(c.css("padding-top"))||0;"middle"==d.css("vertical-align")?c.css("padding-top",Math.round((f-g)/2)+h+"px"):"bottom"==d.css("vertical-align")&&c.css("padding-top",Math.round(f-g)+h+"px")}c.css("height",f+"px"),d.css({height:f+"px","vertical-align":"top"})})}function f(){var a=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,b=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,c=0,d=0;return a>j.top&&(c=a-j.top),b>j.left&&(d=b-j.left),{top:c,left:d}}function g(){var g=f();g.top&&(m?b.css("margin-left",-g.left+"px"):(m=!0,(d||{}).onVerticalScrollStart&&d.onVerticalScrollStart(),setTimeout(function(){e(a(a.merge(a.makeArray(b),a.makeArray(l)))),b.css({position:"fixed",top:"0","margin-left":-g.left+"px"}),l.css({position:"fixed",top:"0","margin-top":"0"})},0)),n||l.css("margin-left",-g.left+"px")),!g.top&&m&&(m=!1,(d||{}).onVerticalScrollEnd&&d.onVerticalScrollEnd(),b.css({position:"relative",top:"auto","margin-left":"0"}),l.css({top:"auto","margin-left":"0"}),setTimeout(function(){e(a(a.merge(a.makeArray(b),a.makeArray(l))))},0)),g.left&&(n||(n=!0,(d||{}).onHorizontalScrollStart&&d.onHorizontalScrollStart(),c.css({position:"fixed",left:"0"}),l.css({position:"fixed",left:"0","margin-left":"0"})),c.css("margin-top",-(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)+"px"),m||l.css("margin-top",-(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)+"px")),!g.left&&n&&(n=!1,(d||{}).onHorizontalScrollEnd&&d.onHorizontalScrollEnd(),c.css({position:"relative",left:"auto","margin-top":"0"}),l.css({left:"auto","margin-top":"0"})),g.top||g.left||l.css("position","relative")}function h(){j=i.offset()}if(!b[0])return null;var i=a(b[0]).closest("th, td"),j=i.offset(),k=a(window),l=a(),m=!1,n=!1;return b.each(function(){var a=this;c.each(function(){a===this&&(b=b.not(this),c=c.not(this),l=l.add(this))})}),b.css("z-index","110"),c.css("z-index","120"),l.css("z-index","130"),e(),g(),k.scroll(g),k.resize(h),{updateCell:e,destroy:function(){k.unbind("scroll",g),k.unbind("resize",h)}}}function l(){t&&t.destroy(),t=k(a("tr.js-compare-tableHeadRow td .js-compare-fixed, tr.js-compare-tableHeadRow th .js-compare-fixed",q),a("th .js-compare-fixed",q),{onVerticalScrollStart:function(){s.scrolled(!0)},onVerticalScrollEnd:function(){s.scrolled(!1)}})}function m(){s.similarOnly()?i():j()}function n(){var a=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;q.css({"margin-top":r.outerHeight(!1)+p.outerHeight(!1)}),r.css({position:"fixed",top:"0",right:"0",left:"0","margin-top":-a+"px"}),p.css({position:"fixed",top:r.outerHeight(!1)+"px",right:"0",left:"0","margin-top":-a+"px"})}var o=a(".js-compare"),p=a(".js-compare-header"),q=a(".js-compare-table",o),r=a(".js-topbar"),s=h(o.data("compare-groups")),t=null;m(),ko.applyBindings(s,o[0]),setTimeout(function(){l()},0),s.activeCompareGroupIndex.subscribe(function(){l(),s.cart.valueHasMutated(),m()}),s.similarOnly.subscribe(function(){t&&t.updateCell()}),o.on("click",".js-compare-deleteProductLink",function(b){b.preventDefault();var c=b.currentTarget;a.ajax({url:b.currentTarget.href,success:function(){var b=a(c).data("product-id");s.compareGroups.remove(function(a){return a.products.remove(function(a){return a.id==b}),a.propertyGroups.remove(function(a){return a.properties.remove(function(a){return a.values.remove(function(a){return a.productId==b}),0==a.values().length}),0==a.properties().length}),0==a.products().length}),s.compare.remove(function(a){return a.id==b});var d=s.compareGroups().length;s.activeCompareGroupIndex()>d-1&&s.activeCompareGroupIndex(d-1),m()}})}),o.on("click",".js-compare-categoryLink",function(b){b.preventDefault(),s.activeCompareGroupIndex(a(b.currentTarget).data("index")),a(window).scroll()}),o.on("click",".js-compare-modeSimilarOnly",function(){i()}),o.on("click",".js-compare-modeAll",function(){j()}),o.on("click",".js-compare-propertyGroupLink",function(b){b.preventDefault();var c=s.compareGroups();if(c.length){var d=c[s.activeCompareGroupIndex()].propertyGroups(),e=a(b.currentTarget).closest("tr").data("property-group-index");d[e].opened(d[e].opened()?!1:!0)}}),a(window).resize(n),a(window).scroll(n),n()})}(jQuery);