$(document).ready(function () {
    function k(a, b) {
        $(a).animate({opacity:"0"}, 400, function () {
            setTimeout(function () {
                a.attr({src:d[b].imgs, alt:d[b].alt, title:d[b].alt});
                $(a).animate({opacity:"1"})
            }, 350)
        })
    }

    function l(b) {
        var c = a.length - b - 3;
        d = 0 <= c ? a.slice(b, b + 3) : a.slice(b).concat(a.slice(0, -c))
    }

    function e(b) {
        if (i) {
            if (j)return!1;
            j = !0;
            b ? clearTimeout(h) : b = 1;
            var c = "-=1000px", g = "1032px";
            0 > b && (c = "+=1000px", g = "-968px");
            f = (f + b) % a.length;
            0 > f && (f = a.length - 1);
            l(f);
            $(".centerImage").animate({left:c, opacity:"0"}, 800, function () {
                $(".centerImage").attr("src",
                    d[1].imgb).data("url", d[1].url);
                $(this).css("left", g).animate({opacity:"1", left:c});
                j = !1;
                h = setTimeout(function () {
                    e()
                }, d[1].t)
            });
            k($(".leftImage"), 0);
            k($(".rightImage"), 2)
        } else h = setTimeout(function () {
            e()
        }, d[1].t)
    }

    $(".startse").bind({blur:function () {
        if ("" == this.value)this.value = "Поиск среди 20 000 товаров"
    }, focus:function () {
        if ("Поиск среди 20 000 товаров" == this.value)this.value = ""
    }});
    if ($("#main_banner-data").length) {
        for (var a = $("#main_banner-data").data("value"), b = 0; b < a.length; b++) {
            ("undefined" ===
                typeof a[b].imgb || "undefined" === typeof a[b].imgs) && a.splice(b, 1);
            if ("undefined" === typeof a[b].url)a[b].url = "";
            if ("undefined" === typeof a[b].t)a[b].url = 4E3;
            if ("undefined" === typeof a[b].alt)a[b].url = ""
        }
        var c = a.length;
        if (0 != c)if (1 == c)"is_exclusive"in a[0] && a[0].is_exclusive ? (b = $("<img>").attr("src", a[0].imgb).css("cursor", "pointer").data("url", a[0].url).click(function () {
            "undefined" !== typeof _gaq && "undefined" !== typeof a[0].ga && _gaq.push(["_trackEvent", "BannerClick", a[0].ga]);
            location.href = $(this).data("url")
        }),
            $(".bCarouselWrap").html(b)) : $(".centerImage").attr("src", a[0].imgb).data("url", a[0].url).click(function () {
            "undefined" !== typeof _gaq && "undefined" !== typeof a[0].ga && _gaq.push(["_trackEvent", "BannerClick", a[0].ga]);
            location.href = $(this).data("url")
        }); else {
            for (var g = $("<div>").css("display", "none"), b = 0; b < c; b++)$("<img>").attr("src", a[b].imgb).appendTo(g), $("<img>").attr("src", a[b].imgs).appendTo(g);
            $("body").append(g);
            $(".leftImage").attr({src:a[c - 1].imgs, alt:a[c - 1].alt, title:a[c - 1].alt});
            $(".centerImage").attr("src",
                a[0].imgb).data("url", a[0].url);
            $(".rightImage").attr({src:a[1].imgs, alt:a[1].alt, title:a[1].alt});
            var f = a.length - 1, h = null, d = [], j = !1, i = !0;
            l(f);
            h = setTimeout(function () {
                e()
            }, d[1].t);
            $("html").css("overflow-x", "hidden");
            c = navigator.userAgent.toLowerCase();
            b = -1 < c.indexOf("android");
            c = -1 < c.indexOf("ipad") || -1 < c.indexOf("iphone");
            b || c ? ($(".bCarousel div").show(), $(".allpage").css("overflow", "hidden")) : $(".bCarousel").mouseenter(
                function () {
                    $(".bCarousel div").show()
                }).mouseleave(function () {
                $(".bCarousel div").hide()
            });
            $(".leftArrow").click(function () {
                e(-1)
            });
            $(".leftImage").click(function () {
                e(-1)
            });
            $(".rightArrow").click(function () {
                e(1)
            });
            $(".rightImage").click(function () {
                e(1)
            });
            $(".centerImage").click(function () {
                clearTimeout(h);
                "undefined" !== typeof _gaq && "undefined" !== typeof d[1].ga && _gaq.push(["_trackEvent", "BannerClick", d[1].ga]);
                location.href = $(this).data("url")
            });
            $(".promos").click(function () {
                location.href = $(this).data("url")
            });
            $(".centerImage").hover(function () {
                i = !1
            }, function () {
                i = !0
            })
        }
    }
});
