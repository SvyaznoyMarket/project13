function MapWithShopsOLD(g,h,j,i){function k(){var a=$("#order-delivery_map-data").data().value.shops,c={},d=1,e;for(e in a){var f=a[e];f.markerImg="/images/marker_"+d+".png";c[f.id]=f;d++}return c}var a=this;a.mapWS=null;a.infoWindow=null;a.positionC=null;a.markers=[];a.inited=!1;this.showInfobox=function(b){var c=a.markers[b.id];$.each(h.find("[data-name]"),function(a,b){b.innerHTML=c[$(b).data("name")]});a.infoWindow.setContent(h.prop("innerHTML"));a.infoWindow.setPosition(b.position);a.infoWindow.open(a.mapWS);
google.maps.event.addListener(a.infoWindow,"closeclick",function(){b.setVisible(!0)})};this.showInfoWindow=function(b){a.infoWindow.setContent("<div>"+b.name+"<br />"+b.regime+"</div>");a.infoWindow.setPosition(b.ref.position);a.infoWindow.open(a.mapWS,b.ref)};this.renderShopInfo=function(a){var c='<li data-id="'+a.id+'">',c=c+'<div class="bMapShops__eListNum"><img src="/images/shop.png" alt=""/></div>'+("<div>"+a.name+"</div>"),c=c+("<span>Работаем</span> <span>"+a.regime+"</span>");$("#mapPopup_shopInfo").append(c+
"</li>")};this.showMarkers=function(){if(!0!==a.inited){var b=k();$.each(a.markers,function(a,b){"undefined"!==typeof b.ref&&b.ref.setMap(null)});a.markers=b;google.maps.event.trigger(a.mapWS,"resize");a.mapWS.setCenter(a.positionC);$.each(b,function(b,d){var e=new google.maps.Marker({position:new google.maps.LatLng(d.latitude,d.longitude),map:a.mapWS,title:d.name,icon:d.markerImg,id:d.id});google.maps.event.addListener(e,"click",function(){i(this.id)});google.maps.event.addListener(e,"mouseover",
function(){a.showInfoWindow(a.markers[this.id])});a.markers[e.id].ref=e;a.renderShopInfo(d)});$("#mapPopup_shopInfo li").click(function(){i($(this).data("id"))});a.inited=!0}};this.closeMap=function(){a.infoWindow.close();$(".mMapPopup").trigger("close")};this.openMap=function(){$(".mMapPopup").lightbox_me({centered:!0,onLoad:function(){a.showMarkers()}})};$("#mapPopup_shopInfo").data("timer",null).delegate("li","hover",function(){var b=$(this).data("id"),c=$("#mapPopup_shopInfo").data("timer");c&&
clearTimeout(c);b&&a.markers[b]&&(c=setTimeout(function(){a.showInfoWindow(a.markers[b])},500),$("#mapPopup_shopInfo").data("timer",c))});(function(){console.log("LatLng"in google.maps);alert("AAAA");a.positionC=new google.maps.LatLng(g.latitude,g.longitude);var b={zoom:11,center:a.positionC,scrollwheel:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU}};a.mapWS=new google.maps.Map(document.getElementById(j),b);a.infoWindow=new google.maps.InfoWindow({maxWidth:400,
disableAutoPan:!1})})()};
