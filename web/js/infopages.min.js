$(document).ready(function(){function e(e){return""===e.val().replace(/\s/g,"")?(e.addClass("mEmpty"),e.after($('<span class="mEmpty">(!) Пожалуйста, верно заполните поле</span>')),!1):(e.hasClass("mEmpty")&&(e.removeClass("mEmpty"),e.parent().find(".mEmpty").remove()),!0)}function t(){$("#f_success").show(),$("#f_init").hide()}function r(){$("#oneClickPromo input[type=text]").removeAttr("disabled"),$("#f_init h2").text("Произошла ошибка :( Попробуйте ещё"),button.text("Отправить предзаказ")}function a(){$(u).hide()}function o(e){return u=e,$(e).show(),!1}if($(".subscribe-form__btn").length){var i=$(".subscribe-form__email"),n=$(".subscribe-form"),s=function(){var e=$(this).data("url"),t=i.val();return-1!==t.search("@")?$.post(e,{email:t},function(e){return e.success?(n.html('<div class="subscribe-form__title">Спасибо! подтверждение подписки отправлено на указанный e-mail</div>'),docCookies.setItem(!1,"subscribed",1,15768e4,"/"),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","Account","Emailing sign up","Page be-friends"]),void 0):!1}):i.addClass("mError"),!1};$(".subscribe-form__btn").bind("click",s)}if($(".infiniteCarousel").infiniteCarousel(),$(".getProductList").length&&(console.log("yes!"),$(".getProductList").each(function(){var e=$(this),t=e.data("product"),r="/products/widget/"+t;$.get(r,function(t){return t.success?(e.html(t.content),void 0):!1})})),$("#corp_select").length&&($('form[action="/corporate-register"]').bind("submit",function(){return"Другая форма"===$("#corp_select").find("option:selected").val()?!1:void 0}),$("#corp_select").change(function(){"Другая форма"===$(this).find("option:selected").val()&&$("#corpNotice").lightbox_me({centered:!0,closeSelector:".close"})})),$("#oneClickPromo").length&&($(".halfline .bOrangeButton.active").click(function(){var e=$(this).parent().parent(),t={};t.token=e.find(".ttl").text(),t.price=e.find(".price").text(),t.image=e.find("img").attr("src"),$("#ipadwrapper").html(tmpl("ipad",t)),$("#order1click-container-new").lightbox_me({})}),$("#oneClickPromo").submit(function(e){return e.preventDefault(),!1}),$.mask!==void 0&&($.mask.definitions.n="[()0-9 -]",$("#phonemask").mask("8nnnnnnnnnnnnnnnnn",{placeholder:" ",maxlength:10})),$("#oneClickPromo input[type=text]").change(function(){e($(this))}),$(".bBigOrangeButton").click(function(e){if(e.preventDefault(),$("#oneClickPromo input[type=text]").trigger("change"),!$(".mEmpty").length){var a=$(this);a.text("Идёт отправка...");var o=$("#oneClickPromo").serializeArray();$("#oneClickPromo input[type=text]").attr("disabled","disabled");var i=$("#oneClickPromo").attr("action");$.ajax({url:i,data:o,success:function(e){return"success"in e?"ok"!==e.success?(r(),!1):(t(),!0):(r(),!1)}})}})),$(".bCreditLine").length){document.getElementById("requirementsFullInfoHref").style.cursor="pointer",$("#requirementsFullInfoHref").bind("click",function(){$(".bCreditLine2").toggle()});for(var d=$("#creditOptions").data("value"),p=$("#bankInfo").data("value"),l=$("#relations").data("value"),c=0;d.length>c;c++)creditOption=d[c],$("<option>").val(creditOption.id).text(creditOption.name).appendTo("#productSelector");$("#productSelector").change(function(){var e=$(this).val(),t=l[e];$("#bankProductInfoContainer").empty();for(c in t){var r={};r.bankName=p[c].name,r.bankImage=p[c].image,programNames="";for(j in t[c]){programNames+="<h4>"+p[c].programs[t[c][j]].name+"</h4>\r\n<ul>";for(k in p[c].programs[t[c][j]].params)programNames+="	<li>"+p[c].programs[t[c][j]].params[k]+"</li>\r\n";programNames+="</ul>"}r.programNames=programNames;var a=tmpl("bank_program_list_tmpl",r);$("#bankProductInfoContainer").append(a)}$("#bankProductInfoContainer").append('<p class="ac mb25"><a class="bBigOrangeButton" href="'+d[e-1].url+'">'+d[e-1].button_name+"</a></p>")})}if($(".bMobileApps").length){var u="";$("body").bind("click.mob",a),$("div.bMobDown").click(function(e){e.stopPropagation()}),$(".bMobDown__eClose").click(function(){return a(),!1}),$(".android-load").click(function(){return o(".android-block"),!1}),$(".iphone-load").click(function(){return o(".iphone-block"),!1}),$(".symbian-load").click(function(){return o(".symbian-block"),!1})}$("#hideLoginform").length&&$("#hideLoginform").bind("click",function(){var e=$("#login-form");return $("#hideLoginform").hide(),e.slideDown(300),$.scrollTo(e,500),console.log("123"),!1});var m=function(e,t,r,a){function o(){for(s.append('<div class="bPaginator_eWrap"></div>'),s.append('<div class="bPaginatorSlider"><div class="bPaginatorSlider_eWrap"><div class="bPaginatorSlider_eFill" style="width:'+p+'px"></div></div></div>'),c=0;self.inputVars.totalPages>c;c++)$(".bPaginator_eWrap",s).append('<a class="bPaginator_eLink" href="#'+c+'">'+(c+1)+"</a>"),c+1===self.inputVars.activePage&&$(".bPaginator_eLink",s).eq(c).addClass("active");var e=$(".bPaginator_eLink",s).width();$(".bPaginator_eLink",s).css({marginLeft:(u-e-2)/2,marginRight:(u-e-2)/2}),$(".bPaginator_eWrap",s).addClass("clearfix").width(u*self.inputVars.totalPages)}function i(){var e=!1,t=0,r=0;$(".bPaginatorSlider",s).bind("mousedown",function(a){t=a.pageX,r=parseInt($(".bPaginatorSlider_eFill",s).css("left")),e=!0}),$(".bPaginatorSlider",s).bind("mouseup",function(){e=!1}),s.bind("mouseout",function(){e=!1}),$(".bPaginatorSlider",s).bind("mousemove",function(a){if(e){var o=r+(a.pageX-t);o>=0&&d-p>=o&&($(".bPaginatorSlider_eFill",s).css("left",r+(a.pageX-t)),n(o))}})}function n(e){var t=Math.round(e/l);$(".bPaginator_eWrap",s).css("left",-(u*t))}self=this,self.inputVars={domID:e,totalPages:t,visPages:r?r:10,activePage:a?a:1};var s=$("#"+self.inputVars.domID),d=s.width(),p=d*self.inputVars.visPages/self.inputVars.totalPages,l=p/self.inputVars.visPages,u=d/self.inputVars.visPages,m=Math.round(self.inputVars.visPages/2);self.setActive=function(e){$(".bPaginator_eLink",s).removeClass("active"),$(".bPaginator_eLink",s).eq(e).addClass("active");var t=parseInt($(".bPaginator_eWrap",s).css("left")),r=parseInt($(".bPaginatorSlider_eFill",s).css("left")),a=-1*Math.round(t/u),o=-(m-(e-a));t-o*u>0?(t=0,r=0):e>self.inputVars.totalPages-m?(t=-1*Math.round(self.inputVars.totalPages-self.inputVars.visPages)*u,r=Math.round(self.inputVars.totalPages-self.inputVars.visPages)*l):(t-=o*u,r+=o*l),$(".bPaginator_eWrap").animate({left:t}),$(".bPaginatorSlider_eFill",s).animate({left:r})},o(),i()};if($("#promoCatalog").length){var h=$("#promoCatalog").data("slides"),f=h.length,v=new m("promoCatalogPaginator",f,12,1),g=function(){for(var e in h){var t=tmpl("slide_tmpl",h[e]);$(".bPromoCatalogSliderWrap").append(t),""==$(".bPromoCatalogSliderWrap_eSlideLink").eq(e).attr("href")&&$(".bPromoCatalogSliderWrap_eSlideLink").eq(e).removeAttr("href"),$(".bPromoCatalogNav").append('<a id="promoCatalogSlide'+e+'" href="#'+e+'" class="bPromoCatalogNav_eLink">'+(1*e+1)+"</a>")}};g();var b=$(".bPromoCatalogSliderWrap_eSlide").width();$(".bPromoCatalogSliderWrap").width(b*f+(460-b/2));var y=0;$(".bPromoCatalogSlider_eArrow").bind("click",function(){var e=$(this).hasClass("mArLeft")?"-1":"1";return _(y+1*e),!1}),$(".bPaginator_eLink").bind("click",function(){if($(this).hasClass("active"))return!1;var e=1*$(this).attr("href").slice(1);return _(e),!1});var _=function(e){0===e?$(".bPromoCatalogSlider_eArrow.mArLeft").hide():$(".bPromoCatalogSlider_eArrow.mArLeft").show(),e===f-1?$(".bPromoCatalogSlider_eArrow.mArRight").hide():$(".bPromoCatalogSlider_eArrow.mArRight").show(),$(".bPromoCatalogSliderWrap").animate({left:-(b*e)},500,function(){y=e}),window.location.hash="slide"+(e+1),v.setActive(e)},w=window.location.hash;if(w.indexOf("slide")+1){var C=parseInt(w.slice(6))-1;_(C)}}});