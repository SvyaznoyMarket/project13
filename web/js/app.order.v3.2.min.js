$(document).ready(function(){var f,h;function k(a,b,c,d,e,g){a=a+"="+encodeURIComponent(b);c&&(a+="; expires="+c.toGMTString());d&&(a+="; path="+d);e&&(a+="; domain="+e);g&&(a+="; secure");document.cookie=a;return!0}function n(a){a=tmpl("elementInShopList",a);l.append(a)}function j(){$(".mMapPopup").lightbox_me({centered:!0,onLoad:function(){window.regionMap.showMarkers(o)}})}window.blockScreen=function(a){$('<img src="/images/ajaxnoti.gif" />').css("display","none").appendTo("body");var b=$("<div>").addClass("noti").html('<div><img src="/images/ajaxnoti.gif" /></br></br> '+
a+"</div>");b.appendTo("body");this.block=function(){b.is(":hidden")&&b.lightbox_me({centered:!0,closeClick:!1,closeEsc:!1})};this.unblock=function(){b.trigger("close")}};blockDiv=new blockScreen("Ваш заказ оформляется");Templating={assign:function(a,b){$.each(a.data("assign"),function(c,d){var e=d[1];$.isArray(e)||(e=[e]);$.each(e,function(a,d){"_value"==d&&(e[a]=b[c])});a[d[0]].apply(a,e);"true"==a.attr("data-replace")&&a.replaceWith(a.text())})},clone:function(a){return $(a.clone().html())}};DeliveryMap=
{dataHolder:$("#order-delivery_map-data"),data:function(a){if(a)this.dataHolder.data("value",a);else return this.dataHolder.data("value")},getRemoteData:function(a,b,c,d){var e=this,d=d||!1;$("#order-submit").addClass("disable");$.ajax({type:"POST",async:d,timeout:6E4,url:a,dataType:"json",data:{delivery_type_id:b.deliveryTypeId,shop_id:b.shopId},success:function(a){a=a.data;e.data(a);$.isFunction(c)&&c.call(e,[a])},complete:function(){}})},moveItem:function(a,b,c){var d=this.data(),e=d.items[a];
if("undefined"==typeof a||-1==$.inArray(c,Object.keys(e.deliveries)))return!1;$.each(d.deliveryTypes[b].items,function(c,e){e==a&&d.deliveryTypes[b].items.splice(c,1)});d.deliveryTypes[c].items.push(a);this.data(d);return!0},moveItemBlock:function(a,b){if(a==b)return[];var c=this.data(),d=[],e=c.deliveryTypes[a].items.length;for(p=0;p<e;p++){var g=c.deliveryTypes[a].items[p];array_key_exists(b,c.items[g].deliveries)?c.deliveryTypes[b].items.push(g):d.push(g)}c.deliveryTypes[a].items=d;this.data(c);
return d},getDeliveryPrice:function(a){if(!a)return 0;var b=this.data(),c=0;$.each(a.items,function(d,e){var g=b.items[e].deliveries[a.token].price;g>c&&(c=g)});return parseInt(c)},getDeliveryTotal:function(a){var b=this.data(),c=0;$.each(a.items,function(a,e){c+=b.items[e].total});return parseInt(c)},getDeliveryDate:function(a){var b=this.data(),c=null;$.each(a.items,function(d,e){var g=[];$.each(b.items[e].deliveries[a.token].dates,function(a,b){g.push(b.value)});c=null===c?g:array_intersect(c,
g)});return null===c?[]:array_values(c)},getDeliveryInterval:function(a,b){var c=this.data(),d={};$.each(a.items,function(e,g){$.each(c.items[g].deliveries[a.token].dates,function(a,c){c.value==b&&$.each(c.intervals,function(a,b){d[b.start_at+","+b.end_at]=b})})});return d},render:function(){var a=this,b=this.data();$("#order-submit").removeClass("disable");var c=!0;$.each(b.deliveryTypes,function(a,b){if(b.items.length)return c=!1});if(c){var d=$("#order-form").data("cartUrl");window.location=d?
d:"/";return!1}var e=!1;$.when(function(){var a=$.Deferred(),c=b.unavailable.length;c?($.each(b.unavailable,function(d,f){var m=b.items[f];if(!m||0==m.stock||"product"!=m.type||m.quantity<=m.stock)return d+1==c&&a.resolve(),!0;confirm('Вы заказали товар "'+m.name+'" в количестве '+m.quantity+" шт.\nДоступно только "+m.stock+" шт.\nЗаказать "+m.stock+"шт?")?$.ajax({url:m.deleteUrl}).done(function(){$.ajax({url:m.addUrl}).done(function(){b.items[f].quantity=b.items[f].stock;DeliveryMap.data(b);d+1==
c&&a.resolve()})}):$.ajax({url:m.deleteUrl}).done(function(){d+1==c&&a.resolve()});e=!0}),e&&($("#order-form-part2").hide(),$("#order-loader-holder").html(""),$("#order-loader").clone().appendTo("#order-loader-holder").show())):a.resolve();return a.promise()}()).always(function(){if(e)return $("#order-form-part2").hide(),$("#order-loader-holder").html(""),$("#order-loader").clone().appendTo("#order-loader-holder").show(),window.location.href=window.location.href+"#"+$(".bBuyingLine__eRadio:checked").attr("id"),
window.location.reload(),!1;a.renderUnavailable();$(".order-delivery-holder").each(function(c,d){d=$(d);a.renderDeliveryType(d);0==b.deliveryTypes[d.data("value")].items.length?d.hide():d.show()});var c=0;$.each(b.deliveryTypes,function(b,d){c+=a.getDeliveryTotal(d)+a.getDeliveryPrice(d)});$(".order-total-container").find("[data-assign]").each(function(a,b){Templating.assign($(b),{total:printPrice(c),totalMessage:1==$(".order-delivery-holder:visible").length?"Сумма заказа":"Сумма всех заказов"})});
var d=$("#order-delivery-holder");$.each(b.deliveryTypes,function(a){d.append($('.order-delivery-holder[data-value="'+a+'"]'))});var f=$("#order-form");f.find(".mRed").removeClass("mRed");f.find(".bFormError").remove();DeliveryMap.checkAddressFiled()})},renderDeliveryType:function(a){var b=this,c=this.data(),d=c.deliveryTypes[a.data("value")],e=a.find(".order-item-holder");e.html("");var g=a.find(".order-delivery_price");g.html("");var f=b.getDeliveryPrice(d);if(0<f){var q=Templating.clone($(g.data("template")));
q.find("[data-assign]").each(function(a,b){Templating.assign($(b),{price:f})});q.appendTo(g)}else g.html("Бесплатно");g=a.find(".order-delivery_total-holder");g.html("");var h=b.getDeliveryTotal(d)+b.getDeliveryPrice(d),q=Templating.clone($(g.data("template")));q.find("[data-assign]").each(function(a,b){Templating.assign($(b),{total:printPrice(h),name:"Итого"+("self"!=d.type?" с доставкой":"")})});q.appendTo(g);var m=b.getDeliveryDate(d);$.each(a.find(".order-delivery_date"),function(a,b){var b=$(b),
c=b.data("value"),e=-1!==$.inArray(c,m);b.removeClass("bBuyingDates__eDisable").removeClass("bBuyingDates__eEnable").removeClass("bBuyingDates__eCurrent");d.date==c&&b.addClass("bBuyingDates__eCurrent");e?b.addClass("bBuyingDates__eEnable"):b.addClass("bBuyingDates__eDisable")});$.each(d.items,function(a,d){b.renderItem(e,c.items[d])});a.find("h2 [data-assign]").each(function(b,c){Templating.assign($(c),{displayDate:a.find('.order-delivery_date[data-value="'+d.date+'"]').data("displayValue")})});
a.find(".order-delivery_date").removeClass("bBuyingDates__eCurrent");a.find('.order-delivery_date[data-value="'+d.date+'"]').addClass("bBuyingDates__eCurrent");var g=DeliveryMap.getDeliveryInterval(d,d.date),i=$(a.find("[data-interval-holder]").data("intervalHolder")),j=Templating.clone($(i.data("template")));i.html("");$.each(g,function(a,b){intervalElement=j.clone();var c=b.start_at+","+b.end_at,e="с "+b.start_at+" по "+b.end_at;$.each(intervalElement.find("[data-assign]"),function(a,b){Templating.assign($(b),
{name:e,value:c,date:d.date,deliveryType:d.token})});intervalElement.appendTo(i)});if(!a.find('.bSelect [data-event="onSelect"]').text())(g=c.deliveryTypes[d.token].interval)&&a.find('.bSelect [data-event="onSelect"]').text("с "+g.split(",")[0]+" по "+g.split(",")[1])},renderItem:function(a,b){b.totalFormatted=printPrice(b.total);var c=$(a.data("template")),c=Templating.clone(c);c.find("[data-assign]").each(function(a,c){Templating.assign($(c),b)});c.find(".order-item_delivery-button").remove();a.append(c)},
renderUnavailable:function(){var a=this.data(),b=$("#order-unavailable");b.find(".order-item-holder").html("");a.unavailable.length?($.each(a.unavailable,function(c,d){var e=a.items[d];if(!e)return!1;var g=Templating.clone($("#order-item-template"));e.totalFormatted=printPrice(e.total);g.find("[data-assign]").each(function(a,b){Templating.assign($(b),e)});b.find(".order-item-holder").append(g)}),b.show("fast")):b.hide("fast")},getUndeliveredItem:function(a){var b=this.data(),c={},d=Object.keys(b.items),
e=[];$.each(b.deliveryTypes,function(b,d){if(d.id==a)return c=d,!1});$.each(b.deliveryTypes,function(a,b){("standart"==c.type&&"standart"==b.type||b.token==c.token)&&$.each(b.items,function(a,b){e.push(b)})});return array_values(array_diff(d,e))},renderUndeliveredMessage:function(a){this.getUndeliveredItem(a).length?$("#order-message").html('<span class="red">Некоторые товары не могут быть получены выбранным способом доставки.</span>'):$("#order-message").html("<span>Отличный выбор!</span>")},openShopMap:function(a){this.onShopSelected=
!a?function(a,c){$("#order-form-part2").hide();$("#order-loader").clone().appendTo("#order-loader-holder").show();var d=$("#order-form").data("deliveryMapUrl");DeliveryMap.getRemoteData(d,{deliveryTypeId:a,shopId:c},function(){$("#order-loader-holder").html("");$("#order-form-part2").show("fast");this.render();DeliveryMap.renderUndeliveredMessage(a);DeliveryMap.onDeliveryBlockChange()},!0)}:function(b,c){var d=DeliveryMap.data(),e="self_"+c,g=DeliveryMap.moveItemBlock(a,e);if(!d.deliveryTypes[e].date)d=
DeliveryMap.data(),d.deliveryTypes[e].date=DeliveryMap.getDeliveryDate(d.deliveryTypes[e]).shift(),d.deliveryTypes[e].displayDate=$('.order-delivery-holder[data-value="'+e+'"]').find('.order-delivery_date[data-value="'+d.deliveryTypes[e].date+'"]').data("displayValue"),DeliveryMap.data(d);DeliveryMap.render();g.length&&($('.order-delivery-holder[data-value="'+a+'"]').find(".delivery-message").html('<div class="red">Невозможно переместить товары</div>'),$('.order-delivery-holder[data-value="'+a+'"]').effect("pulsate",
{times:2},1E3,function(){$(this).find(".delivery-message").html("")}));DeliveryMap.onDeliveryBlockChange()};j()},onShopSelected:function(){},onMapClosed:function(a){var b=$(".bBuyingLine__eRadio:checked");regionMap.closePopupMap(function(){$(".mMapPopup").trigger("close")});if("object"===typeof a)a=a.id;DeliveryMap.onShopSelected.apply(DeliveryMap,[b.val(),a])},validate:function(a,b){$("#order-form");var c=!0;if(-1!==$.inArray(a.attr("id"),["order_address_street","order_address_number"])&&!$('.bBuyingLine__eRadio[data-delivery-type="standart"]:checked').length)return!0;
-1!==$.inArray(a.attr("id"),["order_address_street","order_address_number"])&&!a.val()?(c=!1,$("#addressField").find("dd .bFormError").length||showError($("#addressField").find("dd > div:first"),b,!0)):a.is(":radio")&&!a.is(":checked")&&1<a.length?(c=!1,showError(a.first().parent().parent(),b,!1)):a.is(":checkbox")&&!a.is(":checked")&&1==a.length?(c=!1,showError(a.first().parent().parent(),b,!1)):a.is(":text")&&!a.val()&&(c=!1,showError(a,b,!0));return c},onDeliveryBlockChange:function(){console.info("onDeliveryBlockChange");
if(1==$(".order-delivery-holder:visible").length)$("#payment_method_5-field").show(),$("#payment_method_6-field").show();else{var a=function(a){a.hide();a.find("input").is(":checked")&&(a.find("input").removeAttr("checked"),a.find(".mChecked").removeClass("mChecked"))};a($("#payment_method_5-field"));a($("#payment_method_6-field"))}},checkAddressFiled:function(){0<$('.order-delivery-holder[data-type="standart"]:visible').length?$("#addressField").show():$("#addressField").hide()}};var l=$("#mapPopup_shopInfo"),
i=$("#map-info_window-container"),o=$("#order-delivery_map-data").data().value.shops,p;for(p in o)n(o[p]);l.delegate("li","click",function(){DeliveryMap.onMapClosed($(this).data("id"))});h=null;f=0;l.delegate("li","hover",function(){var a=$(this).data("id");h&&clearTimeout(h);a&&a!=f&&(f=a,h=setTimeout(function(){window.regionMap.showInfobox(a)},500))});window.regionMap=new MapWithShops(calcMCenter(o),i,"mapPopup",function(a){i.html(tmpl("mapInfoBlock",a));f=a.id});window.regionMap.addHandler(".shopchoose",
function(a){a=$(a).parent().find(".shopnum").text();DeliveryMap.onMapClosed(a)});window.regionMap.addHandlerMarker("mouseover",function(a){window.regionMap.showInfobox(a.id)});$("#order-loader-holder").html("");$("#order-form-part1").show();$("body").delegate(".mBacket","click",function(a){a.preventDefault();var b=$(this),c=b.data("token"),d=function(){$(this).remove();var a=DeliveryMap.data();$.each(a.deliveryTypes,function(b,d){$.each(d.items,function(b,g){g==c&&(a.deliveryTypes[d.token].items.splice(b,
1),delete a.items[g])})});var b=$.inArray(c,a.unavailable);-1!==b&&a.unavailable.splice(b,1);DeliveryMap.data(a);DeliveryMap.render();DeliveryMap.onDeliveryBlockChange()};$.ajax({async:!1,url:b.attr("href"),success:function(){b.closest(".order-item-container").hide("medium",d)}})});$("body").delegate(".bBuyingLine label","click",function(a){if($(a.target).is("input")){a=$(this).hasClass("mChecked");if("radio"==$(this).find("input").attr("type")){var b=$('.mChecked input[name="'+$(this).find("input").attr("name")+
'"]');b.length&&b.each(function(a,b){$(b).parent("label").removeClass("mChecked")});$(this).addClass("mChecked")}"checkbox"==$(this).find("input").attr("type")&&$(this).toggleClass("mChecked");a||(a=$(this).find('input[type="radio"][data-delivery-type]'),a.length&&($("#order-submit").addClass("disable"),b=$("#order-form").data("deliveryMapUrl"),$("#order-form-part2").hide(),$(".order-shop-button:first").hide(),"self"==a.data("deliveryType")?$(".order-shop-button:first").show():($("#order-loader").clone().appendTo("#order-loader-holder").show(),
DeliveryMap.getRemoteData(b,{deliveryTypeId:a.val()},function(){$("#order-loader-holder").html("");$("#order-form-part2").show("fast");this.render()}),DeliveryMap.renderUndeliveredMessage(a.val())),DeliveryMap.onDeliveryBlockChange()))}});$("body").delegate(".order-shop-button","click",function(a){a.preventDefault();DeliveryMap.openShopMap($(this).data("delivery"))});$("body").delegate(".order-item_delivery-button","click",function(a){a.preventDefault();var a=DeliveryMap.data(),b=$(this),c=Templating.clone($(b.data("template"))),
d=a.items[b.data("value")],e=null;$.each(a.deliveryTypes,function(a,b){$.each(b.items,function(b,c){c==d.token&&(e=a)})});var g=c.find("a");$.each(d.deliveries,function(a,b){if(b.token!=e){var c=g.clone(),f=DeliveryMap.data().deliveryTypes[b.token].date,f={name:b.name+(f?" "+f:""),route:JSON.stringify({item:d.token,from:e,to:b.token})};Templating.assign(c,f);c.insertAfter(g)}});g.remove();c.appendTo(b.parent());c.bind({mouseleave:function(){$(this).remove()},click:function(a){b=$(a.target);if(b.is("a")){a=
b.data("value");DeliveryMap.moveItem(a.item,a.from,a.to);$(this).remove();var c=DeliveryMap.data();if(!c.deliveryTypes[a.to].date)c.deliveryTypes[a.to].date=c.items[a.item].deliveries[a.to].dates[0].value,DeliveryMap.data(c);DeliveryMap.render()}}});c.show()});$("body").delegate(".order-delivery_date-control","click",function(){var a=$(this);if(!$(a).hasClass("mDisabled")){var b=a.parent(),a=parseInt(a.data("value"));b.find('.order-delivery_date[data-week="'+a+'"]').length&&(b.find(".order-delivery_date").hide(),
b.find('.order-delivery_date[data-week="'+a+'"]').show());var c=b.find('.order-delivery_date-control[data-direction="prev"]');b.find('.order-delivery_date[data-week="'+(a-1)+'"]').length?(c.data("value",a-1),c.removeClass("mDisabled")):c.addClass("mDisabled");c=b.find('.order-delivery_date-control[data-direction="next"]');b.find('.order-delivery_date[data-week="'+(a+1)+'"]').length?(c.data("value",a+1),c.removeClass("mDisabled")):c.addClass("mDisabled")}});$("body").delegate(".order-delivery_date",
"click",function(){var a=$(this);if(!a.hasClass("bBuyingDates__eDisable")){var b=a.closest(".order-delivery-holder"),c=a.data("value"),d=a.data("displayValue"),e=a.data("value"),d=a.data("displayValue"),b=a.closest(".order-delivery-holder"),c=b.data("value");DeliveryMap.data();a.parent().find(".order-delivery_date").removeClass("bBuyingDates__eCurrent").addClass("bBuyingDates__eEnable");a.removeClass("bBuyingDates__eEnable").addClass("bBuyingDates__eCurrent");b.find("h2 [data-assign]").each(function(a,
b){Templating.assign($(b),{displayDate:d})});a=DeliveryMap.data();a.deliveryTypes[c].date=e;DeliveryMap.data(a)}});$("body").delegate(".bSelect","click",function(){if($(this).hasClass("mDisabled"))return!1;$(this).find(".bSelect__eDropmenu").toggle()});$("body").delegate(".bSelect","mouseleave",function(){if($(this).hasClass("mDisabled"))return!1;var a=$(this).find(".bSelect__eDropmenu");a.is(":visible")&&a.hide()});$("body").delegate(".order-interval","click",function(){var a=$(this),b=DeliveryMap.data();
a.closest(".bSelect").find('[data-event="onSelect"]').text(a.text());a=a.find("[data-value]").data();b.deliveryTypes[a.deliveryType].interval=a.value});$('.bBuyingLine__eRadio"]:checked').length?(DeliveryMap.render(),$("#order-form-part2").show("fast"),DeliveryMap.checkAddressFiled()):window.location.hash&&$(window.location.hash).click();$("#order-submit").data("locked",!1).data("text",$("#order-submit").text()).click(function(a){a.preventDefault();var b=$(this),c=b.closest("form"),a=$(c.data("validator")).data("value");
if(b.data("locked")||b.hasClass("disable"))return!1;c.find(".mRed").removeClass("mRed");c.find(".bFormError").remove();var d=!1;$.each(a,function(a,b){var f=c.find('[name="'+a+'"]:visible');f.length&&!DeliveryMap.validate(f,b)&&(d=!0)});d?$.scrollTo(".bFormError:first",300):(b.text("Оформляю заказ..."),blockDiv.block(),a=c.serializeArray(),a.push({name:"delivery_map",value:JSON.stringify(DeliveryMap.data())}),b.data("locked",!0),$.ajax({url:c.attr("action"),timeout:6E4,async:!0,type:"POST",data:a,
success:function(a){var c=$("#order-form");a.success?(b.text("Готово!"),b.attr("disabled",!0),k("credit_on",null,new Date(0),"/"),window.location=a.data.redirect):a.error&&("invalid"==a.error.code?(c.find(".mRed").removeClass("mRed"),c.find(".bFormError").remove(),$("#order-message").html('<span class="red">'+a.error.message+"</span>"),$.each(a.errors,function(a,b){var d=c.find('[name="'+a+'"]:visible');showError(d,b,!0)}),b.text("Завершить оформление"),blockDiv.unblock()):(alert(a.error.message),
window.location.reload()))},error:function(){b.text(b.data("text"));blockDiv.unblock()},complete:function(){b.data("locked",!1)}}))});PubSub.subscribe("authorize",function(a,b){$("#order_recipient_first_name").val(b.first_name);$("#order_recipient_last_name").val(b.last_name);$("#order_recipient_phonenumbers").val(b.phonenumber+"       ");$("#user-block").hide()});$(".auth-link").bind("click",function(a){a.preventDefault();$(this);$("#login-form, #register-form").data("redirect",!1);$("#auth-block").lightbox_me({centered:!0,
onLoad:function(){$("#auth-block").find("input:first").focus()}})});if("undefined"!==typeof $.mask)$.mask.definitions.n="[()0-9 -]",$("#order_recipient_phonenumbers").mask("8nnnnnnnnnnnnnnnnn",{placeholder:" ",maxlength:10}),$("#order_recipient_phonenumbers").val("8"),$.mask.definitions["*"]="[0-9*]",$("#order_sclub_card_number").mask("* ****** ******",{placeholder:"*"}),$("#order_sclub_card_number")[0].getAttribute("value")&&$("#order_sclub_card_number").val($("#order_sclub_card_number")[0].getAttribute("value")),
$("#order_sclub_card_number").blur(function(){"* ****** ******"===$(this).val()&&($(this).trigger("unmask").val(""),$(this).focus(function(){$("#order_sclub_card_number").mask("* ****** ******",{placeholder:"*"})}))});$("#addressField").find("input").placeholder();var s="Авиамоторная,Автозаводская,Академическая,Александровский сад,Алексеевская,Алтуфьево,Аннино,Арбатская (Арбатско-Покровская линия),Арбатская (Филевская линия,Аэропорт,Бабушкинская,Багратионовская,Баррикадная,Бауманская,Беговая,Белорусская,Беляево,Бибирево,Библиотека имени Ленина,Битцевский парк,Борисовская,Боровицкая,Ботанический сад,Братиславская,Бульвар адмирала Ушакова,Бульвар Дмитрия Донского,Бунинская аллея,Варшавская,ВДНХ,Владыкино,Водный стадион,Войковская,Волгоградский проспект,Волжская,Волоколамская,Воробьевы горы,Выставочная,Выхино,Деловой центр,Динамо,Дмитровская,Добрынинская,Домодедовская,Достоевская,Дубровка,Жулебино,Зябликово,Измайловская,Калужская,Кантемировская,Каховская,Каширская,Киевская,Китай-город,Кожуховская,Коломенская,Комсомольская,Коньково,Красногвардейская,Краснопресненская,Красносельская,Красные ворота,Крестьянская застава,Кропоткинская,Крылатское,Кузнецкий мост,Кузьминки,Кунцевская,Курская,Кутузовская,Ленинский проспект,Лубянка,Люблино,Марксистская,Марьина роща,Марьино,Маяковская,Медведково,Международная,Менделеевская,Митино,Молодежная,Мякинино,Нагатинская,Нагорная,Нахимовский проспект,Новогиреево,Новокузнецкая,Новослободская,Новоясеневская,Новые Черемушки,Октябрьская,Октябрьское поле,Орехово,Отрадное,Охотныйряд,Павелецкая,Парк культуры,Парк Победы,Партизанская,Первомайская,Перово,Петровско-Разумовская,Печатники,Пионерская,Планерная,Площадь Ильича,Площадь Революции,Полежаевская,Полянка,Пражская,Преображенская площадь,Пролетарская,Проспект Вернадского,Проспект Мира,Профсоюзная,Пушкинская,Речной вокзал,Рижская,Римская,Рязанский проспект,Савеловская,Свиблово,Севастопольская,Семеновская,Серпуховская,Славянский бульвар,Смоленская (Арбатско-Покровская линия),Смоленская (Филевская линия),Сокол,Сокольники,Спортивная,Сретенский бульвар,Строгино,Студенческая,Сухаревская,Сходненская,Таганская,Тверская,Театральная,Текстильщики,ТеплыйСтан,Тимирязевская,Третьяковская,Трубная,Тульская,Тургеневская,Тушинская,Улица 1905года,Улица Академика Янгеля,Улица Горчакова,Улица Подбельского,Улица Скобелевская,Улица Старокачаловская,Университет,Филевский парк,Фили,Фрунзенская,Царицыно,Цветной бульвар,Черкизовская,Чертановская,Чеховская,Чистые пруды,Чкаловская,Шаболовская,Шипиловская,Шоссе Энтузиастов,Щелковская,Щукинская,Электрозаводская,Юго-Западная,Южная,Ясенево".split(",");
$("#order_address_metro").autocomplete({source:s,appendTo:"#metrostations",minLength:2}).change(function(){for(var a=0,b=s.length;a<b;a++)if($(this).val()===s[a])return!0;$(this).val("")});$("body").delegate('input[name="order[payment_method_id]"]',"click",function(){"order_payment_method_id_6"===this.id?$("#creditInfo").show():$("#creditInfo").hide()});if($(".bankWrap").length){var r=$(".bankWrap > .bSelect").data("value"),u=$(".bankWrap > .creditHref"),v=$("<div>").addClass("bSelect__eDropmenu"),
t;for(t in r){var w=$("<div>").attr("ref",t).append($("<span>").text(r[t].name));w.click(function(){var a=$(this).attr("ref");$(".bankWrap > .bSelect").find("span:first").text(r[a].name);$('input[name="order[credit_bank_id]"]').val(a);u.find("a").attr("href",r[a].href);u.find("span").text("("+r[a].name+")")});v.append(w)}$(".bankWrap > .bSelect").append(v);DirectCredit.init($("#tsCreditCart").data("value"),$("#creditPrice"))}});
function showError(f,h,k){k&&f.addClass("mRed");f.before('<span class="bFormError mb10 pt5">'+h+"</span>")}function array_intersect(f){var h={},k=arguments.length,n=k-1,j="",l={},i=0,o="";a:for(j in f){i=1;for(;i<k;){l=arguments[i];for(o in l)l[o]===f[j]&&i===n&&(h[j]=f[j]);continue a}}return h}function array_diff(f){var h={},k=arguments.length,n="",j=1,l="",i={};a:for(n in f)for(j=1;j<k;j++){i=arguments[j];for(l in i)if(i[l]===f[n])continue a;h[n]=f[n]}return h}
function array_values(f){var h=[],k="";if(f&&"object"===typeof f&&f.change_key_case)return f.values();for(k in f)h[h.length]=f[k];return h}function array_key_exists(f,h){return!h||h.constructor!==Array&&h.constructor!==Object?!1:f in h}
if(!Object.keys)Object.keys=function(){var f=Object.prototype.hasOwnProperty,h=!{toString:null}.propertyIsEnumerable("toString"),k="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(","),n=k.length;return function(j){if("object"!==typeof j&&"function"!==typeof j||null===j)throw new TypeError("Object.keys called on non-object");var l=[],i;for(i in j)f.call(j,i)&&l.push(i);if(h)for(i=0;i<n;i++)f.call(j,k[i])&&l.push(k[i]);return l}}();
