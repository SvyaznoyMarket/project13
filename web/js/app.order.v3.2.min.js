$(document).ready(function(){window.blockScreen=function(a){$('<img src="/images/ajaxnoti.gif" />').css("display","none").appendTo("body");var b=$("<div>").addClass("noti").html('<div><img src="/images/ajaxnoti.gif" /></br></br> '+a+"</div>");b.appendTo("body");this.block=function(){b.is(":hidden")&&b.lightbox_me({centered:!0,closeClick:!1,closeEsc:!1})};this.unblock=function(){b.trigger("close")}};blockDiv=new blockScreen("Ваш заказ оформляется");Templating={assign:function(a,b){$.each(a.data("assign"),
function(c,d){var e=d[1];$.isArray(e)||(e=[e]);$.each(e,function(a,d){"_value"==d&&(e[a]=b[c])});a[d[0]].apply(a,e);"true"==a.attr("data-replace")&&a.replaceWith(a.text())})},clone:function(a){return $(a.clone().html())}};DeliveryMap={dataHolder:$("#order-delivery_map-data"),data:function(a){if(a)this.dataHolder.data("value",a);else return this.dataHolder.data("value")},getRemoteData:function(a,b,c,d){var e=this,d=d||!1;$("#order-submit").addClass("disable");$.ajax({type:"POST",async:d,timeout:6E4,
url:a,dataType:"json",data:{delivery_type_id:b.deliveryTypeId,shop_id:b.shopId},success:function(a){a=a.data;e.data(a);$.isFunction(c)&&c.call(e,[a])},complete:function(){}})},moveItem:function(a,b,c){var d=this.data(),e=d.items[a];if("undefined"==typeof a||-1==$.inArray(c,Object.keys(e.deliveries)))return!1;$.each(d.deliveryTypes[b].items,function(c,e){e==a&&d.deliveryTypes[b].items.splice(c,1)});d.deliveryTypes[c].items.push(a);this.data(d);return!0},moveItemBlock:function(a,b){if(a==b)return[];
var c=this.data(),d=[],e=c.deliveryTypes[a].items.length;for(i=0;i<e;i++){var f=c.deliveryTypes[a].items[i];array_key_exists(b,c.items[f].deliveries)?c.deliveryTypes[b].items.push(f):d.push(f)}c.deliveryTypes[a].items=d;this.data(c);return d},getDeliveryPrice:function(a){if(!a)return 0;var b=this.data(),c=0;$.each(a.items,function(d,e){var f=b.items[e].deliveries[a.token].price;f>c&&(c=f)});return parseInt(c)},getDeliveryTotal:function(a){var b=this.data(),c=0;$.each(a.items,function(a,e){c+=b.items[e].total});
return parseInt(c)},getDeliveryDate:function(a){var b=this.data(),c=null;$.each(a.items,function(d,e){var f=[];$.each(b.items[e].deliveries[a.token].dates,function(a,b){f.push(b.value)});c=null===c?f:array_intersect(c,f)});return null===c?[]:array_values(c)},getDeliveryInterval:function(a,b){var c=this.data(),d={};$.each(a.items,function(e,f){$.each(c.items[f].deliveries[a.token].dates,function(a,c){c.value==b&&$.each(c.intervals,function(a,b){d[b.start_at+","+b.end_at]=b})})});return d},render:function(){var a=
this,b=this.data();$("#order-submit").removeClass("disable");var c=!0;$.each(b.deliveryTypes,function(a,b){if(b.items.length)return c=!1});if(c){var d=$("#order-form").data("cartUrl");window.location=d?d:"/";return!1}var e=!1;$.when(function(){var a=$.Deferred(),c=b.unavailable.length;c?($.each(b.unavailable,function(d,g){var h=b.items[g];if(!h||0==h.stock||"product"!=h.type||h.quantity<=h.stock)return d+1==c&&a.resolve(),!0;confirm('Вы заказали товар "'+h.name+'" в количестве '+h.quantity+" шт.\nДоступно только "+
h.stock+" шт.\nЗаказать "+h.stock+"шт?")?$.ajax({url:h.deleteUrl}).done(function(){$.ajax({url:h.addUrl}).done(function(){b.items[g].quantity=b.items[g].stock;DeliveryMap.data(b);d+1==c&&a.resolve()})}):$.ajax({url:h.deleteUrl}).done(function(){d+1==c&&a.resolve()});e=!0}),e&&($("#order-form-part2").hide(),$("#order-loader-holder").html(""),$("#order-loader").clone().appendTo("#order-loader-holder").show())):a.resolve();return a.promise()}()).always(function(){if(e)return $("#order-form-part2").hide(),
$("#order-loader-holder").html(""),$("#order-loader").clone().appendTo("#order-loader-holder").show(),window.location.href=window.location.href+"#"+$(".bBuyingLine__eRadio:checked").attr("id"),window.location.reload(),!1;a.renderUnavailable();$(".order-delivery-holder").each(function(c,d){d=$(d);a.renderDeliveryType(d);0==b.deliveryTypes[d.data("value")].items.length?d.hide():d.show()});var c=0;$.each(b.deliveryTypes,function(b,d){c+=a.getDeliveryTotal(d)+a.getDeliveryPrice(d)});$(".order-total-container").find("[data-assign]").each(function(a,
b){Templating.assign($(b),{total:printPrice(c),totalMessage:1==$(".order-delivery-holder:visible").length?"Сумма заказа":"Сумма всех заказов"})});var d=$("#order-delivery-holder");$.each(b.deliveryTypes,function(a){d.append($('.order-delivery-holder[data-value="'+a+'"]'))});var g=$("#order-form");g.find(".mRed").removeClass("mRed");g.find(".bFormError").remove();DeliveryMap.checkAddressFiled()})},renderDeliveryType:function(a){var b=this,c=this.data(),d=c.deliveryTypes[a.data("value")],e=a.find(".order-item-holder");
e.html("");var f=a.find(".order-delivery_price");f.html("");var j=b.getDeliveryPrice(d);if(0<j){var g=Templating.clone($(f.data("template")));g.find("[data-assign]").each(function(a,b){Templating.assign($(b),{price:j})});g.appendTo(f)}else f.html("Бесплатно");f=a.find(".order-delivery_total-holder");f.html("");var l=b.getDeliveryTotal(d)+b.getDeliveryPrice(d),g=Templating.clone($(f.data("template")));g.find("[data-assign]").each(function(a,b){Templating.assign($(b),{total:printPrice(l),name:"Итого"+
("self"!=d.type?" с доставкой":"")})});g.appendTo(f);var h=b.getDeliveryDate(d);$.each(a.find(".order-delivery_date"),function(a,b){var b=$(b),c=b.data("value"),e=-1!==$.inArray(c,h);b.removeClass("bBuyingDates__eDisable").removeClass("bBuyingDates__eEnable").removeClass("bBuyingDates__eCurrent");d.date==c&&b.addClass("bBuyingDates__eCurrent");e?b.addClass("bBuyingDates__eEnable"):b.addClass("bBuyingDates__eDisable")});$.each(d.items,function(a,d){b.renderItem(e,c.items[d])});a.find("h2 [data-assign]").each(function(b,
c){Templating.assign($(c),{displayDate:a.find('.order-delivery_date[data-value="'+d.date+'"]').data("displayValue")})});a.find(".order-delivery_date").removeClass("bBuyingDates__eCurrent");a.find('.order-delivery_date[data-value="'+d.date+'"]').addClass("bBuyingDates__eCurrent");var f=DeliveryMap.getDeliveryInterval(d,d.date),k=$(a.find("[data-interval-holder]").data("intervalHolder")),m=Templating.clone($(k.data("template")));k.html("");$.each(f,function(a,b){intervalElement=m.clone();var c=b.start_at+
","+b.end_at,e="с "+b.start_at+" по "+b.end_at;$.each(intervalElement.find("[data-assign]"),function(a,b){Templating.assign($(b),{name:e,value:c,date:d.date,deliveryType:d.token})});intervalElement.appendTo(k)});if(!a.find('.bSelect [data-event="onSelect"]').text())(f=c.deliveryTypes[d.token].interval)&&a.find('.bSelect [data-event="onSelect"]').text("с "+f.split(",")[0]+" по "+f.split(",")[1])},renderItem:function(a,b){b.totalFormatted=printPrice(b.total);var c=$(a.data("template")),c=Templating.clone(c);
c.find("[data-assign]").each(function(a,c){Templating.assign($(c),b)});c.find(".order-item_delivery-button").remove();a.append(c)},renderUnavailable:function(){var a=this.data(),b=$("#order-unavailable");b.find(".order-item-holder").html("");a.unavailable.length?($.each(a.unavailable,function(c,d){var e=a.items[d];if(!e)return!1;var f=Templating.clone($("#order-item-template"));e.totalFormatted=printPrice(e.total);f.find("[data-assign]").each(function(a,b){Templating.assign($(b),e)});b.find(".order-item-holder").append(f)}),
b.show("fast")):b.hide("fast")},getUndeliveredItem:function(a){var b=this.data(),c={},d=Object.keys(b.items),e=[];$.each(b.deliveryTypes,function(b,d){if(d.id==a)return c=d,!1});$.each(b.deliveryTypes,function(a,b){("standart"==c.type&&"standart"==b.type||b.token==c.token)&&$.each(b.items,function(a,b){e.push(b)})});return array_values(array_diff(d,e))},renderUndeliveredMessage:function(a){this.getUndeliveredItem(a).length?$("#order-message").html('<span class="red">Некоторые товары не могут быть получены выбранным способом доставки.</span>'):
$("#order-message").html("<span>Отличный выбор!</span>")},openShopMap:function(a){this.onShopSelected=!a?function(a,c){$("#order-form-part2").hide();$("#order-loader").clone().appendTo("#order-loader-holder").show();var d=$("#order-form").data("deliveryMapUrl");DeliveryMap.getRemoteData(d,{deliveryTypeId:a,shopId:c},function(){$("#order-loader-holder").html("");$("#order-form-part2").show("fast");this.render();DeliveryMap.renderUndeliveredMessage(a);DeliveryMap.onDeliveryBlockChange()},!0)}:function(b,
c){var d=DeliveryMap.data(),e="self_"+c,f=DeliveryMap.moveItemBlock(a,e);if(!d.deliveryTypes[e].date)d=DeliveryMap.data(),d.deliveryTypes[e].date=DeliveryMap.getDeliveryDate(d.deliveryTypes[e]).shift(),d.deliveryTypes[e].displayDate=$('.order-delivery-holder[data-value="'+e+'"]').find('.order-delivery_date[data-value="'+d.deliveryTypes[e].date+'"]').data("displayValue"),DeliveryMap.data(d);DeliveryMap.render();f.length&&($('.order-delivery-holder[data-value="'+a+'"]').find(".delivery-message").html('<div class="red">Невозможно переместить товары</div>'),
$('.order-delivery-holder[data-value="'+a+'"]').effect("pulsate",{times:2},1E3,function(){$(this).find(".delivery-message").html("")}));DeliveryMap.onDeliveryBlockChange()};regionMap.openMap()},onShopSelected:function(){},onMapClosed:function(a){var b=$(".bBuyingLine__eRadio:checked");regionMap.closeMap();DeliveryMap.onShopSelected.apply(this,[b.val(),a])},validate:function(a,b){$("#order-form");var c=!0;if(-1!==$.inArray(a.attr("id"),["order_address_street","order_address_number"])&&!$('.bBuyingLine__eRadio[data-delivery-type="standart"]:checked').length)return!0;
-1!==$.inArray(a.attr("id"),["order_address_street","order_address_number"])&&!a.val()?(c=!1,$("#addressField").find("dd .bFormError").length||showError($("#addressField").find("dd > div:first"),b,!0)):a.is(":radio")&&!a.is(":checked")&&1<a.length?(c=!1,showError(a.first().parent().parent(),b,!1)):a.is(":checkbox")&&!a.is(":checked")&&1==a.length?(c=!1,showError(a.first().parent().parent(),b,!1)):a.is(":text")&&!a.val()&&(c=!1,showError(a,b,!0));return c},onDeliveryBlockChange:function(){1==$(".order-delivery-holder:visible").length?
$("#payment_method_online-field").show():($("#payment_method_online-field").hide(),$("#payment_method_online-field").find("input").attr("checked",!1),$("#payment_method_online-field").find(".mChecked").removeClass("mChecked"))},checkAddressFiled:function(){0<$('.order-delivery-holder[data-type="standart"]:visible').length?$("#addressField").show():$("#addressField").hide()}};window.regionMap=new MapWithShopsOLD($("#map-center").data("content"),$("#map-info_window-container"),"mapPopup",DeliveryMap.onMapClosed);
$("#order-loader-holder").html("");$("#order-form-part1").show();$("body").delegate(".mBacket","click",function(a){a.preventDefault();var b=$(this),c=b.data("token"),d=function(){$(this).remove();var a=DeliveryMap.data();$.each(a.deliveryTypes,function(b,d){$.each(d.items,function(b,f){f==c&&(a.deliveryTypes[d.token].items.splice(b,1),delete a.items[f])})});var b=$.inArray(c,a.unavailable);-1!==b&&a.unavailable.splice(b,1);DeliveryMap.data(a);DeliveryMap.render();DeliveryMap.onDeliveryBlockChange()};
$.ajax({async:!1,url:b.attr("href"),success:function(){b.closest(".order-item-container").hide("medium",d)}})});$("body").delegate(".bBuyingLine label","click",function(a){if($(a.target).is("input")&&("radio"==$(this).find("input").attr("type")&&(a=$('.mChecked input[name="'+$(this).find("input").attr("name")+'"]'),a.length&&a.each(function(a,b){$(b).parent("label").removeClass("mChecked")}),$(this).addClass("mChecked")),"checkbox"==$(this).find("input").attr("type")&&$(this).toggleClass("mChecked"),
a=$(this).find('input[type="radio"][data-delivery-type]'),a.length)){$("#order-submit").addClass("disable");var b=$("#order-form").data("deliveryMapUrl");$("#order-form-part2").hide();$(".order-shop-button:first").hide();"self"==a.data("deliveryType")?$(".order-shop-button:first").show():($("#order-loader").clone().appendTo("#order-loader-holder").show(),DeliveryMap.getRemoteData(b,{deliveryTypeId:a.val()},function(){$("#order-loader-holder").html("");$("#order-form-part2").show("fast");this.render()}),
DeliveryMap.renderUndeliveredMessage(a.val()));DeliveryMap.onDeliveryBlockChange()}});$("body").delegate(".order-shop-button","click",function(a){a.preventDefault();DeliveryMap.openShopMap($(this).data("delivery"))});$("body").delegate(".order-item_delivery-button","click",function(a){a.preventDefault();var a=DeliveryMap.data(),b=$(this),c=Templating.clone($(b.data("template"))),d=a.items[b.data("value")],e=null;$.each(a.deliveryTypes,function(a,b){$.each(b.items,function(b,c){c==d.token&&(e=a)})});
var f=c.find("a");$.each(d.deliveries,function(a,b){if(b.token!=e){var c=f.clone(),g=DeliveryMap.data().deliveryTypes[b.token].date,g={name:b.name+(g?" "+g:""),route:JSON.stringify({item:d.token,from:e,to:b.token})};Templating.assign(c,g);c.insertAfter(f)}});f.remove();c.appendTo(b.parent());c.bind({mouseleave:function(){$(this).remove()},click:function(a){b=$(a.target);if(b.is("a")){a=b.data("value");DeliveryMap.moveItem(a.item,a.from,a.to);$(this).remove();var c=DeliveryMap.data();if(!c.deliveryTypes[a.to].date)c.deliveryTypes[a.to].date=
c.items[a.item].deliveries[a.to].dates[0].value,DeliveryMap.data(c);DeliveryMap.render()}}});c.show()});$("body").delegate(".order-delivery_date-control","click",function(){var a=$(this);if(!$(a).hasClass("mDisabled")){var b=a.parent(),a=parseInt(a.data("value"));b.find('.order-delivery_date[data-week="'+a+'"]').length&&(b.find(".order-delivery_date").hide(),b.find('.order-delivery_date[data-week="'+a+'"]').show());var c=b.find('.order-delivery_date-control[data-direction="prev"]');b.find('.order-delivery_date[data-week="'+
(a-1)+'"]').length?(c.data("value",a-1),c.removeClass("mDisabled")):c.addClass("mDisabled");c=b.find('.order-delivery_date-control[data-direction="next"]');b.find('.order-delivery_date[data-week="'+(a+1)+'"]').length?(c.data("value",a+1),c.removeClass("mDisabled")):c.addClass("mDisabled")}});$("body").delegate(".order-delivery_date","click",function(){var a=$(this);if(!a.hasClass("bBuyingDates__eDisable")){var b=a.closest(".order-delivery-holder"),c=a.data("value"),d=a.data("displayValue"),e=a.data("value"),
d=a.data("displayValue"),b=a.closest(".order-delivery-holder"),c=b.data("value");DeliveryMap.data();a.parent().find(".order-delivery_date").removeClass("bBuyingDates__eCurrent").addClass("bBuyingDates__eEnable");a.removeClass("bBuyingDates__eEnable").addClass("bBuyingDates__eCurrent");b.find("h2 [data-assign]").each(function(a,b){Templating.assign($(b),{displayDate:d})});a=DeliveryMap.data();a.deliveryTypes[c].date=e;DeliveryMap.data(a)}});$("body").delegate(".bSelect","click",function(){if($(this).hasClass("mDisabled"))return!1;
$(this).find(".bSelect__eDropmenu").toggle()});$("body").delegate(".bSelect","mouseleave",function(){if($(this).hasClass("mDisabled"))return!1;var a=$(this).find(".bSelect__eDropmenu");a.is(":visible")&&a.hide()});$("body").delegate(".order-interval","click",function(){var a=$(this),b=DeliveryMap.data();a.closest(".bSelect").find('[data-event="onSelect"]').text(a.text());a=a.find("[data-value]").data();b.deliveryTypes[a.deliveryType].interval=a.value});$('.bBuyingLine__eRadio"]:checked').length?(DeliveryMap.render(),
$("#order-form-part2").show("fast"),DeliveryMap.checkAddressFiled()):window.location.hash&&$(window.location.hash).click();$("#order-submit").data("locked",!1).data("text",$("#order-submit").text()).click(function(a){a.preventDefault();var b=$(this),c=b.closest("form"),a=$(c.data("validator")).data("value");if(b.data("locked")||b.hasClass("disable"))return!1;c.find(".mRed").removeClass("mRed");c.find(".bFormError").remove();var d=!1;$.each(a,function(a,b){var g=c.find('[name="'+a+'"]:visible');g.length&&
!DeliveryMap.validate(g,b)&&(d=!0)});d?$.scrollTo(".bFormError:first",300):(b.text("Оформляю заказ..."),blockDiv.block(),a=c.serializeArray(),a.push({name:"delivery_map",value:JSON.stringify(DeliveryMap.data())}),b.data("locked",!0),$.ajax({url:c.attr("action"),timeout:6E4,async:!0,type:"POST",data:a,success:function(a){var c=$("#order-form");a.success?(b.text("Готово!"),b.attr("disabled",!0),window.location=a.data.redirect):a.error&&("invalid"==a.error.code?(c.find(".mRed").removeClass("mRed"),c.find(".bFormError").remove(),
$("#order-message").html('<span class="red">'+a.error.message+"</span>"),$.each(a.errors,function(a,b){var d=c.find('[name="'+a+'"]:visible');showError(d,b,!0)}),b.text("Завершить оформление"),blockDiv.unblock()):(alert(a.error.message),window.location.reload()))},error:function(){b.text(b.data("text"));blockDiv.unblock()},complete:function(){b.data("locked",!1)}}))});PubSub.subscribe("authorize",function(a,b){$("#order_recipient_first_name").val(b.first_name);$("#order_recipient_last_name").val(b.last_name);
$("#order_recipient_phonenumbers").val(b.phonenumber+"       ");$("#user-block").hide()});$(".auth-link").bind("click",function(a){a.preventDefault();$(this);$("#login-form, #register-form").data("redirect",!1);$("#auth-block").lightbox_me({centered:!0,onLoad:function(){$("#auth-block").find("input:first").focus()}})});if("undefined"!==typeof $.mask)$.mask.definitions.n="[()0-9 -]",$("#order_recipient_phonenumbers").mask("8nnnnnnnnnnnnnnnnn",{placeholder:" ",maxlength:10}),$("#order_recipient_phonenumbers").val("8"),
$.mask.definitions["*"]="[0-9*]",$("#order_sclub_card_number").mask("9 999999 999999",{placeholder:"*"}),$("#order_sclub_card_number")[0].getAttribute("value")&&$("#order_sclub_card_number").val($("#order_sclub_card_number")[0].getAttribute("value"));$("#addressField").find("input").placeholder();var g="Авиамоторная,Автозаводская,Академическая,Александровский сад,Алексеевская,Алтуфьево,Аннино,Арбатская (Арбатско-Покровская линия),Арбатская (Филевская линия,Аэропорт,Бабушкинская,Багратионовская,Баррикадная,Бауманская,Беговая,Белорусская,Беляево,Бибирево,Библиотека имени Ленина,Битцевский парк,Борисовская,Боровицкая,Ботанический сад,Братиславская,Бульвар адмирала Ушакова,Бульвар Дмитрия Донского,Бунинская аллея,Варшавская,ВДНХ,Владыкино,Водный стадион,Войковская,Волгоградский проспект,Волжская,Волоколамская,Воробьевы горы,Выставочная,Выхино,Деловой центр,Динамо,Дмитровская,Добрынинская,Домодедовская,Достоевская,Дубровка,Жулебино,Зябликово,Измайловская,Калужская,Кантемировская,Каховская,Каширская,Киевская,Китай-город,Кожуховская,Коломенская,Комсомольская,Коньково,Красногвардейская,Краснопресненская,Красносельская,Красные ворота,Крестьянская застава,Кропоткинская,Крылатское,Кузнецкий мост,Кузьминки,Кунцевская,Курская,Кутузовская,Ленинский проспект,Лубянка,Люблино,Марксистская,Марьина роща,Марьино,Маяковская,Медведково,Международная,Менделеевская,Митино,Молодежная,Мякинино,Нагатинская,Нагорная,Нахимовский проспект,Новогиреево,Новокузнецкая,Новослободская,Новоясеневская,Новые Черемушки,Октябрьская,Октябрьское поле,Орехово,Отрадное,Охотныйряд,Павелецкая,Парк культуры,Парк Победы,Партизанская,Первомайская,Перово,Петровско-Разумовская,Печатники,Пионерская,Планерная,Площадь Ильича,Площадь Революции,Полежаевская,Полянка,Пражская,Преображенская площадь,Пролетарская,Проспект Вернадского,Проспект Мира,Профсоюзная,Пушкинская,Речной вокзал,Рижская,Римская,Рязанский проспект,Савеловская,Свиблово,Севастопольская,Семеновская,Серпуховская,Славянский бульвар,Смоленская (Арбатско-Покровская линия),Смоленская (Филевская линия),Сокол,Сокольники,Спортивная,Сретенский бульвар,Строгино,Студенческая,Сухаревская,Сходненская,Таганская,Тверская,Театральная,Текстильщики,ТеплыйСтан,Тимирязевская,Третьяковская,Трубная,Тульская,Тургеневская,Тушинская,Улица 1905года,Улица Академика Янгеля,Улица Горчакова,Улица Подбельского,Улица Скобелевская,Улица Старокачаловская,Университет,Филевский парк,Фили,Фрунзенская,Царицыно,Цветной бульвар,Черкизовская,Чертановская,Чеховская,Чистые пруды,Чкаловская,Шаболовская,Шипиловская,Шоссе Энтузиастов,Щелковская,Щукинская,Электрозаводская,Юго-Западная,Южная,Ясенево".split(",");
$("#order_address_metro").autocomplete({source:g,appendTo:"#metrostations",minLength:2}).change(function(){for(var a=0,b=g.length;a<b;a++)if($(this).val()===g[a])return!0;$(this).val("")})});function showError(g,a,b){b&&g.addClass("mRed");g.before('<span class="bFormError mb10 pt5">'+a+"</span>")}function array_intersect(g){var a={},b=arguments.length,c=b-1,d="",e={},f=0,j="";a:for(d in g){f=1;for(;f<b;){e=arguments[f];for(j in e)e[j]===g[d]&&f===c&&(a[d]=g[d]);continue a}}return a}
function array_diff(g){var a={},b=arguments.length,c="",d=1,e="",f={};a:for(c in g)for(d=1;d<b;d++){f=arguments[d];for(e in f)if(f[e]===g[c])continue a;a[c]=g[c]}return a}function array_values(g){var a=[],b="";if(g&&"object"===typeof g&&g.change_key_case)return g.values();for(b in g)a[a.length]=g[b];return a}function array_key_exists(g,a){return!a||a.constructor!==Array&&a.constructor!==Object?!1:g in a}
if(!Object.keys)Object.keys=function(){var g=Object.prototype.hasOwnProperty,a=!{toString:null}.propertyIsEnumerable("toString"),b="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(","),c=b.length;return function(d){if("object"!==typeof d&&"function"!==typeof d||null===d)throw new TypeError("Object.keys called on non-object");var e=[],f;for(f in d)g.call(d,f)&&e.push(f);if(a)for(f=0;f<c;f++)g.call(d,b[f])&&e.push(b[f]);return e}}();
