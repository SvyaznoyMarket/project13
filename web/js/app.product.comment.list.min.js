/*! Enter - v.40 - 2013-05-07 */$(function(){function e(e,t){var i=parseInt(e.prop("class").replace(/\D/g,""));t.find("div.current").width(30*i).html(i),t.find("div:last").text(e.attr("title")),t.find("input").val(i)}function t(e,t){t||($("#auth-link").length&&($("#auth-block").length&&$("#auth-block h2").text("Чтобы оставить отзыв, авторизуйтесь!"),$("#auth-link").trigger("click")),$("#rating_form").bind("submit.access",function(e){$("#auth-link").trigger("click"),e.preventDefault()}))}var i=$(".filter .filterlink:first"),n=$(".filter .filterlist");i.mouseenter(function(){i.hide(),n.show()}),n.mouseleave(function(){n.hide(),i.show()}),$(".sharebox .sharelink").mouseenter(function(){$(this).next().show()}),$(".sharebox .sharelist").mouseleave(function(){$(this).hide()}),$(".subcomments-trigger").click(function(){$(this).toggleClass("commentlinkopen commentlink"),$(this).next().toggle()}),$(".subcomments-add-trigger").click(function(){$(this).next().toggle()}),$(".addcomment form").submit(function(e){e.preventDefault();var t=$(this),i=t.parent().parent(),n=i.find(".subcomments-trigger"),a=parseInt(n.html().replace(/Комментарии \((\d+)\)/,"$1"));return $.post(t.prop("action"),t.serializeArray(),function(e){var r=['<div class="answer">','<div class="answerleft">','<div class="avatar">.....&nbsp;&nbsp;<img src="/css/skin/img/avatar.png" alt="" width="54" height="54" /></div>',e.data.user_name,"<br/>",'<span class="gray">',e.data.created_at,"</span>","</div>",'<div class="answerright">',e.data.content,"</div>","</div>"];t.find("textarea").val(""),n.html("Комментарии ("+(a+1)+")"),i.find(".commentanswer").append(r.join("")),i.find(".subcomments-add-trigger").click()},"json"),!1}),$("div.ratingscale").each(function(){var t=$(this);t.delegate("a","click",function(){e($(this),t.parent())})}),$("div.ratingbox").delegate("a","click",function(){var t=$("div.ratingbig").parent();e($(this),t)}),PubSub.subscribe("auth try",t),$("#rating_form").bind("submit.check",function(e){var t=$("<div>").css({color:"red",clear:"both"});0==1*$(this).find(".ratingvalue").val()&&($(this).find(".ratingresult").after(t.clone().text("Укажите свою оценку")),e.preventDefault()),""===$(this).find("[name=content_resume]").val()&&($(this).find("[name=content_resume]").after(t.clone().text("Заполните поле")),e.preventDefault())})});