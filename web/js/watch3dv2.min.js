var cnvCompatible=document.createElement("canvas").getContext;
function likemovie(c,b,l,j){this.mvblock=$(c);if(!this.mvblock.length||!l||40!=l.length||j&&40!=j.length)return!1;var b=b?b:{},a=this,p=null,m=null,q=null;this.completenessIntrvl=600;this.rollingIntrvl=400;var h=[500,1200,2500];this.initres=h[0];var e=[1,11,21,31],i=e;this.howmany=40;this.zoom=1;this.imgzoom=0;this.mode="slow";var d=null,n=null,y=null,g=null,x=null,G=[[110,28],[121,28],[132,27],[143,26],[154,25],[165,24],[176,23],[187,21],[198,19],[209,16],[220,13],[209,10],[198,7],[187,6],[176,5],
[165,4],[154,3],[143,2],[132,1],[121,0],[110,0],[99,0],[88,1],[77,2],[66,3],[55,4],[44,5],[33,6],[22,7],[11,10],[0,13],[11,16],[22,19],[33,21],[44,23],[55,24],[66,25],[77,26],[88,27],[99,28]],u=0,r=1,z=1,D=!1,k=!1;j||(k=!0);var H=0,E="roll",A=0,B=0,s={x:0,y:0},v=null,C=!0,F=!1;this.prefx="ib";for(var t=[],w=0,c=0;c<a.howmany;c++)t[c]=0;this.api=function(){b.zoomer&&(y=$(b.zoomer));n=new loadbar;n.create(b.loadbar?b.loadbar:0);this.makeLite();b.rollindex&&(x=$(b.rollindex));this.toggle()};this.toggle=
function(){if(!b.propriate)return!1;for(var a in b.propriate)C?$(b.propriate[a]).show():$(b.propriate[a]).hide();C=!C};this.hideVersions=function(){b&&b.makeLite&&$(b.makeLite).hide();b&&b.makeFull&&$(b.makeFull).hide()};this.makeLite=function(){var f=null;b&&b.makeLite?f=$(b.makeLite):(f=$("<div>").attr("id","ml").html("make lite").appendTo("body"),b.makeLite="#ml");f.css("cursor","pointer").bind({click:function(){a.turnVersion();f.hide();a.makeFull()}})};this.makeFull=function(){var f=null;b&&b.makeFull?
f=$(b.makeFull):(f=$("<div>").attr("id","mf").html("make full").appendTo("body"),b.makeFull="#mf");f.css("cursor","pointer").show().bind({click:function(){a.turnVersion();f.hide()}})};this.rollshift=function(a){a=0>a-5?34+a:a-5;x.css("left",G[a][0]).css("top",G[a][1])};this.manualRollEnable=function(){x.bind({mousedown:function(f){f.preventDefault();a.stopRolling();F=!0;x.offset()}});$(document).mousemove(function(f){if(F){var d=f.pageX,f=f.pageY,b=x.offset();11<Math.abs(b.left-d)&&(mouseIsLeft=b.left>
d?!0:!1,mouseIsTop=b.top>f?!0:!1,r-1-5<a.howmany/4||r-1-5>=3*(a.howmany/4)?r-1-5==3*(a.howmany/4)?(!mouseIsLeft&&!mouseIsTop&&a.nextSrc(1),!mouseIsLeft&&mouseIsTop&&a.nextSrc(-1)):mouseIsLeft?a.nextSrc(-1):a.nextSrc(1):r-1-5==a.howmany/4?(mouseIsLeft&&mouseIsTop&&a.nextSrc(1),mouseIsLeft&&!mouseIsTop&&a.nextSrc(-1)):!mouseIsLeft?a.nextSrc(-1):a.nextSrc(1))}});$(document).mouseup(function(){F=!1})};this.breakPreload=function(){clearInterval(m);if(k)for(var f=0;f<a.howmany;f++)1===t[f]&&(t[f]=0);for(f=
i.length;0<f;f--)document.getElementById(a.prefx+i[f-1])&&(document.getElementById(a.prefx+i[f-1]).complete||$("#"+a.prefx+i[f-1]).remove());a.prefx=k?"is":"ib"};this.preloadImages=function(f){if(!k&&$("#"+a.prefx+"1").length)for(var f=[],d=0;d<a.howmany,5>f.length;d++)2!=t[d]&&f.push(d+1);for(var d=k?l:j,b=$("<div>"),c=0;c<f.length;c++)$("<img>").attr("src",d[f[c]-1]).attr("id",a.prefx+f[c]).appendTo(b).bind("load",function(){a.preloadOnebyone($(this).attr("id").replace(/\D/g,""))});k?$("#nvis500").append(b):
$("#nvis").append(b)};this.preloadOnebyone=function(d){if(k||C)return!1;t[d-1]=2;for(var b=0,c=0;c<a.howmany;c++)2==t[c]&&b++;n.update(100*(b/a.howmany));if(b==a.howmany){for(b=0;b<a.howmany;b++)e[b]=b+1;a.hideVersions();a.manualRollEnable();a.stop4slides();a.createFrontier();a.mode="medium";a.startRolling(70)}else{w=99;for(b=d;b<a.howmany+1*d;b++)if(!t[b%a.howmany]){w=b%a.howmany;break}99>w&&(t[w]=1,$("<img>").attr("src",j[w]).attr("id",a.prefx+(1*w+1)).appendTo($("#nvis")).bind("load",function(){a.preloadOnebyone($(this).attr("id").replace(/\D/g,
""))}))}};this.checkComplete=function(){for(var d=0,b=0;b<i.length;b++)document.getElementById(a.prefx+i[b]).complete&&d++;k&&n.update(100*((e.length-i.length+d)/a.howmany));d==i.length&&(k?a.nextLoad():(clearInterval(m),a.show4slides()))};this.nextLoad=function(){if(e.length==this.howmany)clearInterval(m),this.hideVersions(),this.manualRollEnable(),this.speedupRolling(70);else{switch(e.length){case 4:this.startRolling();i=[6,16,26,36];break;case 8:i=[3,9,13,19,23,29,33,39];break;case 16:i=[4,8,14,
18,24,28,34,38];break;case 24:i=[2,10,12,20,22,30,32,40];break;case 32:i=[5,7,15,17,25,27,35,37]}this.preloadImages(i);e=e.concat(i);e.sort(function(a,d){return a-d})}};this.turnVersion=function(){k=!k;n.update(0);k?(this.stop4slides(),this.breakPreload(),this.preloadImages(i),this.createFrontier(),g.setDimensionProps(h[0]),this.zoom=1,g.zoom=1,g.noZoom(),g.addDrag(),m=setInterval(a.checkComplete,a.completenessIntrvl),4<e.length&&this.startRolling()):(this.stopRolling(),d.hide(),this.breakPreload(),
i=[1,11,21,31],this.preloadImages(i),m=setInterval(a.checkComplete,a.completenessIntrvl),this.getInitSize(),g.setDimensionProps(h[this.zoom-1]),g.zoom=this.zoom,g.addZoom(s),g.addDrag())};this.startRolling=function(d){D=!0;d&&(a.rollingIntrvl=d);p=setInterval(function(){a.nextSrc(1)},a.rollingIntrvl)};this.stopRolling=function(){D=!1;clearInterval(p)};this.speedupRolling=function(d){a.rollingIntrvl=d;D&&(clearInterval(p),p=setInterval(function(){a.nextSrc(1)},a.rollingIntrvl))};this.nextSrc=function(b){switch(a.mode){case "medium":var c=
0;a:for(;c<e.length;c++)if(e[c]==r){r=!c&&0>b?e[e.length-1]:e[(c+1*b)%e.length];break a}break;case "slow":31==r&&4<e.length?a.mode="medium":r=(r+10)%this.howmany}cnvCompatible&&!k?(d.attr("ref",r),v.clearRect(0,0,2500,2500),v.drawImage(document.getElementById(a.prefx+r),s.x,s.y,h[g.zoom-1],h[g.zoom-1])):(b=k?l:j,a.mvblock.hide(),d.attr("src",b[r-1]),a.mvblock.show());a.rollshift(r-1)};this.show4slides=function(){for(var b=!0;b;)z=(z+10)%a.howmany,document.getElementById(a.prefx+z).complete&&(b=!1);
d.fadeOut(1E3);setTimeout(function(){d.attr("src",j[z-1])},1E3);d.fadeIn(1E3);q=setTimeout(a.show4slides,3E3)};this.stop4slides=function(){q&&clearTimeout(q)};this.start=function(){A=a.mvblock.innerWidth();B=a.mvblock.innerHeight();$("<div>").hide().attr("id","nvis500").appendTo("body");$("<div>").hide().attr("id","nvis").appendTo("body");this.preloadImages(e);m=setInterval(a.checkComplete,a.completenessIntrvl);a.api();this.initres=this.getInitSize();var c=k?l[0]:j[0];d=$("<img>").attr({src:c,width:a.initres,
height:a.initres}).attr("id","ivn").css({position:"relative",left:Math.round((a.mvblock.innerWidth()-a.initres)/2),top:Math.round((a.mvblock.innerHeight()-a.initres)/2)});d.appendTo(a.mvblock);k&&($(b.makeLite).hide(),d.bind({mousedown:function(a){u=a.pageX},click:function(){a.stopRolling()},dblclick:function(){a.startRolling()}}),g=new gigaimage(d,a.zoom,y,a.rollanddrop))};this.createFrontier=function(){!cnvCompatible||k?(this.mvblock.die(".cnve"),d.bind({mousedown:function(a){u=a.pageX},click:function(){a.stopRolling()},
dblclick:function(){a.startRolling()}}),this.mvblock.css("text-align","left"),g=new gigaimage(d,a.zoom,y,a.rollanddrop),g.addZoom(),$(window).resize(function(){1==a.zoom&&d.css("left",Math.round((a.mvblock.innerWidth()-a.initres)/2)).css("top",Math.round((a.mvblock.innerHeight()-a.initres)/2))})):($("#ivn").remove(),g&&g.destroy(),d=$("<canvas>").attr({id:"ivn",width:A,height:B}),d.appendTo(this.mvblock),v=document.getElementById("ivn").getContext("2d"),v.drawImage(document.getElementById(a.prefx+
"1"),Math.round((A-a.initres)/2),Math.round((B-a.initres)/2),a.initres,a.initres),s={x:Math.round((A-a.initres)/2),y:Math.round((B-a.initres)/2)},this.mvblock.live({"mousedown.cnve":function(a){u=a.pageX},"click.cnve":function(){a.stopRolling()},"dblclick.cnve":function(){a.startRolling()}}),g=new gigaimage(d,a.zoom,y,a.rollanddrop),g.addZoom(s),$(window).resize(function(){document.getElementById("ivn").width=a.mvblock.innerWidth();document.getElementById("ivn").height=a.mvblock.innerHeight()}))};
this.hide=function(){$(d).hide();e.length!=this.howmany&&this.breakPreload();k||e.length==this.howmany?this.stopRolling():this.stop4slides();this.toggle()};this.show=function(){$(d).show();k&&g.addZoom(s);g.addDrag();e.length!=this.howmany&&(this.preloadImages(i),k&&(m=setInterval(a.checkComplete,a.completenessIntrvl)));k||e.length==this.howmany?this.startRolling():this.show4slides();this.toggle()};this.rollanddrop=function(b,c,n){H!=n&&(H=n,E=Math.abs(c.x)>Math.abs(c.y)?"roll":"drop");"roll"==E&&
Math.abs(b.pageX-u)>20*g.zoom?(c=0<b.pageX-u?1:-1,u=b.pageX,a.nextSrc(c)):"drop"==E&&(!cnvCompatible||k?(b=parseInt(d.css("top"),10),d.css("top",c.y+b)):(s.y+=c.y,v.clearRect(0,0,2500,2500),v.drawImage(document.getElementById(a.prefx+r),s.x,s.y,h[g.zoom-1],h[g.zoom-1])))};this.getInitSize=function(){if(k)this.zoom=1;else{var a=$(window).width();this.zoom=1030>a?1:1590>a?2:3}return this.imgzoom=h[this.zoom-1]}}
function gigaimage(c,b,l,j){var a=this,p="CANVAS"==c[0].tagName,m=!1,q=[500,1200,2500],h=0,e=null;this.zoom=b;l&&(e=new zoomer(l,a));if(cnvCompatible&&p)var i=document.getElementById(c.attr("id")).getContext("2d");this.cursorHand=function(){c.css("cursor","url(/css/skin/cursor/cursor_1.png), url(/css/skin/cursor/cursor_1.gif), url(/css/skin/cursor/cursor_ie_1.cur), crosshair")};a.cursorHand();this.cursorDrag=function(){c.css("cursor","url(/css/skin/cursor/cursor_2.png), url(/css/skin/cursor/cursor_2.gif), url(/css/skin/cursor/cursor_ie_2.cur), move")};
this.setDimensionProps=function(b){var n=c.parent(),b=b?b:q[a.zoom-1];c.attr("width",b).attr("height",b).css("left",(n.width()-b)/2).css("top",(n.height()-b)/2)};(!cnvCompatible||!p)&&this.setDimensionProps();this.zoomIn=function(){var a=c.parent(),b=a.offset();this.fixzoom(1,Math.round(a.width()/2)+b.left,Math.round($("#bigpopup").height()/2)+b.top)};this.zoomOut=function(){var a=c.parent(),b=a.offset();this.fixzoom(-1,Math.round(a.width()/2)+b.left,Math.round($("#bigpopup").height()/2)+b.top)};
c.parent();this.fixzoom=function(b,n,h){var g=this.zoom;if(!(1==a.zoom&&0>b||3==a.zoom&&0<b)){0<b?a.zoom++:a.zoom--;b/=Math.abs(b);g=q[a.zoom-1]/q[g-1];if(!cnvCompatible||!p){var j=c.parent().offset(),l=parseInt(c.css("left"),10),m=parseInt(c.css("top"),10),n=n-(j.left+l),h=h-(j.top+m),l=l-b*Math.abs(Math.round(n*(1-g))),m=m-b*Math.abs(Math.round(h*(1-g)));c.attr("width",q[a.zoom-1]).attr("height",q[a.zoom-1]).css({left:l,top:m})}else j=c.parent().offset(),n-=j.left+cnvimg.x,h-=j.top+cnvimg.y,cnvimg.x-=
b*Math.abs(Math.round(n*(1-g))),cnvimg.y-=b*Math.abs(Math.round(h*(1-g))),n=c.attr("ref"),i.clearRect(0,0,2500,2500),i.drawImage(document.getElementById(lkmv.prefx+n),cnvimg.x,cnvimg.y,q[a.zoom-1],q[a.zoom-1]);e&&(0<b?e.plus():e.minus())}};this.addZoom=function(b){cnvimg=b;c.bind({mousewheel:function(b,c){b.preventDefault();a.fixzoom(c,b.pageX,b.pageY)}});e.show()};this.noZoom=function(){c.unbind("mousewheel");e.hide()};this.addDrag=function(){function b(c){init={pageX:c.pageX,pageY:c.pageY};h=c.timeStamp;
m=!0;a.cursorDrag()}c.bind({mousedown:function(a){a.preventDefault();b(a)}});"undefined"!==typeof window.addEventListener&&(c[0].addEventListener("touchstart",function(a){a.preventDefault();b(a)},!1),c[0].addEventListener("touchmove",function(b){m&&(b.preventDefault(),a.action(b,{x:b.pageX-init.pageX,y:b.pageY-init.pageY},h,a.zoom),init.pageX=b.pageX,init.pageY=b.pageY)},!1),c[0].addEventListener("touchend",function(){m=!1;a.cursorHand()},!1))};this.addDrag();$(document).bind("mousemove.zoomer",function(b){m&&
(b.preventDefault(),a.action(b,{x:b.pageX-init.pageX,y:b.pageY-init.pageY},h,a.zoom),init.pageX=b.pageX,init.pageY=b.pageY)});$(document).bind("mouseup.zoomer",function(){m=!1;a.cursorHand()});this.dropping=function(a,b){var i=parseInt(c.css("left"),10),e=parseInt(c.css("top"),10);c.css("top",b.y+e).css("left",b.x+i)};this.action=j?j:this.dropping;this.destroy=function(){c.unbind("mousedown");c.unbind("mousewheel");c.unbind("touchstart");c.unbind("touchmove");c.unbind("touchend");c.remove();$(document).unbind(".zoomer");
for(var b in this)delete this[b];a=null}}function loadbar(){this.percentage=0;var c=null;this.create=function(b){b?c=$(b):(c=$("<div>").attr("id","loadbar").html("0%"),c.appendTo("body"));return c};this.update=function(b){this.percentage=b?Math.round(b):0;c.html(this.percentage+"%");100==this.percentage&&this.destroy()};this.destroy=function(){setTimeout(function(){c.fadeOut("slow")},2E3)}}
function zoomer(c,b){if(!c)return!1;var l=$(".zoomind",c),j=!1,a=[54,28,-2],p=function(b){return b<a[2]+6?1:b<a[1]-4?2:b<a[1]+4?3:b<a[0]-6?4:5},m=l.parent().offset().top,q=3,h=3,e=[5,3,1];l.css("top",a[b.zoom-1]);this.hide=function(){c.hide()};this.show=function(){c.show()};$("b.plus",c).bind("click",function(){b.zoomIn&&b.zoomIn()});$("b.minus",c).bind("click",function(){b.zoomOut&&b.zoomOut()});l.bind({mousedown:function(a){j=!0;a.preventDefault();a.stopPropagation()},mouseup:function(){j=!1}});
$("b.zoomind",c).parent().bind({mousemove:function(a){if(j&&(a.preventDefault(),a.stopPropagation(),a=a.pageY-m-3,55>a&&-3<a)){l.css("top",a);var c=q-p(a);Math.abs(c)&&(p(a)!=h&&p(a)%2)&&(0>p(a)-h?b.zoomIn():b.zoomOut(),h=p(a));2==Math.abs(c)?(0>c?b.zoomIn():b.zoomOut(),h=p(a)):3<=Math.abs(c)&&(0>c?(b.zoomIn(),b.zoomIn()):(b.zoomOut(),b.zoomOut()),h=p(a));q=p(a)}},mouseleave:function(){}});this.minus=function(){j||(l.css("top",a[b.zoom-1]),h=e[b.zoom-1],q=e[b.zoom-1])};this.plus=function(){j||(l.css("top",
a[b.zoom-1]),h=e[b.zoom-1],q=e[b.zoom-1])}};
