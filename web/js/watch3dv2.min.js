var cnvCompatible=document.createElement("canvas").getContext;
function likemovie(d,b,k,j){this.mvblock=$(d);if(!this.mvblock.length)return false;if(!k||k.length!=40||j&&j.length!=40)return false;var b=b?b:{},a=this,l=null,m=null,n=null;this.completenessIntrvl=600;this.rollingIntrvl=400;var h=[500,1200,2500];this.initres=h[0];var e=[1,11,21,31],f=e;this.howmany=40;this.zoom=1;this.imgzoom=0;this.mode="slow";var c=null,v=null,x=null,g=null,w=null,F=[[110,28],[121,28],[132,27],[143,26],[154,25],[165,24],[176,23],[187,21],[198,19],[209,16],[220,13],[209,10],[198,
7],[187,6],[176,5],[165,4],[154,3],[143,2],[132,1],[121,0],[110,0],[99,0],[88,1],[77,2],[66,3],[55,4],[44,5],[33,6],[22,7],[11,10],[0,13],[11,16],[22,19],[33,21],[44,23],[55,24],[66,25],[77,26],[88,27],[99,28]],q=0,p=1,y=1,C=false,i=false;j||(i=true);var G=0,D="roll",z=0,A=0,r={x:0,y:0},t=null,B=true,E=false;this.prefx="ib";for(var s=[],u=0,d=0;d<a.howmany;d++)s[d]=0;this.api=function(){b.zoomer&&(x=$(b.zoomer));v=new loadbar;v.create(b.loadbar?b.loadbar:0);this.makeLite();b.rollindex&&(w=$(b.rollindex));
this.toggle()};this.toggle=function(){if(!b.propriate)return false;for(var a in b.propriate)B?$(b.propriate[a]).show():$(b.propriate[a]).hide();B=!B};this.hideVersions=function(){b&&b.makeLite&&$(b.makeLite).hide();b&&b.makeFull&&$(b.makeFull).hide()};this.makeLite=function(){var o=null;b&&b.makeLite?o=$(b.makeLite):(o=$("<div>").attr("id","ml").html("make lite").appendTo("body"),b.makeLite="#ml");o.css("cursor","pointer").bind({click:function(){a.turnVersion();o.hide();a.makeFull()}})};this.makeFull=
function(){var o=null;b&&b.makeFull?o=$(b.makeFull):(o=$("<div>").attr("id","mf").html("make full").appendTo("body"),b.makeFull="#mf");o.css("cursor","pointer").show().bind({click:function(){a.turnVersion();o.hide()}})};this.rollshift=function(a){a=a-5<0?34+a:a-5;w.css("left",F[a][0]).css("top",F[a][1])};this.manualRollEnable=function(){w.bind({mousedown:function(o){o.preventDefault();a.stopRolling();E=true;w.offset()}});$(document).mousemove(function(o){if(E){var c=o.pageX,o=o.pageY,b=w.offset();
Math.abs(b.left-c)>11&&(mouseIsLeft=b.left>c?true:false,mouseIsTop=b.top>o?true:false,p-1-5<a.howmany/4||p-1-5>=a.howmany/4*3?p-1-5==a.howmany/4*3?(!mouseIsLeft&&!mouseIsTop&&a.nextSrc(1),!mouseIsLeft&&mouseIsTop&&a.nextSrc(-1)):mouseIsLeft?a.nextSrc(-1):a.nextSrc(1):p-1-5==a.howmany/4?(mouseIsLeft&&mouseIsTop&&a.nextSrc(1),mouseIsLeft&&!mouseIsTop&&a.nextSrc(-1)):!mouseIsLeft?a.nextSrc(-1):a.nextSrc(1))}});$(document).mouseup(function(){E=false})};this.breakPreload=function(){clearInterval(m);if(i)for(var c=
0;c<a.howmany;c++)s[c]===1&&(s[c]=0);for(c=f.length;c>0;c--)document.getElementById(a.prefx+f[c-1]).complete||$("#"+a.prefx+f[c-1]).remove();a.prefx=i?"is":"ib"};this.preloadImages=function(c){if(!i&&$("#"+a.prefx+"1").length)for(var c=[],b=0;c.length<5;b++)s[b]!=2&&c.push(b+1);for(var b=i?k:j,d=$("<div>"),f=0;f<c.length;f++)$("<img>").attr("src",b[c[f]-1]).attr("id",a.prefx+c[f]).appendTo(d).bind("load",function(){a.preloadOnebyone($(this).attr("id").replace(/\D/g,""))});i?$("#nvis500").append(d):
$("#nvis").append(d)};this.preloadOnebyone=function(c){if(i||B)return false;s[c-1]=2;for(var b=0,d=0;d<a.howmany;d++)s[d]==2&&b++;v.update(b/a.howmany*100);if(b==a.howmany){for(b=0;b<a.howmany;b++)e[b]=b+1;a.hideVersions();a.manualRollEnable();a.stop4slides();a.createFrontier();a.mode="medium";a.startRolling(70)}else{u=99;for(b=c;b<a.howmany+c*1;b++)if(!s[b%a.howmany]){u=b%a.howmany;break}u<99&&(s[u]=1,$("<img>").attr("src",j[u]).attr("id",a.prefx+(u*1+1)).appendTo($("#nvis")).bind("load",function(){a.preloadOnebyone($(this).attr("id").replace(/\D/g,
""))}))}};this.checkComplete=function(){for(var c=0,b=0;b<f.length;b++)document.getElementById(a.prefx+f[b]).complete&&c++;i&&v.update((e.length-f.length+c)/a.howmany*100);c==f.length&&(i?a.nextLoad():(clearInterval(m),a.show4slides()))};this.nextLoad=function(){if(e.length==this.howmany)clearInterval(m),this.hideVersions(),this.manualRollEnable(),this.speedupRolling(70);else{switch(e.length){case 4:this.startRolling();f=[6,16,26,36];break;case 8:f=[3,9,13,19,23,29,33,39];break;case 16:f=[4,8,14,
18,24,28,34,38];break;case 24:f=[2,10,12,20,22,30,32,40];break;case 32:f=[5,7,15,17,25,27,35,37]}this.preloadImages(f);e=e.concat(f);e.sort(function(a,c){return a-c})}};this.turnVersion=function(){i=!i;v.update(0);i?(this.stop4slides(),this.breakPreload(),this.preloadImages(f),this.createFrontier(),g.setDimensionProps(h[0]),this.zoom=1,g.zoom=1,g.noZoom(),g.addDrag(),m=setInterval(a.checkComplete,a.completenessIntrvl),e.length>4&&this.startRolling()):(this.stopRolling(),c.hide(),this.breakPreload(),
f=[1,11,21,31],this.preloadImages(f),m=setInterval(a.checkComplete,a.completenessIntrvl),this.getInitSize(),g.setDimensionProps(h[this.zoom-1]),g.zoom=this.zoom,g.addZoom(r),g.addDrag())};this.startRolling=function(c){C=true;if(c)a.rollingIntrvl=c;l=setInterval(function(){a.nextSrc(1)},a.rollingIntrvl)};this.stopRolling=function(){C=false;clearInterval(l)};this.speedupRolling=function(c){a.rollingIntrvl=c;C&&(clearInterval(l),l=setInterval(function(){a.nextSrc(1)},a.rollingIntrvl))};this.nextSrc=
function(b){switch(a.mode){case "medium":var d=0;a:for(;d<e.length;d++)if(e[d]==p){p=!d&&b<0?e[e.length-1]:e[(d+1*b)%e.length];break a}break;case "slow":p==31&&e.length>4?a.mode="medium":p=(p+10)%this.howmany}cnvCompatible&&!i?(c.attr("ref",p),t.clearRect(0,0,2500,2500),t.drawImage(document.getElementById(a.prefx+p),r.x,r.y,h[g.zoom-1],h[g.zoom-1])):(b=i?k:j,a.mvblock.hide(),c.attr("src",b[p-1]),a.mvblock.show());a.rollshift(p-1)};this.show4slides=function(){for(var b=true;b;)y=(y+10)%a.howmany,document.getElementById(a.prefx+
y).complete&&(b=false);c.fadeOut(1E3);setTimeout(function(){c.attr("src",j[y-1])},1E3);c.fadeIn(1E3);n=setTimeout(a.show4slides,3E3)};this.stop4slides=function(){n&&clearTimeout(n)};this.start=function(){z=a.mvblock.innerWidth();A=a.mvblock.innerHeight();$("<div>").hide().attr("id","nvis500").appendTo("body");$("<div>").hide().attr("id","nvis").appendTo("body");this.preloadImages(e);m=setInterval(a.checkComplete,a.completenessIntrvl);a.api();this.initres=this.getInitSize();var d=i?k[0]:j[0];c=$("<img>").attr({src:d,
width:a.initres,height:a.initres}).attr("id","ivn").css({position:"relative",left:Math.round((a.mvblock.innerWidth()-a.initres)/2),top:Math.round((a.mvblock.innerHeight()-a.initres)/2)});c.appendTo(a.mvblock);i&&($(b.makeLite).hide(),c.bind({mousedown:function(a){q=a.pageX},click:function(){a.stopRolling()},dblclick:function(){a.startRolling()}}),g=new gigaimage(c,a.zoom,x,a.rollanddrop))};this.createFrontier=function(){!cnvCompatible||i?(this.mvblock.die(".cnve"),c.bind({mousedown:function(a){q=
a.pageX},click:function(){a.stopRolling()},dblclick:function(){a.startRolling()}}),this.mvblock.css("text-align","left"),g=new gigaimage(c,a.zoom,x,a.rollanddrop),g.addZoom(),$(window).resize(function(){a.zoom==1&&c.css("left",Math.round((a.mvblock.innerWidth()-a.initres)/2)).css("top",Math.round((a.mvblock.innerHeight()-a.initres)/2))})):($("#ivn").remove(),g&&g.destroy(),c=$("<canvas>").attr({id:"ivn",width:z,height:A}),c.appendTo(this.mvblock),t=document.getElementById("ivn").getContext("2d"),
t.drawImage(document.getElementById(a.prefx+"1"),Math.round((z-a.initres)/2),Math.round((A-a.initres)/2),a.initres,a.initres),r={x:Math.round((z-a.initres)/2),y:Math.round((A-a.initres)/2)},this.mvblock.live({"mousedown.cnve":function(a){q=a.pageX},"click.cnve":function(){a.stopRolling()},"dblclick.cnve":function(){a.startRolling()}}),g=new gigaimage(c,a.zoom,x,a.rollanddrop),g.addZoom(r),$(window).resize(function(){document.getElementById("ivn").width=a.mvblock.innerWidth();document.getElementById("ivn").height=
a.mvblock.innerHeight()}))};this.hide=function(){$(c).hide();e.length!=this.howmany&&this.breakPreload();i||e.length==this.howmany?this.stopRolling():this.stop4slides();this.toggle()};this.show=function(){$(c).show();i&&g.addZoom(r);g.addDrag();e.length!=this.howmany&&(this.preloadImages(f),i&&(m=setInterval(a.checkComplete,a.completenessIntrvl)));i||e.length==this.howmany?this.startRolling():this.show4slides();this.toggle()};this.rollanddrop=function(b,d,f){G!=f&&(G=f,D=Math.abs(d.x)>Math.abs(d.y)?
"roll":"drop");D=="roll"&&Math.abs(b.pageX-q)>20*g.zoom?(d=b.pageX-q>0?1:-1,q=b.pageX,a.nextSrc(d)):D=="drop"&&(!cnvCompatible||i?(b=parseInt(c.css("top"),10),c.css("top",d.y+b)):(r.y+=d.y,t.clearRect(0,0,2500,2500),t.drawImage(document.getElementById(a.prefx+p),r.x,r.y,h[g.zoom-1],h[g.zoom-1])))};this.getInitSize=function(){if(i)this.zoom=1;else{var a=$(window).width();this.zoom=a<1030?1:a<1590?2:3}return this.imgzoom=h[this.zoom-1]}}
function gigaimage(d,b,k,j){var a=this,l=d[0].tagName=="CANVAS",m=false,n=[500,1200,2500],h=0,e=null;this.zoom=b;k&&(e=new zoomer(k,a));if(cnvCompatible&&l)var f=document.getElementById(d.attr("id")).getContext("2d");this.cursorHand=function(){d.css("cursor","url(/css/skin/cursor/cursor_1.png), url(/css/skin/cursor/cursor_1.gif), url(/css/skin/cursor/cursor_ie_1.cur), crosshair")};a.cursorHand();this.cursorDrag=function(){d.css("cursor","url(/css/skin/cursor/cursor_2.png), url(/css/skin/cursor/cursor_2.gif), url(/css/skin/cursor/cursor_ie_2.cur), move")};
this.setDimensionProps=function(c){c=c?c:n[a.zoom-1];d.attr("width",c).attr("height",c).css("left",Math.round((d.parent().innerWidth()-c)/2)).css("top",Math.round((d.parent().innerHeight()-c)/2))};(!cnvCompatible||!l)&&this.setDimensionProps();this.zoomIn=function(){var a=d.parent(),b=a.offset();this.fixzoom(1,Math.round(a.width()/2)+b.left,Math.round(a.height()/2)+b.top)};this.zoomOut=function(){var a=d.parent(),b=a.offset();this.fixzoom(-1,Math.round(a.width()/2)+b.left,Math.round(a.height()/2)+
b.top)};d.parent();this.fixzoom=function(b,h,j){var g=this.zoom;if(!(a.zoom==1&&b<0||a.zoom==3&&b>0)){b>0?a.zoom++:a.zoom--;b/=Math.abs(b);g=n[a.zoom-1]/n[g-1];if(!cnvCompatible||!l){var k=d.parent().offset(),m=parseInt(d.css("left"),10),q=parseInt(d.css("top"),10);h-=k.left+m;j-=k.top+q;m-=b*Math.abs(Math.round(h*(1-g)));q-=b*Math.abs(Math.round(j*(1-g)));d.attr("width",n[a.zoom-1]).attr("height",n[a.zoom-1]).css({left:m,top:q})}else k=d.parent().offset(),h-=k.left+cnvimg.x,j-=k.top+cnvimg.y,cnvimg.x-=
b*Math.abs(Math.round(h*(1-g))),cnvimg.y-=b*Math.abs(Math.round(j*(1-g))),h=d.attr("ref"),f.clearRect(0,0,2500,2500),f.drawImage(document.getElementById(lkmv.prefx+h),cnvimg.x,cnvimg.y,n[a.zoom-1],n[a.zoom-1]);e&&(b>0?e.plus():e.minus())}};this.addZoom=function(b){cnvimg=b;d.bind({mousewheel:function(b,c){b.preventDefault();a.fixzoom(c,b.pageX,b.pageY)}});e.show()};this.noZoom=function(){d.unbind("mousewheel");e.hide()};this.addDrag=function(){d.bind({mousedown:function(b){b.preventDefault();init=
{pageX:b.pageX,pageY:b.pageY};h=b.timeStamp;m=true;a.cursorDrag()}})};this.addDrag();$(document).bind("mousemove.zoomer",function(b){if(m)b.preventDefault(),a.action(b,{x:b.pageX-init.pageX,y:b.pageY-init.pageY},h,a.zoom),init.pageX=b.pageX,init.pageY=b.pageY});$(document).bind("mouseup.zoomer",function(){m=false;a.cursorHand()});this.dropping=function(a,b){var f=parseInt(d.css("left"),10),e=parseInt(d.css("top"),10);d.css("top",b.y+e).css("left",b.x+f)};this.action=j?j:this.dropping;this.destroy=
function(){d.unbind("mousedown");d.unbind("mousewheel");d.remove();$(document).unbind(".zoomer");for(var b in this)delete this[b];a=null}}function loadbar(){this.percentage=0;var d=null;this.create=function(b){b?d=$(b):(d=$("<div>").attr("id","loadbar").html("0%"),d.appendTo("body"));return d};this.update=function(b){this.percentage=b?Math.round(b):0;d.html(this.percentage+"%");this.percentage==100&&this.destroy()};this.destroy=function(){setTimeout(function(){d.fadeOut("slow")},2E3)}}
function zoomer(d,b){if(!d)return false;var k=$(".zoomind",d),j=false,a=[54,28,-2],l=function(b){return b<a[2]+6?1:b<a[1]-4?2:b<a[1]+4?3:b<a[0]-6?4:5},m=k.parent().offset().top,n=3,h=3,e=[5,3,1];k.css("top",a[b.zoom-1]);this.hide=function(){d.hide()};this.show=function(){d.show()};$("b.plus",d).bind("click",function(){b.zoomIn&&b.zoomIn()});$("b.minus",d).bind("click",function(){b.zoomOut&&b.zoomOut()});k.bind({mousedown:function(a){j=true;a.preventDefault();a.stopPropagation()},mouseup:function(){j=
false}});$("b.zoomind",d).parent().bind({mousemove:function(a){if(j&&(a.preventDefault(),a.stopPropagation(),a=a.pageY-m-3,a<55&&a>-3)){k.css("top",a);var c=n-l(a);Math.abs(c)&&l(a)!=h&&l(a)%2&&(l(a)-h<0?b.zoomIn():b.zoomOut(),h=l(a));Math.abs(c)==2?(c<0?b.zoomIn():b.zoomOut(),h=l(a)):Math.abs(c)>=3&&(c<0?(b.zoomIn(),b.zoomIn()):(b.zoomOut(),b.zoomOut()),h=l(a));n=l(a)}},mouseleave:function(){}});this.minus=function(){j||(k.css("top",a[b.zoom-1]),h=e[b.zoom-1],n=e[b.zoom-1])};this.plus=function(){j||
(k.css("top",a[b.zoom-1]),h=e[b.zoom-1],n=e[b.zoom-1])}};
