var menuDelayLvl1=300,menuDelayLvl2=500,triangleOffset=15,lastHoverLvl1=null,checkedItemLvl1=null,hoverNowLvl1=!1,lastHoverLvl2=null,checkedItemLvl2=null,currentMenuItemDimensions=null,menuLevel2Dimensions=null,menuLevel3Dimensions=null,pointA={x:0,y:0},pointB={x:0,y:0},pointC={x:0,y:0},cursorNow={x:0,y:0};activateItemLvl1=function(e){lastHoverLvl1=new Date,checkedItemLvl1=e,$(".bMainMenuLevel-2__eItem").removeClass("hover"),e.addClass("hover")},menuHoverInLvl1=function(){var e=$(this);lastHoverLvl1=new Date,hoverNowLvl1=!0,setTimeout(function(){hoverNowLvl1&&new Date-lastHoverLvl1>menuDelayLvl1&&activateItemLvl1(e)},menuDelayLvl1+20)},menuMouseLeaveLvl1=function(){var e=$(this);e.removeClass("hover"),hoverNowLvl1=!1},createTriangle=function(){pointA={x:cursorNow.x,y:cursorNow.y-$(window).scrollTop()},pointB={x:menuLevel3Dimensions.left-triangleOffset,y:menuLevel3Dimensions.top-$(window).scrollTop()},pointC={x:menuLevel3Dimensions.left-triangleOffset,y:menuLevel3Dimensions.top+menuLevel3Dimensions.height-$(window).scrollTop()}},menuCheckTriangle=function(){var e=(pointA.x-cursorNow.x)*(pointB.y-pointA.y)-(pointB.x-pointA.x)*(pointA.y-cursorNow.y),t=(pointB.x-cursorNow.x)*(pointC.y-pointB.y)-(pointC.x-pointB.x)*(pointB.y-cursorNow.y),i=(pointC.x-cursorNow.x)*(pointA.y-pointC.y)-(pointA.x-pointC.x)*(pointC.y-cursorNow.y);return e>=0&&t>=0&&i>=0||0>=e&&0>=t&&0>=i||cursorNow.x>=pointB.x&&cursorNow.x<=pointB.x+triangleOffset&&cursorNow.y>=pointB.y&&cursorNow.y<=pointC.y?!0:!1},menuMoveLvl2=function(e){cursorNow={x:e.pageX,y:e.pageY-$(window).scrollTop()};var t=$(this);t.attr("class")==checkedItemLvl2.attr("class")&&(buildTriangle(t),lastHoverLvl2=new Date),checkHoverLvl2(t)},activateItemLvl2=function(e){checkedItemLvl2=e,e.addClass("hover"),lastHoverLvl2=new Date,buildTriangle(e)},menuHoverInLvl2=function(){var e=$(this);checkHoverLvl2(e),e.addClass("hoverNowLvl2"),lastHoverLvl2&&menuDelayLvl2>=new Date-lastHoverLvl2&&menuCheckTriangle()&&setTimeout(function(){e.hasClass("hoverNowLvl2")&&new Date-lastHoverLvl2>menuDelayLvl2&&checkHoverLvl2(e)},menuDelayLvl2+20)},menuMouseLeaveLvl2=function(){var e=$(this);e.removeClass("hoverNowLvl2")},checkHoverLvl2=function(e){lastHoverLvl2?(!menuCheckTriangle()||lastHoverLvl2&&new Date-lastHoverLvl2>menuDelayLvl2&&menuCheckTriangle())&&(checkedItemLvl2.removeClass("hover"),activateItemLvl2(e)):activateItemLvl2(e)},buildTriangle=function(e){currentMenuItemDimensions=getDimensions(e),menuLevel2Dimensions=getDimensions(e.find(".bMainMenuLevel-3"));var t=e.find(".bMainMenuLevel-2__eTitle")[0].offsetWidth;menuLevel3Dimensions={top:menuLevel2Dimensions.top,left:menuLevel2Dimensions.left+t,width:menuLevel2Dimensions.width-t,height:menuLevel2Dimensions.height},createTriangle()},getDimensions=function(e){var t=$(e).width(),i=$(e).height();e=e[0];for(var r=0,a=0;e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop);)r+=e.offsetLeft-e.scrollLeft,a+=e.offsetTop-e.scrollTop,e=e.offsetParent;return{top:a,left:r,width:t,height:i}},$(".bMainMenuLevel-1__eItem").mouseenter(menuHoverInLvl1),$(".bMainMenuLevel-1__eItem").mouseleave(menuMouseLeaveLvl1),$(".bMainMenuLevel-2__eItem").mouseenter(menuHoverInLvl2),$(".bMainMenuLevel-2__eItem").mousemove(menuMoveLvl2),$(".bMainMenuLevel-2__eItem").mouseleave(menuMouseLeaveLvl2);