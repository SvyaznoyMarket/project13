CREATE TABLE `creator` (`id` BIGINT AUTO_INCREMENT, `name` VARCHAR(255) NOT NULL, PRIMARY KEY(`id`)) ENGINE = INNODB;
CREATE TABLE `product` (`id` BIGINT AUTO_INCREMENT, `name` VARCHAR(255) NOT NULL, `type_id` BIGINT NOT NULL, `creator_id` BIGINT NOT NULL, `category_id` BIGINT NOT NULL, `view_show` TINYINT(1) DEFAULT '0' NOT NULL, `view_list` TINYINT(1) DEFAULT '0' NOT NULL, INDEX `type_id_idx` (`type_id`), INDEX `creator_id_idx` (`creator_id`), INDEX `category_id_idx` (`category_id`), PRIMARY KEY(`id`)) ENGINE = INNODB;
CREATE TABLE `product_category` (`id` BIGINT AUTO_INCREMENT, `name` VARCHAR(255) NOT NULL, PRIMARY KEY(`id`)) ENGINE = INNODB;
CREATE TABLE `product_photo` (`id` BIGINT AUTO_INCREMENT, `name` VARCHAR(255) NOT NULL, `product_id` BIGINT NOT NULL, `view_show` TINYINT(1) DEFAULT '0' NOT NULL, `view_list` TINYINT(1) DEFAULT '0' NOT NULL, INDEX `product_id_idx` (`product_id`), PRIMARY KEY(`id`)) ENGINE = INNODB;
CREATE TABLE `product_property` (`id` BIGINT AUTO_INCREMENT, `name` VARCHAR(255) NOT NULL, `type` VARCHAR(20) DEFAULT 'string' NOT NULL, `is_multiple` TINYINT(1) DEFAULT '0' NOT NULL, PRIMARY KEY(`id`)) ENGINE = INNODB;
CREATE TABLE `product_property_option` (`id` BIGINT AUTO_INCREMENT, `property_id` BIGINT NOT NULL, `value` VARCHAR(255) NOT NULL, `position` INT DEFAULT 1 NOT NULL, INDEX `property_id_idx` (`property_id`), PRIMARY KEY(`id`)) ENGINE = INNODB;
CREATE TABLE `product_property_relation` (`id` BIGINT AUTO_INCREMENT, `name` VARCHAR(255), `property_id` BIGINT NOT NULL, `product_id` BIGINT NOT NULL, `option_id` BIGINT, `value_string` VARCHAR(255), `value_text` TEXT, INDEX `property_id_idx` (`property_id`), INDEX `product_id_idx` (`product_id`), PRIMARY KEY(`id`)) ENGINE = INNODB;
CREATE TABLE `product_type` (`id` BIGINT AUTO_INCREMENT, `name` VARCHAR(255) NOT NULL, PRIMARY KEY(`id`)) ENGINE = INNODB;
CREATE TABLE `product_type_property_relation` (`name` VARCHAR(255), `product_type_id` BIGINT, `property_id` BIGINT, `position` INT DEFAULT 1 NOT NULL, `view_show` TINYINT(1) DEFAULT '0' NOT NULL, `view_list` TINYINT(1) DEFAULT '0' NOT NULL, PRIMARY KEY(`product_type_id`, `property_id`)) ENGINE = INNODB;
ALTER TABLE `product` ADD CONSTRAINT `product_type_id_product_type_id` FOREIGN KEY (`type_id`) REFERENCES `product_type`(`id`) ON DELETE RESTRICT;
ALTER TABLE `product` ADD CONSTRAINT `product_creator_id_creator_id` FOREIGN KEY (`creator_id`) REFERENCES `creator`(`id`) ON DELETE RESTRICT;
ALTER TABLE `product` ADD CONSTRAINT `product_category_id_product_category_id` FOREIGN KEY (`category_id`) REFERENCES `product_category`(`id`) ON DELETE RESTRICT;
ALTER TABLE `product_photo` ADD CONSTRAINT `product_photo_product_id_product_id` FOREIGN KEY (`product_id`) REFERENCES `product`(`id`) ON DELETE CASCADE;
ALTER TABLE `product_property_option` ADD CONSTRAINT `product_property_option_property_id_product_property_id` FOREIGN KEY (`property_id`) REFERENCES `product_property`(`id`) ON DELETE CASCADE;
ALTER TABLE `product_property_relation` ADD CONSTRAINT `product_property_relation_property_id_product_property_id` FOREIGN KEY (`property_id`) REFERENCES `product_property`(`id`) ON DELETE CASCADE;
ALTER TABLE `product_property_relation` ADD CONSTRAINT `product_property_relation_product_id_product_id` FOREIGN KEY (`product_id`) REFERENCES `product`(`id`) ON DELETE CASCADE;
ALTER TABLE `product_type_property_relation` ADD CONSTRAINT `product_type_property_relation_property_id_product_property_id` FOREIGN KEY (`property_id`) REFERENCES `product_property`(`id`) ON DELETE CASCADE;
ALTER TABLE `product_type_property_relation` ADD CONSTRAINT `product_type_property_relation_product_type_id_product_type_id` FOREIGN KEY (`product_type_id`) REFERENCES `product_type`(`id`) ON DELETE CASCADE;
