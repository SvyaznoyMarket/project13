<?php

/**
 * GuardUserTable
 *
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class GuardUserTable extends myDoctrineTable
{

  /**
   * Returns an instance of this class.
   *
   * @return object GuardUserTable
   */
  public static function getInstance()
  {
    return Doctrine_Core::getTable('GuardUser');
  }

  /**
   * Retrieves a GuardUser object by email and is_active flag.
   *
   * @param  string  $email The email
   * @param  boolean $isActive The user's status
   *
   * @return GuardUser
   */
  public function retrieveByEmail($email, $isActive = true)
  {
    $q = $this->createQuery('user')
      ->where('user.email = ?', $email)
      ->addWhere('user.is_active = ?', $isActive)
    ;

    return $q->fetchOne();
  }

  /**
   * Retrieves a GuardUser object by phonenumber and is_active flag.
   *
   * @param  string  $phonenumber The email
   * @param  boolean $isActive The user's status
   *
   * @return GuardUser
   */
  public function retrieveByPhonenumber($phonenumber, $isActive = true)
  {
    $q = $this->createQuery('user')
      ->where('user.phonenumber = ?', $phonenumber)
      ->addWhere('user.is_active = ?', $isActive)
    ;

    return $q->fetchOne();
  }

  /**
   * Retrieves a GuardUser object by email or phonenumber and is_active flag.
   *
   * @param  string  $email The email
   * @param  string  $phonenumber The phonenumber
   * @param  boolean $isActive The user's status
   *
   * @return GuardUser
   */
  public function retrieveByEmailOrPhonenumber($email, $phonenumber, $isActive = true)
  {
    $user = false;

    if (!empty($email))
    {
      $user = $this->retrieveByEmail($email);
    }
    elseif (!empty($phonenumber))
    {
      $user = $this->retrieveByPhonenumber($phonenumber);
    }

    return $user;
  }

}