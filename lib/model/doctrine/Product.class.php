<?php

/**
 * Product
 *
 * This class has been auto-generated by the Doctrine ORM Framework
 *
 * @package    enter
 * @subpackage model
 * @author     Связной Маркет
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class Product extends BaseProduct
{
  public function construct()
  {
    $this->mapValue('Parameter', new myDoctrineVirtualCollection());
    $this->mapValue('ParameterGroup', new myDoctrineVirtualCollection());
  }

  public function __toString()
  {
    return (string)$this->name;
  }

  public function toParams()
  {
    return array(
      'product' => $this->token,
    );
  }

  public function getCommentList(array $params = array())
  {
    return ProductCommentTable::getInstance()->getListByProduct($this, $params);
  }

  public function getIsInsale()
  {
    return $this->is_instock;
  }

  public function getParameterByProperty($property_id)
  {
    $return = null;
    foreach ($this->Parameter as $parameter)
    {
      if ($parameter->getProperty()->id != $property_id) continue;

      $return = $parameter;
    }

    return $return;
  }

  public function getFormattedPrice()
  {
    return number_format($this->price, 0, ',', ' ').' руб';
  }

  public function getSimilarProduct(array $params = array())
  {
    return SimilarProductTable::getInstance()->getListByProduct($this, $params);
  }
}
