TagGroup:
  options:
    comment: 'Группа тега'
  columns:
    id:                { type: integer(20), autoincrement: true, primary: true }
    token:             { type: string(255), unique: true, notnull: true, notblank: true }
    name:              { type: string(255), notnull: true, notblank: true }

Tag:
  options:
    comment: 'Тег'
  columns:
    id:                { type: integer(20), autoincrement: true, primary: true }
    group_id:          { type: integer(20), notnull: false, default: null }
    token:             { type: string(255), unique: true, notnull: true, notblank: true }
    name:              { type: string(255), notnull: true, notblank: true }
  relations:
    Group:             { class: TagGroup, foreignAlias: Tag, local: group_id, foreign: id, type: one, foreignType: many, onDelete: SET NULL }

TagProductRelation:
  options:
    comment: 'Связь тега и товара'
  columns:
    tag_id:            { type: integer(20), primary: true, notnull: true }
    product_id:        { type: integer(20), primary: true, notnull: true }
  relations:
    Tag:               { class: Tag, foreignAlias: ProductRelation, local: tag_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }
    Product:           { class: Product, foreignAlias: TagRelation, local: product_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }

TagProductCategoryRelation:
  options:
    comment: 'Связь тега и категории товара'
  columns:
    tag_id:              { type: integer(20), primary: true, notnull: true }
    product_category_id: { type: integer(20), primary: true, notnull: true }
  relations:
    Tag:                 { class: Tag, foreignAlias: ProductCategoryRelation, local: tag_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }
    ProductCategory:     { class: ProductCategory, foreignAlias: TagRelation, local: product_category_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }