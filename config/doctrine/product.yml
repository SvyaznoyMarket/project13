Creator:
  options:
    comment: 'Бренд'
  actAs:
    Timestampable: ~
    Corable:       { push: disable }
  columns:
    id:                { type: integer(20), autoincrement: true, primary: true }
    token:             { type: string(255), unique: true, notnull: true, notblank: true }
    name:              { type: string(255), notnull: true, notblank: true }
    description:       { type: string, notnull: false, default: null }
    is_filter:         { type: boolean, notnull: true, default: false, comment: 'Нужно ли выводить в фильтрах?' }

ProductFilterGroup:
  options:
    comment: 'Группа фильтров товаров'
  actAs: [ Timestampable ]
  columns:
    id:                { type: integer(20), autoincrement: true, primary: true }
    name:              { type: string(255), notnull: true, notblank: true }

ProductFilter:
  options:
    comment: 'Фильтр товара'
  actAs:
    Timestampable: ~
    Corable: { push: disable }
  columns:
    id:                { type: integer(20), autoincrement: true, primary: true }
    name:              { type: string(255), notnull: true, notblank: true }
    type:              { type: enum, length: 10, values: [ choice, range, checkbox ], notnull: true }
    group_id:          { type: integer(20), notnull: true }
    property_id:       { type: integer(20), notnull: true }
    is_multiple:       { type: boolean, notnull: true, default: false, comment: 'Фильтр имеет несколько значений?' }
    position:          { type: integer(4), notnull: true, default: 1, comment: 'Порядок сортировки' }
    value_min:         { type: integer(20), notnull: false, default: null }
    value_max:         { type: integer(20), notnull: false, default: null }
  relations:
    Group:             { class: ProductFilterGroup, foreignAlias: Filter, local: group_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }
    Property:          { class: ProductProperty, foreignAlias: ProductFilter, local: property_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }

ProductCategory:
  options:
    comment: 'Категория товара'
  actAs:
    NestedSet:     { hasManyRoots: true, rootColumnName: root_id }
    Timestampable: ~
    Corable:       { push: disable }
  columns:
    id:                { type: integer(20), autoincrement: true, primary: true }
    core_id:           { type: integer(20), notnull: false, default: null, comment: 'ид записи в Core' }
    core_parent_id:    { type: integer(20), notnull: false, default: null, comment: 'ид родителя записи в Core' }
    core_lft:          { type: integer(20), notnull: false, default: null, comment: 'lft записи в Core' }
    core_rgt:          { type: integer(20), notnull: false, default: null, comment: 'rgt записи в Core' }
    root_id:           { type: integer(20), notnull: false, default: null }
    lft:               { type: integer(20), notnull: false, default: null }
    rgt:               { type: integer(20), notnull: false, default: null }
    level:             { type: integer(4), notnull: false, default: null }
    token:             { type: string(255), notnull: true, notblank: true }
    token_prefix:      { type: string(255), notnull: true }
    name:              { type: string(255), notnull: true, notblank: true }
    filter_group_id:   { type: integer(20), notnull: false, default: null }
    position:          { type: integer(4), notnull: false, default: 0 }
    photo:             { type: string(255), notnull: false, default: null }
    is_active:         { type: boolean, notnull: true, default: false, comment: 'Действующая категория?' }
    is_shown_in_menu:  { type: boolean, notnull: true, default: false, comment: 'Отображать ли категорию в верхнем меню?' }
    has_line:          { type: boolean, notnull: true, default: false, comment: 'Есть серии для отображения' }
    product_view:      { type: enum, length: 10, values: [ compact, expanded ], notnull: true, default: 'compact', comment: 'Вид отображения товаров в списке' }
    seo_title:         { type: text, notnull: false, comment: 'SEO. Заголовок страницы' }
    seo_keywords:      { type: text, notnull: false, comment: 'SEO. Ключевые слова' }
    seo_description:   { type: text, notnull: false, comment: 'SEO. Описание' }
    seo_header:        { type: text, notnull: false, comment: 'SEO заголовок. Используется для генерации нижних breadcrumbs' }
    seo_text:          { type: text, notnull: false, comment: 'SEO текст. Под фильтром категорий' }
  indexes:
    token:
      fields: [ token, token_prefix ]
      type: unique
  relations:
    FilterGroup:       { class: ProductFilterGroup, foreignAlias: Category, local: filter_group_id, foreign: id, type: one, foreignType: many, onDelete: SET NULL }
    ProductType:       { class: ProductType, foreignAlias: ProductCategory, refClass: ProductCategoryTypeRelation, local: product_category_id, foreign: product_type_id, type: many, foreignType: many }
    ProductLine:       { class: ProductLine, foreignAlias: ProductCategory, refClass: ProductCategoryProductLineRelation, local: category_id, foreign: line_id, type: many, foreignType: many }

ProductCategoryProductRelation:
  options:
    comment: 'Связь категорий товара и товара'
  actAs: [ Timestampable ]
  columns:
    product_category_id: { type: integer(20), primary: true, notnull: true }
    product_id:          { type: integer(20), primary: true, notnull: true }
    is_default:          { type: boolean, notnull: true, default: false, comment: 'Это основная категория товара?' }
  relations:
    Category:            { class: ProductCategory, foreignAlias: ProductRelation, local: product_category_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }
    Product:             { class: Product, foreignAlias: CategoryRelation, local: product_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }

ProductCategoryLink:
  options:
    comment: 'Ссылки'
  actAs: [ Timestampable ]
  columns:
    product_category_id: { type: integer(20), notnull: true }
    url:                 { type: string(255), notnull: true, notblank: true }
    name:                { type: string(255), notnull: true, notblank: true }
    position:            { type: integer(3), notnull: false, default: 0 }
  relations:
    Category:            { class: ProductCategory, foreignAlias: Link, local: product_category_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }

ProductType:
  options:
    comment: 'Тип товара'
  actAs:
    Timestampable: ~
    Corable:       { push: disable }
  columns:
    id:                { type: integer(20), autoincrement: true, primary: true }
    token:             { type: string(255), unique: true, notnull: true, notblank: true }
    name:              { type: string(255), notnull: true, notblank: true }
    rating_type_id:    { type: integer(20), notnull: false, default: null }
  relations:
    RatingType:        { class: ProductRatingType, foreignAlias: ProductType, local: rating_type_id, foreign: id, type: one, foreignType: many, onDelete: SET NULL }
    TagGroup:          { class: TagGroup, foreignAlias: ProductType, refClass: TagGroupProductTypeRelation, local: product_type_id, foreign: tag_group_id, type: many, foreignType: many }

ProductCategoryTypeRelation:
  options:
    comment: 'Связь типов и категорий товара'
  actAs: [ Timestampable ]
  columns:
    product_category_id: { type: integer(20), primary: true, notnull: true }
    product_type_id:   { type: integer(20), primary: true, notnull: true }
  relations:
    ProductCategory:   { class: ProductCategory, foreignAlias: ProductTypeRelation, local: product_category_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }
    ProductType:       { class: ProductType, foreignAlias: ProductCategoryRelation, local: product_type_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }

ProductProperty:
  options:
    comment: 'Свойство товара'
  actAs:
    Timestampable: ~
    Corable:       { push: disable }
  columns:
    id:                { type: integer(20), autoincrement: true, primary: true }
    name:              { type: string(255), notnull: true, notblank: true }
    type:              { type: enum, length: 10, values: [ string, select, integer, float, text, boolean, date ], notnull: true, default: string, comment: 'Тип свойства: строка, значение из справочника (опция свойства), текст' }
    is_multiple:       { type: boolean, notnull: true, default: false, comment: 'Свойство имеет несколько значений?' }
    unit:              { type: string(255), notnull: false, default: null, comment: 'Единица измерения' }
    pattern:           { type: string(255), notnull: false, default: '%value% %unit%', comment: 'Шаблон для создания значения свойства с единицей измерения для отображения' }
    hint:              { type: string, notnull: false, default: null, comment: 'Подсказка' }
    description:       { type: string, notnull: false, default: true }
  relations:
    ProductType:       { class: ProductType, foreignAlias: Property, refClass: ProductTypePropertyRelation, local: property_id, foreign: product_type_id, type: many, foreignType: many }
    Group:             { class: ProductPropertyGroup, foreignAlias: Property, refClass: ProductTypePropertyRelation, local: property_id, foreign: group_id, type: many, foreignType: many }

ProductPropertyGroup:
  options:
    comment: 'Группа свойств товара'
  actAs:
    Timestampable: ~
    Corable:       { push: disable }
  columns:
    id:                { type: integer(20), autoincrement: true, primary: true }
    name:              { type: string(255), notnull: false, default: null }
#    product_type_id:   { type: integer(20), notnull: true }
    position:          { type: integer(4), notnull: true, default: 1, comment: 'Порядок сортировки' }
  relations:
    ProductType:       { class: ProductType, foreignAlias: PropertyGroup, refClass: ProductTypePropertyGroupRelation, local: property_group_id, foreign: product_type_id, type: many, foreignType: many }

ProductTypePropertyGroupRelation:
  options:
    comment: 'Связь груупы свойств и типа товара'
  actAs: [ Timestampable ]
  columns:
    product_type_id:   { type: integer(20), primary: true, notnull: true }
    property_group_id: { type: integer(20), primary: true, notnull: true }
    position:          { type: integer(4), notnull: true, default: 1, comment: 'Порядок сортировки' }
  relations:
    ProductType:       { class: ProductType, foreignAlias: PropertyGroupRelation, local: product_type_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }
    PropertyGroup:     { class: ProductPropertyGroup, foreignAlias: ProductTypeRelation, local: property_group_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }

ProductTypePropertyRelation:
  options:
    comment: 'Связь типов и свойств товара'
  actAs: [ Timestampable ]
  columns:
    product_type_id:   { type: integer(20), primary: true, notnull: true }
    property_id:       { type: integer(20), primary: true, notnull: true }
    group_id:          { type: integer(20), notnull: false, default: null }
    name:              { type: string(255), notnull: false, default: null }
    position:          { type: integer(4), notnull: true, default: 1, comment: 'Порядок сортировки' }
    group_position:    { type: integer(4), notnull: true, default: 1, comment: 'Порядок сортировки в группе свойств товара' }
    view_show:         { type: boolean, notnull: true, default: false, comment: 'Показывать свойство в карточке товара?' }
    view_list:         { type: boolean, notnull: true, default: false, comment: 'Показывать свойство в списке товаров?' }
  relations:
    ProductType:       { class: ProductType, foreignAlias: PropertyRelation, local: product_type_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }
    Property:          { class: ProductProperty, foreignAlias: ProductTypeRelation, local: property_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }
    Group:             { class: ProductPropertyGroup, foreignAlias: PropertyRelation, local: group_id, foreign: id, type: one, foreignType: many, onDelete: SET NULL }

ProductPropertyOption:
  options:
    comment: 'Опции свойства товара'
  actAs:
    Timestampable: ~
    Corable:       { push: disable }
  columns:
    id:                { type: integer(20), autoincrement: true, primary: true }
    property_id:       { type: integer(20), notnull: true }
    value:             { type: string(255), notnull: true, notblank: true, comment: 'Значение опции' }
    unit:              { type: string(255), notnull: false, default: null, comment: 'Единица измерения' }
    position:          { type: integer(4), notnull: true, default: 1, comment: 'Порядок сортировки' }
  relations:
    Property:          { class: ProductProperty, foreignAlias: Option, local: property_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }

Product:
  options:
    comment: 'Товар'
  actAs:
    Timestampable: ~
    Corable:       { push: disable }
  #listeners: [ myDoctrineRecordListener ]
  columns:
    id:                { type: integer(20), autoincrement: true, primary: true }
    token:             { type: string(255), notnull: true, notblank: true }
    token_prefix:      { type: string(255), notnull: false, default: null }
    barcode:           { type: string(255), notnull: false, default: null }
    article:           { type: string(255), notnull: false, default: null }
    name:              { type: string(255), notnull: true, notblank: true }
    prefix:            { type: string(255), notnull: false, default: null }
    type_id:           { type: integer(20), notnull: true }
    core_label_id:     { type: integer(20), notnull: false, default: null }
    creator_id:        { type: integer(20), notnull: false, default: null }
    line_id:           { type: integer(20), notnull: false, default: null }
    model_id:          { type: integer(20), notnull: false, default: null }
#    category_id:       { type: integer(20), notnull: true }
#    group_id:          { type: integer(20), notnull: false, default: null }
    status_id:         { type: integer(20), notnull: false, default: null }
    set_id:            { type: integer(20), notnull: false, default: null }
    tagline:           { type: string(255), notnull: false, default: null }
    preview:           { type: string, notnull: false, default: null, comment: 'Анонс' }
    view:              { type: enum, length: 10, values: [ default, kit ], notnull: true, default: 'default' }
    view_show:         { type: boolean, notnull: true, default: false, comment: 'Показывать товар по прямой ссылке?' }
    view_list:         { type: boolean, notnull: true, default: false, comment: 'Показывать товар в списке категорий?' }
    is_instock:        { type: boolean, notnull: true, default: false }
    is_lines_main:     { type: boolean, notnull: true, default: false, comment: 'Главный товар в линии?' }
    is_model:          { type: boolean, notnull: true, default: false, comment: 'Главные товар среди моделей?' }
    description:       { type: text, notnull: false, default: null, comment: 'Описание товара' }
    main_photo:        { type: string(255), notnull: false, default: null }
    rating:            { type: 'decimal(18,14)', notnull: true, default: 0, comment: 'Рейтинг товара' }
    rating_quantity:   { type: integer(4), notnull: true, default: 0, comment: 'Количество голосов пользователей' }
    price:             { type: 'decimal(12,2)', notnull: true, default: 0, comment: 'Цена товара' }
    score:             { type: 'decimal(10,5)', notnull: true, default: 0, comment: 'Внутренний рейтинг' }
  indexes:
    token:
      fields: [ token, token_prefix ]
      type: unique
  relations:
    Type:              { class: ProductType, foreignAlias: Product, local: type_id, foreign: id, type: one, foreignType: many, onDelete: RESTRICT }
    Creator:           { class: Creator, foreignAlias: Product, local: creator_id, foreign: id, type: one, foreignType: many, onDelete: RESTRICT }
    Category:          { class: ProductCategory, foreignAlias: Product, refClass: ProductCategoryProductRelation, local: product_id, foreign: product_category_id, type: many, foreignType: many }
    Property:          { class: ProductProperty, foreignAlias: Product, refClass: ProductPropertyRelation, local: product_id, foreign: property_id, type: many, foreignType: many }
#    Group:             { class: ProductGroup, foreignAlias: Product, local: group_id, foreign: id, type: one, foreignType: many, onDelete: SET NULL }
    Line:              { class: ProductLine, foreignAlias: Product, local: line_id, foreign: id, type: one, foreignType: many, onDelete: SET NULL }
    Model:             { class: Product, foreignAlias: SubProduct, local: model_id, foreign: id, type: one, foreignType: many, onDelete: SET NULL }
    ModelProperty:     { class: ProductProperty, foreignAlias: MainModelProduct, refClass: ProductModelPropertyRelation, local: product_id, foreign: product_property_id, type: many, foreignType: many }
    Part:              { class: Product, foreignAlias: Kit, refClass: ProductKitRelation, local: kit_id, foreign: part_id, type: many, foreignType: many }

ProductPropertyRelation:
  options:
    comment: 'Связь продукта и свойства продукта'
  actAs: [ Timestampable ]
  columns:
    id:                { type: integer(20), autoincrement: true, primary: true }
    name:              { type: string(255), notnull: false, default: null }
    product_id:        { type: integer(20), notnull: true }
    property_id:       { type: integer(20), notnull: true }
    option_id:         { type: integer(20), notnull: false, default: null }
    value_integer:     { type: integer(20), notnull: false, default: null }
    value_float:       { type: 'decimal(10,4)', notnull: false, default: null }
    value_string:      { type: string(2000), notnull: false, default: null }
    value_text:        { type: string, notnull: false, default: null }
    value_boolean:     { type: boolean, notnull: false, default: null }
    value:             { type: string(255), notnull: false, default: null, comment: 'Значение свойства для отображения' }
    unit:              { type: string(255), notnull: false, default: null, comment: 'Единица измерения' }
  relations:
    Product:           { class: Product, foreignAlias: PropertyRelation, local: product_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }
    Property:          { class: ProductProperty, foreignAlias: ProductRelation, local: property_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }
    Option:            { class: ProductPropertyOption, foreignAlias: ProductPropertyRelation, local: option_id, foreign: id, type: one, foreignType: many, onDelete: SET NULL }

ProductPhoto:
  options:
    comment: 'Фото товара'
  actAs:
   Timestampable: ~
   Corable:       { push: disable }
  columns:
    id:                { type: integer(20), autoincrement: true, primary: true }
    name:              { type: string(255), notnull: true, notblank: true }
    resource:          { type: string(255), notnull: true, notblank: true }
    product_id:        { type: integer(20), notnull: true }
    view_show:         { type: boolean, notnull: true, default: false, comment: 'Показывать фото в карточке товара?' }
    view_list:         { type: boolean, notnull: true, default: false, comment: 'показывать фото в списке товаров?' }
  relations:
    Product:           { class: Product, foreignAlias: Photo, local: product_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }

ProductPhoto3D:
  options:
    comment: '3D фото товара'
  actAs:
   Timestampable: ~
   Corable:       { push: disable }
  columns:
    id:                { type: integer(20), autoincrement: true, primary: true }
    name:              { type: string(255), notnull: true, notblank: true }
    resource:          { type: string(255), notnull: true, notblank: true }
    product_id:        { type: integer(20), notnull: true }
    position:          { type: integer(4), notnull: true, comment: 'Порядок отображения' }
  relations:
    Product:           { class: Product, foreignAlias: Photo3D, local: product_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }

ProductComment:
  options:
    comment: 'Комментарии товара'
  actAs:
    NestedSet:     { hasManyRoots: true, rootColumnName: product_id }
    Timestampable: ~
    Corable:       { check: isRoot }
  columns:
    id:                { type: integer(20), autoincrement: true, primary: true }
    core_parent_id:    { type: integer(20), notnull: false, default: null, comment: 'ид родителя в Core' }
    core_user_id:      { type: integer(20), notnull: false, default: null, comment: 'ид пользователя в Core' }
    product_id:        { type: integer(20), notnull: true }
    parent_id:         { type: integer(20), notnull: true, default: 0}
    lft:               { type: integer(20), notnull: true }
    rgt:               { type: integer(20), notnull: true }
    level:             { type: integer(4), notnull: true }
    user_id:           { type: integer(20), notnull: false, default: null }
    content:           { type: text, notnull: true, notblank: true, comment: 'Текст комментария' }
    helpful:           { type: integer(4), notnull: true, default: 0, comment: 'Количество полезных оценок отзыва' }
    unhelpful:         { type: integer(4), notnull: true, default: 0, comment: 'Количество бесполезных оценок отзыва' }
    is_recomend:       { type: boolean, notnull: true, default: false }
    rating:            { type: integer(1), notnull: false, default: null, comment: 'рейтинг 1-5' }
  relations:
    Product:           { class: Product, foreignAlias: Comment, local: product_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }
    User:              { class: User, foreignAlias: Comment, local: user_id, foreign: id, type: one, foreignType: many, onDelete: SET NULL }

#ProductGroup:
#  options:
#    comment: 'Группировка товаров'
#  actAs: [ Timestampable ]
#  columns:
#    id:                { type: integer(20), autoincrement: true, primary: true }
#    name:              { type: string(255) }
#  relations:
#    Property:          { foreignAlias: ProductGroup, class: ProductProperty, refClass: ProductGroupPropertyRelation }

ProductModelPropertyRelation:
  options:
    comment: 'Связь модели и свойств, которые будут различны для модели'
  actAs: [ Timestampable ]
  columns:
    product_property_id:  { type: integer(20), notnull: true }
    product_id:           { type: integer(20), notnull: true }
    position:             { type: integer(4), notnull: true, default: 1, comment: 'Порядок отображения' }
    is_image:             { type: boolean, notnull: true, default: false, comment: 'Выводить ли у характеристики картинку товара?' }
  relations:
    Property:             { class: ProductProperty, foreignAlias: ProductModelRelation, local: product_property_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }
    MainProduct:          { class: Product, foreignAlias: ProductPropertyModelRelation, local: product_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }
    #Product:              { class: Product, foreignAlias: MainProductPropertyModelRelation, local: product_id, foreign: model_id, type: one, foreignType: many, onDelete: CASCADE }

ProductRatingType:
  options:
    comment: 'Тип рейтинга товара'
  actAs: [ Timestampable ]
  columns:
    id:                { type: integer(20), autoincrement: true, primary: true }
    token:             { type: string(255), unique: true, notnull: true, notblank: true }
    name:              { type: string(255), notnull: true, notblank: true }

ProductRatingTypeProperty:
  options:
    comment: 'Свойства типа рейтинга товара'
  actAs:
    Timestampable: ~
    Corable:       ~
  columns:
    id:                { type: integer(20), autoincrement: true, primary: true }
    type_id:           { type: integer(20), notnull: true }
    token:             { type: string(255), unique: true, notnull: true, notblank: true }
    name:              { type: string(255), notnull: true, notblank: true }
    position:          { type: integer(4), notnull: true, default: 1, comment: 'Порядок сортировки' }
  relations:
    Type:              { class: ProductRatingType, foreignAlias: Property, local: type_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }

ProductPriceList:
  options:
    comment: 'Прайс-листы'
  actAs:
    #Timestampable: ~
    Corable:        { push: disable }
  columns:
    id:                { type: integer(20), autoincrement: true, primary: true }
    name:              { type: string(255), notnull: true, notblank: true }
    is_default:        { type: boolean, notnull: true, default: false, comment: 'Цена по-умолчанию для всех регионов?' }
    is_active:         { type: boolean, notnull: true, default: false, comment: 'Действующий прайс-лист?' }

ProductPrice:
  options:
    comment: 'Цены товаров по прайс-листам'
  actAs:
    #Timestampable: ~
    Corable:        { push: disable }
  columns:
    id:                     { type: integer(20), autoincrement: true, primary: true }
    product_price_list_id:  { type: integer(20), notnull: true }
    product_id:             { type: integer(20), notnull: true }
    price:                  { type: 'decimal(12,2)', notnull: true, default: 0, comment: 'Цена товара' }
    old_price:              { type: 'decimal(12,2)', notnull: true, default: 0, comment: 'Цена товара' }
    avg_price:              { type: 'decimal(12,2)', notnull: true, default: 0, comment: 'Цена товара' }
  relations:
    Product:                { class: Product, foreignAlias: ProductPrice, local: product_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }
    PriceList:              { class: ProductPriceList, foreignAlias: Price, local: product_price_list_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }

ProductLine:
  options:
    comment:  'Серии мебели'
  actAs:
    Timestampable: ~
    Corable: { push: disable }
  columns:
    id:      { type: integer(20), autoincrement: true, primary: true }
    name:    { type: string(255), notnull: true, notblank: true }
    token:   { type: string(255), unique: true, notnull: true, notblank: true }
    photo:   { type: string(255), notnull: false, default: null }

ProductStatus:
  options:
    comment:  'Тип продажи товара'
  columns:
    id:      { type: integer(20), autoincrement: true, primary: true }
    name:    { type: string(255), notnull: true, notblank: true }
    token:   { type: string(255), notnull: true, notblank: true }

ProductCategoryProductLineRelation:
  options:
    comment:          'Связь категории товара с товарной линией'
  actAs:
    Corable:          { push: disable }
  columns:
    id:               { type: integer(20), autoincrement: true, primary: true }
    category_id:      { type: integer(20), notnull: true }
    line_id:          { type: integer(20), notnull: true }
    position:         { type: integer(4), notnull: true, default: 1, comment: 'Порядок сортировки' }
  relations:
    ProductLine:      { class: ProductLine, foreignAlias: ProductCategoryRelation, local: line_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }
    ProductCategory:  { class: ProductCategory, foreignAlias: ProductLineRelation, local: category_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }

ProductKitRelation:
  options:
    comment:      'Комплекты'
  columns:
    kit_id:      { type: integer(20), notnull: true }
    part_id:     { type: integer(20), notnull: true }
    quantity:    { type: integer(4),  notnull: true, default: 1, comment: 'Количество единиц товара в наборе' }
  relations:
    Kit:         { class: Product, foreignAlias: PartRelation, local: kit_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }
    Part:        { class: Product, foreignAlias: KitRelation, local: part_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }

ProductState:
  options:
    comment:          'Состояние товара по регионам'
  actAs:
    Corable:          { push: disable }
  columns:
    region_id:        { type: integer(20), notnull: true }
    product_id:       { type: integer(20), notnull: true }
    view_show:        { type: boolean, notnull: true, default: false, comment: 'Показывать товар по прямой ссылке?' }
    view_list:        { type: boolean, notnull: true, default: false, comment: 'Показывать товар в списке категорий?' }
    is_instock:       { type: boolean, notnull: true, default: false, comment: 'Есть ли товар в наличии?' }
    is_price:         { type: boolean, notnull: true, default: false, comment: 'Есть ли цена? (из core)' }
    is_shop:          { type: boolean, notnull: true, default: false, comment: 'Есть ли наличие в магазине? (из core)' }
    is_store:         { type: boolean, notnull: true, default: false, comment: 'Есть ли наличие на складах? (из core)' }
    is_supplied:      { type: boolean, notnull: true, default: false, comment: 'Есть ли у поставщика? (из core)' }
    status_id:        { type: integer(20), notnull: false, comment: 'Статус товара из core' }
  relations:
    Product:           { class: Product, foreignAlias: State, local: product_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }
    Region:            { class: Region, foreignAlias: ProductState, local: region_id, foreign: id, type: one, foreignType: many, onDelete: RESTRICT }

ProductDeliveryPrice:
  options:
    comment:          'Цены на доставку продуктов'
  actAs:
    Timestampable: ~
    Corable:          { push: disable }
  columns:
    id:               { type: integer(20), autoincrement: true, primary: true }
    price_list_id:    { type: integer(20), notnull: true, default: 1 }
    product_id:       { type: integer(20), notnull: true }
    price:            { type: integer(11) }
  relations:
    PriceList:        { class: ProductPriceList, foreignAlias: DeliveryPrice, local: price_list_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }
    Product:          { class: Product, foreignAlias: DeliveryPrice, local: product_id, foreign: id, type: one, foreignType: many, onDelete: CASCADE }
