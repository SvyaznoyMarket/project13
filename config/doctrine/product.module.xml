<?xml version="1.0" encoding="utf-8" standalone="no" ?>
<orm-designer version="1.4.3.457">

  <module import-format="DoctrineYml" import-path="product.yml" name="product" visBkColor="16709106" visSizeX="0" visSizeX2="633" visSizeY="0" visSizeY2="569">
    <table name="Creator" visPositionX="53" visPositionY="40" visSizeX="0" visSizeX2="104" visSizeY="0" visSizeY2="45">
      <column auto-increment="true" name="id" primary="true" size="20" type="integer"/>
      <column name="name" required="true" size="255" type="string">
        <orm-properties>
          <attribute name="notblank">true</attribute>
        </orm-properties>
      </column>
      <orm-properties>
        <attribute name="options">
          <attribute name="comment">Производитель</attribute>
        </attribute>
      </orm-properties>
    </table>
    <table name="ProductCategory" visPositionX="264" visPositionY="40" visSizeX="0" visSizeX2="104" visSizeY="0" visSizeY2="45">
      <column auto-increment="true" name="id" primary="true" size="20" type="integer"/>
      <column name="name" required="true" size="255" type="string">
        <orm-properties>
          <attribute name="notblank">true</attribute>
        </orm-properties>
      </column>
      <orm-properties>
        <attribute name="options">
          <attribute name="comment">Категория товара</attribute>
        </attribute>
      </orm-properties>
    </table>
    <table name="ProductType" visPositionX="475" visPositionY="40" visSizeX="0" visSizeX2="104" visSizeY="0" visSizeY2="45">
      <column auto-increment="true" name="id" primary="true" size="20" type="integer"/>
      <column name="name" required="true" size="255" type="string">
        <orm-properties>
          <attribute name="notblank">true</attribute>
        </orm-properties>
      </column>
      <orm-properties>
        <attribute name="options">
          <attribute name="comment">Тип товара</attribute>
        </attribute>
      </orm-properties>
    </table>
    <table name="ProductProperty" visPositionX="49" visPositionY="223" visSizeX="0" visSizeX2="113" visSizeY="0" visSizeY2="73">
      <column auto-increment="true" name="id" primary="true" size="20" type="integer"/>
      <column name="name" required="true" size="255" type="string">
        <orm-properties>
          <attribute name="notblank">true</attribute>
        </orm-properties>
      </column>
      <column default="string" name="type" required="true" size="20" type="enum" values="string,select,text">
        <orm-properties>
          <attribute name="notblank">true</attribute>
          <attribute name="comment">Тип свойства: строка, значение из справочника (опция свойства), текст</attribute>
        </orm-properties>
      </column>
      <column default="false" name="is_multiple" required="true" type="boolean">
        <orm-properties>
          <attribute name="comment">Свойство имеет несколько значений?</attribute>
        </orm-properties>
      </column>
      <orm-properties>
        <attribute name="options">
          <attribute name="comment">Свойство товара</attribute>
        </attribute>
      </orm-properties>
    </table>
    <table name="ProductTypePropertyRelation" visPositionX="231" visPositionY="223" visSizeX="0" visSizeX2="171" visSizeY="0" visSizeY2="116">
      <column default="null" name="name" size="255" type="string"/>
      <column name="product_type_id" primary="true" required="true" size="20" type="integer"/>
      <column name="property_id" primary="true" required="true" size="20" type="integer"/>
      <column default="1" name="position" required="true" size="4" type="integer">
        <orm-properties>
          <attribute name="comment">Порядок сортировки</attribute>
        </orm-properties>
      </column>
      <column default="false" name="view_show" required="true" type="boolean">
        <orm-properties>
          <attribute name="comment">Показывать свойство в карточке товара?</attribute>
        </orm-properties>
      </column>
      <column default="false" name="view_list" required="true" type="boolean">
        <orm-properties>
          <attribute name="comment">Показывать свойство в списке товаров?</attribute>
        </orm-properties>
      </column>
      <orm-properties>
        <attribute name="options">
          <attribute name="comment">Связь типа товара и свойства товара</attribute>
        </attribute>
      </orm-properties>
    </table>
    <table name="ProductPropertyOption" visPositionX="463" visPositionY="223" visSizeX="0" visSizeX2="128" visSizeY="0" visSizeY2="73">
      <column auto-increment="true" name="id" primary="true" size="20" type="integer"/>
      <column name="property_id" required="true" size="20" type="integer"/>
      <column name="value" required="true" size="255" type="string">
        <orm-properties>
          <attribute name="notblank">true</attribute>
          <attribute name="comment">Значение опции</attribute>
        </orm-properties>
      </column>
      <column default="1" name="position" required="true" size="4" type="integer">
        <orm-properties>
          <attribute name="comment">Порядок сортировки</attribute>
        </orm-properties>
      </column>
      <orm-properties>
        <attribute name="options">
          <attribute name="comment">Опции свойства товара</attribute>
        </attribute>
      </orm-properties>
    </table>
    <table name="Product" visPositionX="40" visPositionY="406" visSizeX="0" visSizeX2="130" visSizeY="0" visSizeY2="143">
      <column auto-increment="true" name="id" primary="true" size="20" type="integer"/>
      <column name="name" required="true" size="255" type="string">
        <orm-properties>
          <attribute name="notblank">true</attribute>
        </orm-properties>
      </column>
      <column name="type_id" required="true" size="20" type="integer"/>
      <column name="creator_id" required="true" size="20" type="integer"/>
      <column name="category_id" required="true" size="20" type="integer"/>
      <column default="false" name="view_show" required="true" type="boolean">
        <orm-properties>
          <attribute name="comment">Показывать товар по прямой ссылке?</attribute>
        </orm-properties>
      </column>
      <column default="false" name="view_list" required="true" type="boolean">
        <orm-properties>
          <attribute name="comment">Показывать товар в списке категорий?</attribute>
        </orm-properties>
      </column>
      <column default="null" name="description" type="text">
        <orm-properties>
          <attribute name="comment">Описание товара</attribute>
        </orm-properties>
      </column>
      <column default="0" name="rating" required="true" size="4" type="double">
        <orm-properties>
          <attribute name="scale">12</attribute>
          <attribute name="comment">Рейтинг товара</attribute>
        </orm-properties>
      </column>
      <orm-properties>
        <attribute name="options">
          <attribute name="comment">Товар</attribute>
        </attribute>
        <attribute name="listeners">[ProductListener]</attribute>
      </orm-properties>
    </table>
    <table name="ProductPropertyRelation" visPositionX="250" visPositionY="406" visSizeX="0" visSizeX2="132" visSizeY="0" visSizeY2="115">
      <column auto-increment="true" name="id" primary="true" size="20" type="integer"/>
      <column default="null" name="name" size="255" type="string"/>
      <column name="product_id" required="true" size="20" type="integer"/>
      <column name="property_id" required="true" size="20" type="integer"/>
      <column default="null" name="option_id" size="20" type="integer"/>
      <column default="null" name="value_string" size="255" type="string"/>
      <column default="null" name="value_text" type="string"/>
      <orm-properties>
        <attribute name="options">
          <attribute name="comment">Связь продукта и свойства продукта</attribute>
        </attribute>
      </orm-properties>
    </table>
    <table name="ProductPhoto" visPositionX="465" visPositionY="406" visSizeX="0" visSizeX2="124" visSizeY="0" visSizeY2="101">
      <column auto-increment="true" name="id" primary="true" size="20" type="integer"/>
      <column name="name" required="true" size="255" type="string">
        <orm-properties>
          <attribute name="notblank">true</attribute>
        </orm-properties>
      </column>
      <column name="resource" required="true" size="255" type="string">
        <orm-properties>
          <attribute name="notblank">true</attribute>
        </orm-properties>
      </column>
      <column name="product_id" required="true" size="20" type="integer"/>
      <column default="false" name="view_show" required="true" type="boolean">
        <orm-properties>
          <attribute name="comment">Показывать фото в карточке товара?</attribute>
        </orm-properties>
      </column>
      <column default="false" name="view_list" required="true" type="boolean">
        <orm-properties>
          <attribute name="comment">показывать фото в списке товаров?</attribute>
        </orm-properties>
      </column>
      <orm-properties>
        <attribute name="options">
          <attribute name="comment">Фото товара</attribute>
        </attribute>
      </orm-properties>
    </table>
    <foreign-key from="ProductTypePropertyRelation" inverse-alias="Property" name="FK_ProductTypePropertyRelation_ProductProperty_id" owning-alias="ProductTypeRelation" to="ProductProperty">
      <foreign-key-column from="property_id" to="id"/>
      <orm-properties>
        <attribute name="side-inverse">
          <attribute name="type">one</attribute>
        </attribute>
        <attribute name="side-owning">
          <attribute name="type">many</attribute>
        </attribute>
        <attribute name="onDelete">CASCADE</attribute>
      </orm-properties>
    </foreign-key>
    <foreign-key from="ProductTypePropertyRelation" inverse-alias="ProductType" name="FK_ProductTypePropertyRelation_ProductType_id" owning-alias="PropertyRelation" to="ProductType">
      <foreign-key-column from="product_type_id" to="id"/>
      <orm-properties>
        <attribute name="side-inverse">
          <attribute name="type">one</attribute>
        </attribute>
        <attribute name="side-owning">
          <attribute name="type">many</attribute>
        </attribute>
        <attribute name="onDelete">CASCADE</attribute>
      </orm-properties>
    </foreign-key>
    <foreign-key from="ProductPropertyOption" inverse-alias="Property" name="FK_ProductPropertyOption_ProductProperty_id" owning-alias="Option" to="ProductProperty">
      <foreign-key-column from="property_id" to="id"/>
      <orm-properties>
        <attribute name="side-inverse">
          <attribute name="type">one</attribute>
        </attribute>
        <attribute name="side-owning">
          <attribute name="type">many</attribute>
        </attribute>
        <attribute name="onDelete">CASCADE</attribute>
      </orm-properties>
    </foreign-key>
    <foreign-key from="Product" inverse-alias="Type" name="FK_Product_ProductType_id" owning-alias="Product" to="ProductType">
      <foreign-key-column from="type_id" to="id"/>
      <orm-properties>
        <attribute name="side-inverse">
          <attribute name="type">one</attribute>
        </attribute>
        <attribute name="side-owning">
          <attribute name="type">many</attribute>
        </attribute>
        <attribute name="onDelete">RESTRICT</attribute>
      </orm-properties>
    </foreign-key>
    <foreign-key from="Product" inverse-alias="Creator" name="FK_Product_Creator_id" owning-alias="Product" to="Creator">
      <foreign-key-column from="creator_id" to="id"/>
      <orm-properties>
        <attribute name="side-inverse">
          <attribute name="type">one</attribute>
        </attribute>
        <attribute name="side-owning">
          <attribute name="type">many</attribute>
        </attribute>
        <attribute name="onDelete">RESTRICT</attribute>
      </orm-properties>
    </foreign-key>
    <foreign-key from="Product" inverse-alias="Category" name="FK_Product_ProductCategory_id" owning-alias="Product" to="ProductCategory">
      <foreign-key-column from="category_id" to="id"/>
      <orm-properties>
        <attribute name="side-inverse">
          <attribute name="type">one</attribute>
        </attribute>
        <attribute name="side-owning">
          <attribute name="type">many</attribute>
        </attribute>
        <attribute name="onDelete">RESTRICT</attribute>
      </orm-properties>
    </foreign-key>
    <foreign-key from="ProductPropertyRelation" inverse-alias="Product" name="FK_ProductPropertyRelation_Product_id" owning-alias="PropertyRelation" to="Product">
      <foreign-key-column from="product_id" to="id"/>
      <orm-properties>
        <attribute name="side-inverse">
          <attribute name="type">one</attribute>
        </attribute>
        <attribute name="side-owning">
          <attribute name="type">many</attribute>
        </attribute>
        <attribute name="onDelete">CASCADE</attribute>
      </orm-properties>
    </foreign-key>
    <foreign-key from="ProductPropertyRelation" inverse-alias="Property" name="FK_ProductPropertyRelation_ProductProperty_id" owning-alias="ProductRelation" to="ProductProperty">
      <foreign-key-column from="property_id" to="id"/>
      <orm-properties>
        <attribute name="side-inverse">
          <attribute name="type">one</attribute>
        </attribute>
        <attribute name="side-owning">
          <attribute name="type">many</attribute>
        </attribute>
        <attribute name="onDelete">CASCADE</attribute>
      </orm-properties>
    </foreign-key>
    <foreign-key from="ProductPropertyRelation" inverse-alias="Option" name="FK_ProductPropertyRelation_ProductPropertyOption_id" owning-alias="ProductPropertyRelation" to="ProductPropertyOption">
      <foreign-key-column from="option_id" to="id"/>
      <orm-properties>
        <attribute name="side-inverse">
          <attribute name="type">one</attribute>
        </attribute>
        <attribute name="side-owning">
          <attribute name="type">many</attribute>
        </attribute>
        <attribute name="onDelete">SET NULL</attribute>
      </orm-properties>
    </foreign-key>
    <foreign-key from="ProductPhoto" inverse-alias="Product" name="FK_ProductPhoto_Product_id" owning-alias="Photo" to="Product">
      <foreign-key-column from="product_id" to="id"/>
      <orm-properties>
        <attribute name="side-inverse">
          <attribute name="type">one</attribute>
        </attribute>
        <attribute name="side-owning">
          <attribute name="type">many</attribute>
        </attribute>
        <attribute name="onDelete">CASCADE</attribute>
      </orm-properties>
    </foreign-key>
    <many-to-many-relation mn-table="ProductTypePropertyRelation">
      <many-to-many-foreign-key foreign-key="FK_ProductTypePropertyRelation_ProductProperty_id" relation-alias="Property"/>
      <many-to-many-foreign-key foreign-key="FK_ProductTypePropertyRelation_ProductType_id" relation-alias="ProductType"/>
    </many-to-many-relation>
  </module>

</orm-designer>
